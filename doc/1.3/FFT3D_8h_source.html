<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
<h1>FFT3D.h</h1><a href="FFT3D_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++; tab-width: 2; -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vi: set ts=2:</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// $Id: FFT3D.h,v 1.17.16.1 2007/03/25 21:23:44 oliver Exp $</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef BALL_MATHS_TFFT3D_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define BALL_MATHS_TFFT3D_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef BALL_COMMON_EXCEPTION_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="exception_8h.html">BALL/COMMON/exception.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="preprocessor">#ifndef BALL_DATATYPE_REGULARDATA3D_H</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="regularData3D_8h.html">BALL/DATATYPE/regularData3D.h</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#endif</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a>00019 <span class="comment">//#ifndef BALL_MATHS_VECTOR2_H</span>
<a name="l00020"></a>00020 <span class="comment">//# include &lt;BALL/MATHS/vector3.h&gt;</span>
<a name="l00021"></a>00021 <span class="comment">//#endif</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="fftwCommon_8h.html">BALL/MATHS/fftwCommon.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;complex&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;fftw3.h&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">namespace </span>BALL
<a name="l00029"></a>00029 {
<a name="l00040"></a>00040   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00041"></a><a class="code" href="classBALL_1_1TFFT3D.html">00041</a>   <span class="keyword">class </span><a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D</a> 
<a name="l00042"></a>00042     : <span class="keyword">public</span> <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D</a>&lt;std::complex&lt;typename ComplexTraits::ComplexPrecision&gt; &gt;
<a name="l00043"></a>00043   {
<a name="l00044"></a>00044     <span class="keyword">public</span>:
<a name="l00045"></a>00045     
<a name="l00046"></a><a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">00046</a>       <span class="keyword">typedef</span> std::complex&lt;typename ComplexTraits::ComplexPrecision&gt; <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>;
<a name="l00047"></a><a class="code" href="classBALL_1_1TFFT3D.html#ad696c2d2420a5350db8a8ef9e2e3dc58">00047</a>       <span class="keyword">typedef</span> <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;std::complex&lt;typename ComplexTraits::ComplexPrecision&gt;</a> &gt; <a class="code" href="classBALL_1_1TRegularData3D.html">ComplexVector</a>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049       <a class="code" href="group__Common.html#ga84998f74fd7a58cecfcbb81d48b4323b">BALL_CREATE</a>(<a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D</a>)
<a name="l00050"></a>00050 
<a name="l00051"></a>00051       
<a name="l00054"></a>00054     
<a name="l00055"></a>00055       
<a name="l00056"></a>00056       <a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D</a>();
<a name="l00057"></a>00057     
<a name="l00059"></a>00059       TFFT3D(const TFFT3D &amp;data);
<a name="l00060"></a>00060 
<a name="l00074"></a>00074        <span class="comment">// AR: ldn is not any longer the binary logarithm but the absolute number of grid points</span>
<a name="l00075"></a>00075       TFFT3D(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> ldnX, <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> ldnY, <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> ldnZ, <span class="keywordtype">double</span> stepPhysX=1., <span class="keywordtype">double</span> stepPhysY=1., <span class="keywordtype">double</span> stepPhysZ=1., <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> origin=<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>(0.,0.,0), <span class="keywordtype">bool</span> inFourierSpace=false);
<a name="l00076"></a>00076 
<a name="l00078"></a>00078       virtual ~TFFT3D();
<a name="l00079"></a>00079           
<a name="l00081"></a>00081     
<a name="l00085"></a>00085     
<a name="l00087"></a>00087       const TFFT3D&amp; operator = (const TFFT3D&amp; fft_3d);
<a name="l00088"></a>00088     
<a name="l00091"></a>00091       virtual <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#aec52491fa3952d9a7bbdaf2769d64994">clear</a>();
<a name="l00092"></a>00092       
<a name="l00095"></a>00095       virtual <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a33f48a64d7c429e32b2c86c82734d272">destroy</a>();
<a name="l00096"></a>00096 
<a name="l00098"></a>00098 
<a name="l00102"></a>00102 
<a name="l00105"></a>00105       <span class="keywordtype">bool</span> operator == (const TFFT3D&amp; fft3d) const;
<a name="l00107"></a>00107       
<a name="l00108"></a>00108       <span class="comment">// @name Accessors</span>
<a name="l00109"></a>00109     
<a name="l00111"></a>00111 
<a name="l00113"></a>00113       <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a701dde2d89034311614f5ab0c01f485f">doFFT</a>();
<a name="l00114"></a>00114 
<a name="l00117"></a>00117       <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a894ae14746318996897991e281a15acd">doiFFT</a>();
<a name="l00118"></a>00118 
<a name="l00124"></a>00124       <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#ac8206bd941f22fa35af43d2ff58fab88">translate</a>(const Vector3&amp; trans_origin);
<a name="l00125"></a>00125 
<a name="l00131"></a>00131       <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#ac3f358ca511d7a73bc4b83d5c406a2ea">setPhysStepWidth</a>(<span class="keywordtype">double</span> new_width_x, <span class="keywordtype">double</span> new_width_y, <span class="keywordtype">double</span> new_width_z);
<a name="l00132"></a>00132 
<a name="l00135"></a>00135       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a654f559176d15868cc4a347faef30dff">getPhysStepWidthX</a>() const;
<a name="l00136"></a>00136 
<a name="l00139"></a>00139       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a44c14359c7f6f31b11dcbe5792ef95d0">getPhysStepWidthY</a>() const;
<a name="l00140"></a>00140 
<a name="l00143"></a>00143       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a69d6078860a245d7c3e6a151c8dc653d">getPhysStepWidthZ</a>() const;
<a name="l00144"></a>00144 
<a name="l00147"></a>00147       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a7a4fb6667c969cfc7ffa848386427f3b">getFourierStepWidthX</a>() const;
<a name="l00148"></a>00148 
<a name="l00151"></a>00151       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a9deb57e2a582e9cc8ec1ed836fb8c6b9">getFourierStepWidthY</a>() const;
<a name="l00152"></a>00152 
<a name="l00155"></a>00155       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aba5fe8b97dfd2101c0115cdfdc344c8b">getFourierStepWidthZ</a>() const;
<a name="l00156"></a>00156 
<a name="l00159"></a>00159       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aea044ba8e63934fc4122cb8d94040ea8">getPhysSpaceMinX</a>() const;
<a name="l00160"></a>00160 
<a name="l00163"></a>00163       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a24878915fa80f484a1b95497db66dc3d">getPhysSpaceMinY</a>() const
<a name="l00164"></a>00164 ;
<a name="l00165"></a>00165 
<a name="l00168"></a>00168       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a2cc85deab1f66f12096dc1b4a4ab4499">getPhysSpaceMinZ</a>() const;
<a name="l00169"></a>00169 
<a name="l00172"></a>00172       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a62a707a7f6283b7e4868073f34f0e4c5">getPhysSpaceMaxX</a>() const;
<a name="l00173"></a>00173 
<a name="l00176"></a>00176       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aeb9fd1a16d449ae51bb068b3132bca35">getPhysSpaceMaxY</a>() const;
<a name="l00177"></a>00177 
<a name="l00180"></a>00180       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#ae4a6997ccce6291d5cb3f335bf57f9e3">getPhysSpaceMaxZ</a>() const;
<a name="l00181"></a>00181 
<a name="l00184"></a>00184       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a279109595187c6560607f1d8ed60b2d3">getFourierSpaceMinX</a>() const;
<a name="l00185"></a>00185 
<a name="l00188"></a>00188       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#abfe74a0de0c8ae9051d0d34f248fcfcb">getFourierSpaceMinY</a>() const;
<a name="l00189"></a>00189 
<a name="l00192"></a>00192       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a2febbb6cde04c8b9d24bb764f2cada6f">getFourierSpaceMinZ</a>() const;
<a name="l00193"></a>00193 
<a name="l00196"></a>00196       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aa56fcceec49087810d9dbdd191a95dd2">getFourierSpaceMaxX</a>() const;
<a name="l00197"></a>00197 
<a name="l00200"></a>00200       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a65d14fa2bb30fd119a805cfa0b2ebf8e">getFourierSpaceMaxY</a>() const;
<a name="l00201"></a>00201 
<a name="l00204"></a>00204       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6523b7f57f119b780e61a17e7ce8f3ad">getFourierSpaceMaxZ</a>() const;
<a name="l00205"></a>00205 
<a name="l00211"></a>00211       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a370efbbacbac72daa06477ce5c883214">getMaxXIndex</a>() const;
<a name="l00212"></a>00212 
<a name="l00218"></a>00218       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a6dfaa0d59f61844e76439027d696d7b5">getMaxYIndex</a>() const;
<a name="l00219"></a>00219 
<a name="l00225"></a>00225       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a80e16b97822d9b170808b292171a7ee7">getMaxZIndex</a>() const;
<a name="l00226"></a>00226 
<a name="l00230"></a>00230       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#ac1d93424a5f3f98038804c54ec8d6b8e">getNumberOfInverseTransforms</a>() const;
<a name="l00231"></a>00231       
<a name="l00234"></a>00234       Vector3 <a class="code" href="classBALL_1_1TFFT3D.html#a1aefb620b7066c4745a2ff86f59ecdbe">getGridCoordinates</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> position) const;
<a name="l00235"></a>00235       
<a name="l00240"></a>00240       <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> <a class="code" href="classBALL_1_1TRegularData3D.html#acf56a85105c6ad28b5f7388760b443d5" title="Get the full data.">getData</a>(const Vector3&amp; pos) const
<a name="l00241"></a>00241         throw(Exception::OutOfGrid);
<a name="l00242"></a>00242 
<a name="l00248"></a>00248       <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> <a class="code" href="classBALL_1_1TFFT3D.html#ac04844cb7ba0b2de9eb4529f3428fa3e">getInterpolatedValue</a>(const Vector3&amp; pos) const
<a name="l00249"></a>00249         throw(Exception::OutOfGrid);
<a name="l00250"></a>00250 
<a name="l00256"></a>00256       <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a85695f9763bd00643937149b71e40ea8">setData</a>(const Vector3&amp; pos, <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> val)
<a name="l00257"></a>00257         throw(Exception::OutOfGrid);
<a name="l00258"></a>00258 
<a name="l00262"></a>00262       <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>&amp; operator[](const Vector3&amp; pos)
<a name="l00263"></a>00263         throw(Exception::OutOfGrid);
<a name="l00264"></a>00264 
<a name="l00268"></a>00268       const <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>&amp; operator[](const Vector3&amp; pos) const
<a name="l00269"></a>00269         throw(Exception::OutOfGrid);
<a name="l00270"></a>00270 
<a name="l00273"></a><a class="code" href="classBALL_1_1TFFT3D.html#a75cb9df8b41ae4ed41046c0d3437a1cd">00273</a>       <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>&amp; operator[](const <a class="code" href="classBALL__SIZE__TYPE.html">Position</a>&amp; pos)
<a name="l00274"></a>00274         throw(Exception::OutOfGrid)
<a name="l00275"></a>00275       {
<a name="l00276"></a>00276         <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">TRegularData3D&lt;Complex&gt;::operator [] </a>(pos);
<a name="l00277"></a>00277       }
<a name="l00278"></a>00278 
<a name="l00281"></a><a class="code" href="classBALL_1_1TFFT3D.html#ae73e7e8a8d2974378a5064f97900144b">00281</a>       <span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">operator[]</a>(<span class="keyword">const</span> <a class="code" href="classBALL__SIZE__TYPE.html">Position</a>&amp; pos) <span class="keyword">const</span>
<a name="l00282"></a>00282         <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00283"></a>00283       {
<a name="l00284"></a>00284         <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">TRegularData3D&lt;Complex&gt;::operator [] </a>(pos);
<a name="l00285"></a>00285       }
<a name="l00286"></a>00286       
<a name="l00287"></a>00287       <span class="comment">// AR:</span>
<a name="l00288"></a><a class="code" href="classBALL_1_1TFFT3D.html#a63a12a140611b8d352fb069f49462c53">00288</a>       <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a63a12a140611b8d352fb069f49462c53">setNumberOfFFTTransforms</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> num)
<a name="l00289"></a>00289       {
<a name="l00290"></a>00290         <a class="code" href="classBALL_1_1TFFT3D.html#ae11fb0566618bc1872560eb340d3a189">numPhysToFourier_</a> = num;
<a name="l00291"></a>00291       }
<a name="l00292"></a>00292       
<a name="l00293"></a>00293       <span class="comment">// AR:</span>
<a name="l00294"></a><a class="code" href="classBALL_1_1TFFT3D.html#a1b61f90a1e226b855658437439965320">00294</a>       <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a1b61f90a1e226b855658437439965320">setNumberOfiFFTTransforms</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> num)
<a name="l00295"></a>00295       {
<a name="l00296"></a>00296         <a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">numFourierToPhys_</a> = num;
<a name="l00297"></a>00297       }
<a name="l00298"></a>00298       
<a name="l00299"></a>00299         
<a name="l00304"></a>00304       <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">Complex</a> <a class="code" href="classBALL_1_1TFFT3D.html#a4577167db42f278c8c9adf3c3d6f5c95">phase</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos) <span class="keyword">const</span>;
<a name="l00306"></a>00306       
<a name="l00310"></a>00310 
<a name="l00314"></a>00314       <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#adb04f543ba9008685b35d428ac7229f9">isInFourierSpace</a>() <span class="keyword">const</span>;
<a name="l00316"></a>00316       
<a name="l00317"></a>00317     <span class="keyword">protected</span>:
<a name="l00318"></a><a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">00318</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00319"></a><a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">00319</a>       <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a>;
<a name="l00320"></a><a class="code" href="classBALL_1_1TFFT3D.html#ae11fb0566618bc1872560eb340d3a189">00320</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#ae11fb0566618bc1872560eb340d3a189">numPhysToFourier_</a>;
<a name="l00321"></a><a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">00321</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">numFourierToPhys_</a>;
<a name="l00322"></a><a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d">00322</a>       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>;
<a name="l00323"></a><a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">00323</a>       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>;
<a name="l00324"></a><a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">00324</a>       <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>;
<a name="l00325"></a><a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">00325</a>       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a>;
<a name="l00326"></a><a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">00326</a>       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a>, <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a>;
<a name="l00327"></a>00327       
<a name="l00328"></a>00328       
<a name="l00329"></a>00329       <span class="comment">// AR: new version for FFTW3</span>
<a name="l00330"></a><a class="code" href="classBALL_1_1TFFT3D.html#a52c408cc6375b9ced0132b16d2350a1d">00330</a>       <span class="keyword">typename</span> ComplexTraits::FftwPlan <a class="code" href="classBALL_1_1TFFT3D.html#a52c408cc6375b9ced0132b16d2350a1d">planForward_</a>;
<a name="l00331"></a><a class="code" href="classBALL_1_1TFFT3D.html#aab70013cda393d94651a1653562ebdbe">00331</a>       <span class="keyword">typename</span> ComplexTraits::FftwPlan <a class="code" href="classBALL_1_1TFFT3D.html#aab70013cda393d94651a1653562ebdbe">planBackward_</a>;
<a name="l00332"></a>00332       
<a name="l00333"></a>00333       <span class="comment">// AR: to control plan calculation with new fftw3</span>
<a name="l00334"></a><a class="code" href="classBALL_1_1TFFT3D.html#a4c50be2c170749181e81b7ea76b57af5">00334</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a4c50be2c170749181e81b7ea76b57af5">dataLength_</a>;
<a name="l00335"></a><a class="code" href="classBALL_1_1TFFT3D.html#ab6d320cb37c8dcac66d2bfbf4b80b058">00335</a>       <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> *<a class="code" href="classBALL_1_1TFFT3D.html#ab6d320cb37c8dcac66d2bfbf4b80b058">dataAdress_</a>;
<a name="l00336"></a><a class="code" href="classBALL_1_1TFFT3D.html#a2ff177d8b9a2ad5c9b1462aa7e433d8f">00336</a>       <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#a2ff177d8b9a2ad5c9b1462aa7e433d8f">planCalculated_</a>;
<a name="l00337"></a>00337       
<a name="l00338"></a>00338   };
<a name="l00339"></a>00339   
<a name="l00342"></a><a class="code" href="namespaceBALL.html#a3bae29df496ab61bfe880da84419deb7">00342</a>   <span class="keyword">typedef</span> <a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D&lt;BALL_FFTW_DEFAULT_TRAITS&gt;</a> <a class="code" href="classBALL_1_1TFFT3D.html">FFT3D</a>;
<a name="l00343"></a>00343 
<a name="l00346"></a>00346   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00347"></a>00347   <span class="keyword">const</span> <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;&amp; <span class="keyword">operator</span> &lt;&lt; 
<a name="l00348"></a>00348     (<a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;&amp; to, <span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D&lt;ComplexTraits&gt;</a>&amp; from);
<a name="l00349"></a>00349   
<a name="l00354"></a>00354   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00355"></a>00355   <span class="keyword">const</span> <a class="code" href="classBALL_1_1TRegularData3D.html">RegularData3D</a>&amp; operator &lt;&lt; (RegularData3D&amp; to, const TFFT3D&lt;ComplexTraits&gt;&amp; from);
<a name="l00356"></a>00356     
<a name="l00357"></a>00357     
<a name="l00358"></a>00358   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00359"></a><a class="code" href="classBALL_1_1TFFT3D.html#afbb76661ec50f7dcfdca33c29fac2cf4">00359</a>   <a class="code" href="classBALL_1_1TFFT3D.html#afbb76661ec50f7dcfdca33c29fac2cf4" title="Default constructor.">TFFT3D&lt;ComplexTraits&gt;::TFFT3D</a>()
<a name="l00360"></a>00360     : <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D</a>&lt;<a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>&gt;(),
<a name="l00361"></a>00361       dataLength_(0),
<a name="l00362"></a>00362       dataAdress_(0),
<a name="l00363"></a>00363       planCalculated_(false)
<a name="l00364"></a>00364   {
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366   
<a name="l00367"></a>00367   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00368"></a><a class="code" href="classBALL_1_1TFFT3D.html#a6c487de0246d4064e6a24f6c3b18d248">00368</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6c487de0246d4064e6a24f6c3b18d248">TFFT3D&lt;ComplexTraits&gt;::operator == </a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D</a>&amp; fft3D)<span class="keyword"> const</span>
<a name="l00369"></a>00369 <span class="keyword">  </span>{
<a name="l00370"></a>00370     
<a name="l00371"></a>00371     <span class="comment">// AR: test whether data_.size() == fft3D.data_.size()</span>
<a name="l00372"></a>00372     <span class="comment">//     instead of testing 3 lengths. Better for vector handling.</span>
<a name="l00373"></a>00373     
<a name="l00374"></a>00374     <span class="keywordflow">if</span> (<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a> &amp;&amp;
<a name="l00375"></a>00375         <a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> &amp;&amp;
<a name="l00376"></a>00376         <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a> &amp;&amp;
<a name="l00377"></a>00377         <a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a> &amp;&amp;
<a name="l00378"></a>00378         <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a> &amp;&amp;
<a name="l00379"></a>00379         <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a> &amp;&amp;
<a name="l00380"></a>00380         <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a> &amp;&amp;
<a name="l00381"></a>00381         <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a> &amp;&amp;
<a name="l00382"></a>00382         <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a> &amp;&amp;
<a name="l00383"></a>00383         <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a> &amp;&amp;
<a name="l00384"></a>00384         <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a> &amp;&amp;
<a name="l00385"></a>00385         <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a> &amp;&amp;
<a name="l00386"></a>00386         <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a> &amp;&amp;
<a name="l00387"></a>00387         <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a> &amp;&amp;
<a name="l00388"></a>00388         <a class="code" href="classBALL_1_1TFFT3D.html#ae11fb0566618bc1872560eb340d3a189">numPhysToFourier_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#ae11fb0566618bc1872560eb340d3a189">numPhysToFourier_</a> &amp;&amp;
<a name="l00389"></a>00389         <a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">numFourierToPhys_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">numFourierToPhys_</a> &amp;&amp;
<a name="l00390"></a>00390         <a class="code" href="classBALL_1_1TFFT3D.html#a2ff177d8b9a2ad5c9b1462aa7e433d8f">planCalculated_</a> == fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#a2ff177d8b9a2ad5c9b1462aa7e433d8f">planCalculated_</a>)
<a name="l00391"></a>00391     {
<a name="l00392"></a>00392       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="group__MathsCommon.html#ga48cc5e26e859eca3082fc4ee4be51fa9">min</a>  = <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a> ?  <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a>  :   <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a>;
<a name="l00393"></a>00393       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="group__MathsCommon.html#ga7454a5315c85deffac5ab82b40185c7a">max</a>  = <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a> ?  <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a>  :   <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a>;
<a name="l00394"></a>00394       <span class="keywordtype">double</span> stepX = <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a> ? <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a> : <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>;
<a name="l00395"></a>00395       <span class="keywordtype">double</span> stepY = <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a> ? <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a> : <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>;  
<a name="l00396"></a>00396       <span class="keywordtype">double</span> stepZ = <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a> ? <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a> : <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>;  
<a name="l00397"></a>00397       
<a name="l00398"></a>00398       <span class="keywordflow">for</span> (<span class="keywordtype">double</span> posX=min.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>; posX&lt;=max.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>; posX+=stepX)
<a name="l00399"></a>00399       {
<a name="l00400"></a>00400         <span class="keywordflow">for</span> (<span class="keywordtype">double</span> posY=min.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>; posY&lt;=max.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>; posY+=stepY)
<a name="l00401"></a>00401         {
<a name="l00402"></a>00402           <span class="keywordflow">for</span> (<span class="keywordtype">double</span> posZ=min.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>; posZ&lt;=max.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>; posZ+=stepZ)
<a name="l00403"></a>00403           {
<a name="l00404"></a>00404             <span class="keywordflow">if</span> (<a class="code" href="classBALL_1_1TRegularData3D.html#acf56a85105c6ad28b5f7388760b443d5" title="Get the full data.">getData</a>(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(posX,posY,posZ)) != fft3D.<a class="code" href="classBALL_1_1TFFT3D.html#aca5bc037eb36c0b8b2c3c93f636f0934">getData</a>(<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>(posX,posY,posZ)))
<a name="l00405"></a>00405             {
<a name="l00406"></a>00406               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00407"></a>00407             }
<a name="l00408"></a>00408           }
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410       }
<a name="l00411"></a>00411       
<a name="l00412"></a>00412       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00413"></a>00413     }
<a name="l00414"></a>00414   
<a name="l00415"></a>00415     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00416"></a>00416   }
<a name="l00417"></a>00417   
<a name="l00418"></a>00418   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00419"></a><a class="code" href="classBALL_1_1TFFT3D.html#ac8206bd941f22fa35af43d2ff58fab88">00419</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#ac8206bd941f22fa35af43d2ff58fab88">TFFT3D&lt;ComplexTraits&gt;::translate</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; trans_origin)
<a name="l00420"></a>00420   {
<a name="l00421"></a>00421     <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> internalOriginX = (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(trans_origin.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>);
<a name="l00422"></a>00422     <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> internalOriginY = (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(trans_origin.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>);
<a name="l00423"></a>00423     <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> internalOriginZ = (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(trans_origin.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>);
<a name="l00424"></a>00424     
<a name="l00425"></a>00425     <span class="keywordflow">if</span> ((internalOriginX &lt;= <a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>) &amp;&amp; (internalOriginY &lt;= <a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>) &amp;&amp; (internalOriginZ &lt;= <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>))
<a name="l00426"></a>00426     {
<a name="l00427"></a>00427       <a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a> = trans_origin.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00428"></a>00428       <a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a> = trans_origin.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00429"></a>00429       <a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a> = trans_origin.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00430"></a>00430       
<a name="l00431"></a>00431       <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>,-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>,-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>);
<a name="l00432"></a>00432       <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(((<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>,((<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>,((<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>);
<a name="l00433"></a>00433       <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(-(<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>,-(<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>,-(<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>);
<a name="l00434"></a>00434       <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>((<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>,(<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>,(<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>);
<a name="l00435"></a>00435    
<a name="l00436"></a>00436       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438     <span class="keywordflow">else</span>
<a name="l00439"></a>00439     {
<a name="l00440"></a>00440       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442   }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00445"></a><a class="code" href="classBALL_1_1TFFT3D.html#ac3f358ca511d7a73bc4b83d5c406a2ea">00445</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#ac3f358ca511d7a73bc4b83d5c406a2ea">TFFT3D&lt;ComplexTraits&gt;::setPhysStepWidth</a>(<span class="keywordtype">double</span> new_width_x, <span class="keywordtype">double</span> new_width_y, <span class="keywordtype">double</span> new_width_z)
<a name="l00446"></a>00446   {
<a name="l00447"></a>00447     <span class="keywordflow">if</span> ((new_width_x &lt;= 0) || (new_width_y &lt;= 0) || (new_width_z &lt;= 0))
<a name="l00448"></a>00448     {
<a name="l00449"></a>00449       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00450"></a>00450     }
<a name="l00451"></a>00451     <span class="keywordflow">else</span>
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453       <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a> = new_width_x;
<a name="l00454"></a>00454       <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a> = new_width_y;
<a name="l00455"></a>00455       <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a> = new_width_z;
<a name="l00456"></a>00456       <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a> = 2.*M_PI/(<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>);
<a name="l00457"></a>00457       <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a> = 2.*M_PI/(<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>);
<a name="l00458"></a>00458       <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a> = 2.*M_PI/(<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>*<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460       <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>,-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>,-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>);
<a name="l00461"></a>00461       <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(((<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>,((<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>,((<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>)-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>);
<a name="l00462"></a>00462       <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(-(<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>,-(<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>,-(<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>);
<a name="l00463"></a>00463       <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a> = <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>((<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>,(<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>,(<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>/2.)*<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>);
<a name="l00464"></a>00464   
<a name="l00465"></a>00465       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467   }
<a name="l00468"></a>00468   
<a name="l00469"></a>00469   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00470"></a><a class="code" href="classBALL_1_1TFFT3D.html#a654f559176d15868cc4a347faef30dff">00470</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a654f559176d15868cc4a347faef30dff">TFFT3D&lt;ComplexTraits&gt;::getPhysStepWidthX</a>()<span class="keyword"> const</span>
<a name="l00471"></a>00471 <span class="keyword">  </span>{
<a name="l00472"></a>00472     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>;
<a name="l00473"></a>00473   }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00476"></a><a class="code" href="classBALL_1_1TFFT3D.html#a44c14359c7f6f31b11dcbe5792ef95d0">00476</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a44c14359c7f6f31b11dcbe5792ef95d0">TFFT3D&lt;ComplexTraits&gt;::getPhysStepWidthY</a>()<span class="keyword"> const</span>
<a name="l00477"></a>00477 <span class="keyword">  </span>{
<a name="l00478"></a>00478     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>;
<a name="l00479"></a>00479   }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00482"></a><a class="code" href="classBALL_1_1TFFT3D.html#a69d6078860a245d7c3e6a151c8dc653d">00482</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a69d6078860a245d7c3e6a151c8dc653d">TFFT3D&lt;ComplexTraits&gt;::getPhysStepWidthZ</a>()<span class="keyword"> const</span>
<a name="l00483"></a>00483 <span class="keyword">  </span>{
<a name="l00484"></a>00484     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>;
<a name="l00485"></a>00485   }
<a name="l00486"></a>00486   
<a name="l00487"></a>00487   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00488"></a><a class="code" href="classBALL_1_1TFFT3D.html#a7a4fb6667c969cfc7ffa848386427f3b">00488</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a7a4fb6667c969cfc7ffa848386427f3b">TFFT3D&lt;ComplexTraits&gt;::getFourierStepWidthX</a>()<span class="keyword"> const</span>
<a name="l00489"></a>00489 <span class="keyword">  </span>{
<a name="l00490"></a>00490     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>;
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00494"></a><a class="code" href="classBALL_1_1TFFT3D.html#a9deb57e2a582e9cc8ec1ed836fb8c6b9">00494</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a9deb57e2a582e9cc8ec1ed836fb8c6b9">TFFT3D&lt;ComplexTraits&gt;::getFourierStepWidthY</a>()<span class="keyword"> const</span>
<a name="l00495"></a>00495 <span class="keyword">  </span>{
<a name="l00496"></a>00496     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>;
<a name="l00497"></a>00497   }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00500"></a><a class="code" href="classBALL_1_1TFFT3D.html#aba5fe8b97dfd2101c0115cdfdc344c8b">00500</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aba5fe8b97dfd2101c0115cdfdc344c8b">TFFT3D&lt;ComplexTraits&gt;::getFourierStepWidthZ</a>()<span class="keyword"> const</span>
<a name="l00501"></a>00501 <span class="keyword">  </span>{
<a name="l00502"></a>00502     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>;
<a name="l00503"></a>00503   }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00506"></a><a class="code" href="classBALL_1_1TFFT3D.html#aea044ba8e63934fc4122cb8d94040ea8">00506</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aea044ba8e63934fc4122cb8d94040ea8">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMinX</a>()<span class="keyword"> const</span>
<a name="l00507"></a>00507 <span class="keyword">  </span>{
<a name="l00508"></a>00508     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00509"></a>00509   }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00512"></a><a class="code" href="classBALL_1_1TFFT3D.html#a24878915fa80f484a1b95497db66dc3d">00512</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a24878915fa80f484a1b95497db66dc3d">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMinY</a>()<span class="keyword"> const</span>
<a name="l00513"></a>00513 <span class="keyword">  </span>{
<a name="l00514"></a>00514     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00515"></a>00515   }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00518"></a><a class="code" href="classBALL_1_1TFFT3D.html#a2cc85deab1f66f12096dc1b4a4ab4499">00518</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a2cc85deab1f66f12096dc1b4a4ab4499">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMinZ</a>()<span class="keyword"> const</span>
<a name="l00519"></a>00519 <span class="keyword">  </span>{
<a name="l00520"></a>00520     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a4bc82c9f19cba0dd1798441c84232e4f">minPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00524"></a><a class="code" href="classBALL_1_1TFFT3D.html#a62a707a7f6283b7e4868073f34f0e4c5">00524</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a62a707a7f6283b7e4868073f34f0e4c5">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMaxX</a>()<span class="keyword"> const</span>
<a name="l00525"></a>00525 <span class="keyword">  </span>{
<a name="l00526"></a>00526     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00527"></a>00527   }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00530"></a><a class="code" href="classBALL_1_1TFFT3D.html#aeb9fd1a16d449ae51bb068b3132bca35">00530</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aeb9fd1a16d449ae51bb068b3132bca35">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMaxY</a>()<span class="keyword"> const</span>
<a name="l00531"></a>00531 <span class="keyword">  </span>{
<a name="l00532"></a>00532     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00533"></a>00533   }
<a name="l00534"></a>00534 
<a name="l00535"></a>00535   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00536"></a><a class="code" href="classBALL_1_1TFFT3D.html#ae4a6997ccce6291d5cb3f335bf57f9e3">00536</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#ae4a6997ccce6291d5cb3f335bf57f9e3">TFFT3D&lt;ComplexTraits&gt;::getPhysSpaceMaxZ</a>()<span class="keyword"> const</span>
<a name="l00537"></a>00537 <span class="keyword">  </span>{
<a name="l00538"></a>00538     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6d203726b104879747927362d3b1cc87">maxPhys_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00539"></a>00539   }
<a name="l00540"></a>00540   
<a name="l00541"></a>00541   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00542"></a><a class="code" href="classBALL_1_1TFFT3D.html#a279109595187c6560607f1d8ed60b2d3">00542</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a279109595187c6560607f1d8ed60b2d3">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMinX</a>()<span class="keyword"> const</span>
<a name="l00543"></a>00543 <span class="keyword"></span>
<a name="l00544"></a>00544 <span class="keyword">  </span>{
<a name="l00545"></a>00545     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00546"></a>00546   }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00549"></a><a class="code" href="classBALL_1_1TFFT3D.html#abfe74a0de0c8ae9051d0d34f248fcfcb">00549</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#abfe74a0de0c8ae9051d0d34f248fcfcb">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMinY</a>()<span class="keyword"> const</span>
<a name="l00550"></a>00550 <span class="keyword">  </span>{
<a name="l00551"></a>00551     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00552"></a>00552   }
<a name="l00553"></a>00553 
<a name="l00554"></a>00554   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00555"></a><a class="code" href="classBALL_1_1TFFT3D.html#a2febbb6cde04c8b9d24bb764f2cada6f">00555</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a2febbb6cde04c8b9d24bb764f2cada6f">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMinZ</a>()<span class="keyword"> const</span>
<a name="l00556"></a>00556 <span class="keyword">  </span>{
<a name="l00557"></a>00557     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#aadd2239459e13f632066c978461d380b">minFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00558"></a>00558   }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00561"></a><a class="code" href="classBALL_1_1TFFT3D.html#aa56fcceec49087810d9dbdd191a95dd2">00561</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#aa56fcceec49087810d9dbdd191a95dd2">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMaxX</a>()<span class="keyword"> const</span>
<a name="l00562"></a>00562 <span class="keyword">  </span>{
<a name="l00563"></a>00563     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00564"></a>00564   }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00567"></a><a class="code" href="classBALL_1_1TFFT3D.html#a65d14fa2bb30fd119a805cfa0b2ebf8e">00567</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a65d14fa2bb30fd119a805cfa0b2ebf8e">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMaxY</a>()<span class="keyword"> const</span>
<a name="l00568"></a>00568 <span class="keyword">  </span>{
<a name="l00569"></a>00569     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00570"></a>00570   }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00573"></a><a class="code" href="classBALL_1_1TFFT3D.html#a6523b7f57f119b780e61a17e7ce8f3ad">00573</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a6523b7f57f119b780e61a17e7ce8f3ad">TFFT3D&lt;ComplexTraits&gt;::getFourierSpaceMaxZ</a>()<span class="keyword"> const</span>
<a name="l00574"></a>00574 <span class="keyword">  </span>{
<a name="l00575"></a>00575     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#af8f0934dcd93332935d433f8cb8de5a1">maxFourier_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00576"></a>00576   }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00579"></a><a class="code" href="classBALL_1_1TFFT3D.html#a370efbbacbac72daa06477ce5c883214">00579</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a370efbbacbac72daa06477ce5c883214">TFFT3D&lt;ComplexTraits&gt;::getMaxXIndex</a>()<span class="keyword"> const</span>
<a name="l00580"></a>00580 <span class="keyword">  </span>{
<a name="l00581"></a>00581     <span class="keywordflow">return</span> (<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a> - 1);
<a name="l00582"></a>00582   }
<a name="l00583"></a>00583   
<a name="l00584"></a>00584   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00585"></a><a class="code" href="classBALL_1_1TFFT3D.html#a6dfaa0d59f61844e76439027d696d7b5">00585</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a6dfaa0d59f61844e76439027d696d7b5">TFFT3D&lt;ComplexTraits&gt;::getMaxYIndex</a>()<span class="keyword"> const</span>
<a name="l00586"></a>00586 <span class="keyword">  </span>{
<a name="l00587"></a>00587     <span class="keywordflow">return</span> (<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> - 1);
<a name="l00588"></a>00588   }
<a name="l00589"></a>00589   
<a name="l00590"></a>00590   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00591"></a><a class="code" href="classBALL_1_1TFFT3D.html#a80e16b97822d9b170808b292171a7ee7">00591</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#a80e16b97822d9b170808b292171a7ee7">TFFT3D&lt;ComplexTraits&gt;::getMaxZIndex</a>()<span class="keyword"> const</span>
<a name="l00592"></a>00592 <span class="keyword">  </span>{
<a name="l00593"></a>00593     <span class="keywordflow">return</span> (<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a> - 1);
<a name="l00594"></a>00594   }
<a name="l00595"></a>00595   
<a name="l00596"></a>00596   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00597"></a><a class="code" href="classBALL_1_1TFFT3D.html#ac1d93424a5f3f98038804c54ec8d6b8e">00597</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT3D.html#ac1d93424a5f3f98038804c54ec8d6b8e">TFFT3D&lt;ComplexTraits&gt;::getNumberOfInverseTransforms</a>()<span class="keyword"> const</span>
<a name="l00598"></a>00598 <span class="keyword">  </span>{
<a name="l00599"></a>00599     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#abc7a17924e5e784f3bfe59ab2b524d2c">numFourierToPhys_</a>;
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00603"></a><a class="code" href="classBALL_1_1TFFT3D.html#a1aefb620b7066c4745a2ff86f59ecdbe">00603</a>   <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="classBALL_1_1TFFT3D.html#a1aefb620b7066c4745a2ff86f59ecdbe">TFFT3D&lt;ComplexTraits&gt;::getGridCoordinates</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> position)<span class="keyword"> const</span>
<a name="l00604"></a>00604 <span class="keyword">  </span>{
<a name="l00605"></a>00605     <span class="keywordflow">if</span> (!<a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a>)
<a name="l00606"></a>00606     {
<a name="l00607"></a>00607       <span class="keywordflow">if</span> (position &gt;= <a class="code" href="classBALL_1_1TRegularData3D.html#a69009ea6609406f0cbb908aff14c871c">ComplexVector::size</a>())
<a name="l00608"></a>00608       {
<a name="l00609"></a>00609         <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00610"></a>00610       }
<a name="l00611"></a>00611     
<a name="l00612"></a>00612       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> r;
<a name="l00613"></a>00613       <a class="code" href="classBALL__SIZE__TYPE.html">Position</a>  x, y, z;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615       z = position % <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00616"></a>00616       y = (position % (<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> * <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>)) / <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00617"></a>00617       x =  position / (<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> * <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619       r.<a class="code" href="classBALL_1_1TVector3.html#aa970790dafd3e206bc25b4388da60363">set</a>(-<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a> + (<span class="keywordtype">float</span>)x * <a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>,
<a name="l00620"></a>00620             -<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a> + (<span class="keywordtype">float</span>)y * <a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>,
<a name="l00621"></a>00621             -<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a> + (<span class="keywordtype">float</span>)z * <a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>);
<a name="l00622"></a>00622 
<a name="l00623"></a>00623       <span class="keywordflow">return</span> r;
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625     <span class="keywordflow">else</span>
<a name="l00626"></a>00626     {
<a name="l00627"></a>00627       <span class="keywordflow">if</span> (position &gt;= <a class="code" href="classBALL_1_1TRegularData3D.html#a69009ea6609406f0cbb908aff14c871c">ComplexVector::size</a>())
<a name="l00628"></a>00628       {
<a name="l00629"></a>00629         <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00630"></a>00630       }
<a name="l00631"></a>00631     
<a name="l00632"></a>00632       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> r;
<a name="l00633"></a>00633       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> x, y, z;
<a name="l00634"></a>00634   
<a name="l00635"></a>00635       z = position % <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00636"></a>00636       y = (position % (<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> * <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>)) / <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00637"></a>00637       x =  position / (<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a> * <a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639       <span class="keywordflow">if</span> (x&gt;=<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>/2.)
<a name="l00640"></a>00640       {
<a name="l00641"></a>00641         x-=<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>;
<a name="l00642"></a>00642       }
<a name="l00643"></a>00643       
<a name="l00644"></a>00644       <span class="keywordflow">if</span> (y&gt;=<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>/2.)
<a name="l00645"></a>00645       {
<a name="l00646"></a>00646         y-=<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>;
<a name="l00647"></a>00647       }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649       <span class="keywordflow">if</span> (z&gt;=<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>/2.)
<a name="l00650"></a>00650       {
<a name="l00651"></a>00651         z-=<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a>;
<a name="l00652"></a>00652       }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654       r.<a class="code" href="classBALL_1_1TVector3.html#aa970790dafd3e206bc25b4388da60363">set</a>((<span class="keywordtype">float</span>)x * <a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>,
<a name="l00655"></a>00655             (<span class="keywordtype">float</span>)y * <a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>,
<a name="l00656"></a>00656             (<span class="keywordtype">float</span>)z * <a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>);
<a name="l00657"></a>00657 
<a name="l00658"></a>00658       <span class="keywordflow">return</span> r;
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660   }
<a name="l00661"></a>00661   
<a name="l00662"></a>00662   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00663"></a><a class="code" href="classBALL_1_1TFFT3D.html#aca5bc037eb36c0b8b2c3c93f636f0934">00663</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TRegularData3D.html#acf56a85105c6ad28b5f7388760b443d5" title="Get the full data.">TFFT3D&lt;ComplexTraits&gt;::getData</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos) <span class="keyword">const</span>
<a name="l00664"></a>00664     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00665"></a>00665   {
<a name="l00666"></a>00666     <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> result;
<a name="l00667"></a>00667     <span class="keywordtype">double</span> normalization=1.;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00670"></a>00670     {
<a name="l00671"></a>00671       result = (*this)[pos];
<a name="l00672"></a>00672       normalization=1./((<a class="code" href="classfloat.html">float</a>)pow((<span class="keywordtype">float</span>)(lengthX_*lengthY_*lengthZ_),(<span class="keywordtype">int</span>)numFourierToPhys_));
<a name="l00673"></a>00673     }
<a name="l00674"></a>00674     <span class="keywordflow">else</span>
<a name="l00675"></a>00675     {
<a name="l00676"></a>00676       <span class="comment">// AR:</span>
<a name="l00677"></a>00677       <span class="comment">//old: result = (*this)[pos];</span>
<a name="l00678"></a>00678       result = (*this)[pos]*phase(pos);
<a name="l00679"></a>00679       
<a name="l00680"></a>00680       <span class="comment">//normalization=1./pow(sqrt(2.*M_PI),3)*(stepPhysX_*stepPhysY_*stepPhysZ_)/((float)pow((float)(lengthX_*lengthY_*lengthZ_),(int)numFourierToPhys_));</span>
<a name="l00681"></a>00681       
<a name="l00682"></a>00682       normalization=1./pow(sqrt(2.*M_PI),3)/((<a class="code" href="classfloat.html">float</a>)pow((<span class="keywordtype">float</span>)(lengthX_*lengthY_*lengthZ_),(<span class="keywordtype">int</span>)numFourierToPhys_));
<a name="l00683"></a>00683       <span class="comment">//normalization=1./(sqrt(2.*M_PI))*(stepPhysX_*stepPhysY_*stepPhysZ_)/((float)pow((float)(lengthX_*lengthY_*lengthZ_),(int)numFourierToPhys_));</span>
<a name="l00684"></a>00684     }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     result *= normalization;
<a name="l00687"></a>00687     
<a name="l00688"></a>00688     <span class="keywordflow">return</span> result;
<a name="l00689"></a>00689   }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00692"></a><a class="code" href="classBALL_1_1TFFT3D.html#ac04844cb7ba0b2de9eb4529f3428fa3e">00692</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TFFT3D.html#ac04844cb7ba0b2de9eb4529f3428fa3e">TFFT3D&lt;ComplexTraits&gt;::getInterpolatedValue</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos) <span class="keyword">const</span>
<a name="l00693"></a>00693     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00694"></a>00694   {
<a name="l00695"></a>00695     <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> result;
<a name="l00696"></a>00696     
<a name="l00697"></a>00697     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="group__MathsCommon.html#ga48cc5e26e859eca3082fc4ee4be51fa9">min</a>  = inFourierSpace_ ? minFourier_   :   minPhys_;
<a name="l00698"></a>00698     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="group__MathsCommon.html#ga7454a5315c85deffac5ab82b40185c7a">max</a>  = inFourierSpace_ ? maxFourier_   :   maxPhys_;
<a name="l00699"></a>00699     <span class="keywordtype">double</span> stepX = inFourierSpace_ ? stepFourierX_ : stepPhysX_;
<a name="l00700"></a>00700     <span class="keywordtype">double</span> stepY = inFourierSpace_ ? stepFourierY_ : stepPhysY_;
<a name="l00701"></a>00701     <span class="keywordtype">double</span> stepZ = inFourierSpace_ ? stepFourierZ_ : stepPhysZ_;
<a name="l00702"></a>00702     
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (    (pos.x &lt; min.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>) || (pos.y &lt; min.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>) || (pos.z &lt; min.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>)
<a name="l00704"></a>00704          || (pos.x &gt; max.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>) || (pos.y &gt; max.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>) || (pos.z &gt; max.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>) )
<a name="l00705"></a>00705     {
<a name="l00706"></a>00706       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00707"></a>00707     }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> <a class="code" href="namespaceBALL_1_1Constants.html#a4dd9a265fa2bfc6417cabda1b3c1a0b5">h</a>(pos.x - min.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>, pos.y - min.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>, pos.z - min.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>);
<a name="l00710"></a>00710     <span class="keywordtype">double</span> modX = fmod((<span class="keywordtype">double</span>)h.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>,stepX);
<a name="l00711"></a>00711     <span class="keywordtype">double</span> modY = fmod((<span class="keywordtype">double</span>)h.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>,stepY);
<a name="l00712"></a>00712     <span class="keywordtype">double</span> modZ = fmod((<span class="keywordtype">double</span>)h.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>,stepZ);
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <span class="keywordflow">if</span> (modX==0 &amp;&amp; modY==0 &amp;&amp; modZ==0) <span class="comment">// we are on the grid</span>
<a name="l00715"></a>00715     {
<a name="l00716"></a>00716       <span class="keywordflow">return</span> getData(pos);
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718 
<a name="l00719"></a>00719     <span class="keywordtype">double</span> beforeX = <a class="code" href="group__MathsCommon.html#gabb631d8f284308c9fa8247dd6b549af0">floor</a>(h.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>/stepX)*stepX+min.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00720"></a>00720     <span class="keywordtype">double</span> beforeY = <a class="code" href="group__MathsCommon.html#gabb631d8f284308c9fa8247dd6b549af0">floor</a>(h.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>/stepY)*stepY+min.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00721"></a>00721     <span class="keywordtype">double</span> beforeZ = <a class="code" href="group__MathsCommon.html#gabb631d8f284308c9fa8247dd6b549af0">floor</a>(h.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>/stepZ)*stepZ+min.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00722"></a>00722     <span class="keywordtype">double</span> afterX  =  ceil(h.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>/stepX)*stepX+min.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>;
<a name="l00723"></a>00723     <span class="keywordtype">double</span> afterY  =  ceil(h.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>/stepY)*stepY+min.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>;
<a name="l00724"></a>00724     <span class="keywordtype">double</span> afterZ  =  ceil(h.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>/stepZ)*stepZ+min.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>;
<a name="l00725"></a>00725       
<a name="l00726"></a>00726     <span class="keywordtype">double</span> tx = (pos.x - beforeX)/stepX;
<a name="l00727"></a>00727     <span class="keywordtype">double</span> ty = (pos.y - beforeY)/stepY;
<a name="l00728"></a>00728     <span class="keywordtype">double</span> tz = (pos.z - beforeZ)/stepZ;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730     result  = getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(beforeX,beforeY,beforeZ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((1.-tx)*(1.-ty)*(1.-tz));
<a name="l00731"></a>00731     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(afterX, beforeY,beforeZ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(    tx *(1.-ty)*(1.-tz));
<a name="l00732"></a>00732     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(beforeX,afterY, beforeZ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((1.-tx)*    ty *(1.-tz));
<a name="l00733"></a>00733     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(beforeX,beforeY,afterZ ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((1.-tx)*(1.-ty)*    tz );
<a name="l00734"></a>00734     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(afterX, afterY, beforeZ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(    tx *    ty *(1.-tz));
<a name="l00735"></a>00735     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(afterX, beforeY,afterZ ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(    tx *(1.-ty)*    tz );
<a name="l00736"></a>00736     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(beforeX,afterY, afterZ ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((1.-tx)*    ty *    tz );
<a name="l00737"></a>00737     result += getData(<a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(afterX, afterY, afterZ ))*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(    tx *    ty *    tz );
<a name="l00738"></a>00738 
<a name="l00739"></a>00739     <span class="keywordflow">return</span> result;
<a name="l00740"></a>00740   }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00743"></a><a class="code" href="classBALL_1_1TFFT3D.html#a85695f9763bd00643937149b71e40ea8">00743</a>   <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT3D.html#a85695f9763bd00643937149b71e40ea8">TFFT3D&lt;ComplexTraits&gt;::setData</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos, <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> val)
<a name="l00744"></a>00744     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00745"></a>00745   {
<a name="l00746"></a>00746     <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> dummy;
<a name="l00747"></a>00747   
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00749"></a>00749     {
<a name="l00750"></a>00750       dummy = <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">Complex</a>(val.real()*((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(lengthX_*lengthY_*lengthZ_),(<span class="keywordtype">int</span>)numFourierToPhys_)),
<a name="l00751"></a>00751                         val.imag()*((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(lengthX_*lengthY_*lengthZ_),(<span class="keywordtype">int</span>)numFourierToPhys_)));
<a name="l00752"></a>00752   
<a name="l00753"></a>00753       (*this)[pos]=dummy;
<a name="l00754"></a>00754     }
<a name="l00755"></a>00755     <span class="keywordflow">else</span>
<a name="l00756"></a>00756     {
<a name="l00757"></a>00757       val*=phase(pos)*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((pow(sqrt(2*M_PI),3)/(stepPhysX_*stepPhysY_*stepPhysZ_)))
<a name="l00758"></a>00758                      *((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(lengthX_*lengthY_*lengthZ_),(<span class="keywordtype">int</span>)numFourierToPhys_));
<a name="l00759"></a>00759       <span class="comment">/*val*=phase(pos)*(typename ComplexTraits::ComplexPrecision)((sqrt(2*M_PI)/(stepPhysX_*stepPhysY_*stepPhysZ_)))</span>
<a name="l00760"></a>00760 <span class="comment">                     *((typename ComplexTraits::ComplexPrecision)pow((typename ComplexTraits::ComplexPrecision)(lengthX_*lengthY_*lengthZ_),(int)numFourierToPhys_));*/</span>
<a name="l00761"></a>00761       
<a name="l00762"></a>00762       dummy = val;
<a name="l00763"></a>00763       
<a name="l00764"></a>00764       (*this)[pos]=dummy;
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766   }
<a name="l00767"></a>00767 
<a name="l00768"></a>00768   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00769"></a><a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">00769</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">TFFT3D&lt;ComplexTraits&gt;::operator[]</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos)
<a name="l00770"></a>00770     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00771"></a>00771   {
<a name="l00772"></a>00772     <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> internalPos;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00775"></a>00775     {
<a name="l00776"></a>00776       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> i, j, <a class="code" href="namespaceBALL_1_1Constants.html#a99a2eaccea2e7fbcdcbc9d49a64ccd69">k</a>;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778       i = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.x+origin_.x)/stepPhysX_);
<a name="l00779"></a>00779       j = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.y+origin_.y)/stepPhysY_);
<a name="l00780"></a>00780       k = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.z+origin_.z)/stepPhysZ_);
<a name="l00781"></a>00781       
<a name="l00782"></a>00782       internalPos = (k + (j + i*lengthY_)*lengthZ_);
<a name="l00783"></a>00783       
<a name="l00784"></a>00784       <span class="comment">/*(Index) rint(       (pos.z+origin_.z)/stepPhysZ_</span>
<a name="l00785"></a>00785 <span class="comment">                                  + (   (pos.y+origin_.y)/stepPhysY_</span>
<a name="l00786"></a>00786 <span class="comment">                                      + (pos.x+origin_.x)/stepPhysX_*lengthY_ </span>
<a name="l00787"></a>00787 <span class="comment">                                    ) * lengthZ_</span>
<a name="l00788"></a>00788 <span class="comment">                                ); */</span>
<a name="l00789"></a>00789     }
<a name="l00790"></a>00790     <span class="keywordflow">else</span>
<a name="l00791"></a>00791     {
<a name="l00792"></a>00792       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> i, j, <a class="code" href="namespaceBALL_1_1Constants.html#a99a2eaccea2e7fbcdcbc9d49a64ccd69">k</a>;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794       i = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.x/stepFourierX_);
<a name="l00795"></a>00795       j = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.y/stepFourierY_);
<a name="l00796"></a>00796       k = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.z/stepFourierZ_);
<a name="l00797"></a>00797 
<a name="l00798"></a>00798       <span class="keywordflow">if</span> (i&lt;0)
<a name="l00799"></a>00799       {
<a name="l00800"></a>00800         i+=lengthX_;
<a name="l00801"></a>00801       }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803       <span class="keywordflow">if</span> (j&lt;0)
<a name="l00804"></a>00804       {
<a name="l00805"></a>00805         j+=lengthY_;
<a name="l00806"></a>00806       }
<a name="l00807"></a>00807 
<a name="l00808"></a>00808       <span class="keywordflow">if</span> (k&lt;0)
<a name="l00809"></a>00809       {
<a name="l00810"></a>00810         k+=lengthZ_;
<a name="l00811"></a>00811       }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813       internalPos = (k + (j + i*lengthY_)*lengthZ_);
<a name="l00814"></a>00814     }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <span class="keywordflow">if</span> ((internalPos &lt; 0) || (internalPos&gt;=(<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) (lengthX_*lengthY_*lengthZ_)))
<a name="l00817"></a>00817     {
<a name="l00818"></a>00818       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820     
<a name="l00821"></a>00821     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TRegularData3D.html#a6a806d931455d299c1fca21ead744601">TRegularData3D&lt;Complex&gt;::operator[]</a>((<a class="code" href="classBALL__SIZE__TYPE.html">Position</a>)internalPos);
<a name="l00822"></a>00822   }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00825"></a><a class="code" href="classBALL_1_1TFFT3D.html#ac75aa76d2175d823e7cd6a3487f20cce">00825</a>   <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT3D.html#a72c9dc1cd41881f125f81e2f7804a729">TFFT3D&lt;ComplexTraits&gt;::operator[]</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos) <span class="keyword">const</span>
<a name="l00826"></a>00826     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00827"></a>00827   {
<a name="l00828"></a>00828     <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> internalPos;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00831"></a>00831     {
<a name="l00832"></a>00832       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> i, j, <a class="code" href="namespaceBALL_1_1Constants.html#a99a2eaccea2e7fbcdcbc9d49a64ccd69">k</a>;
<a name="l00833"></a>00833 
<a name="l00834"></a>00834       i = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.x+origin_.x)/stepPhysX_);
<a name="l00835"></a>00835       j = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.y+origin_.y)/stepPhysY_);
<a name="l00836"></a>00836       k = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>((pos.z+origin_.z)/stepPhysZ_);
<a name="l00837"></a>00837       
<a name="l00838"></a>00838       internalPos = (k + (j + i*lengthY_)*lengthZ_);
<a name="l00839"></a>00839       
<a name="l00840"></a>00840       <span class="comment">/*(Index) rint(       (pos.z+origin_.z)/stepPhysZ_</span>
<a name="l00841"></a>00841 <span class="comment">                                  + (   (pos.y+origin_.y)/stepPhysY_</span>
<a name="l00842"></a>00842 <span class="comment">                                      + (pos.x+origin_.x)/stepPhysX_*lengthY_ </span>
<a name="l00843"></a>00843 <span class="comment">                                    ) * lengthZ_</span>
<a name="l00844"></a>00844 <span class="comment">                                ); */</span>
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846     <span class="keywordflow">else</span>
<a name="l00847"></a>00847     {
<a name="l00848"></a>00848       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> i, j, <a class="code" href="namespaceBALL_1_1Constants.html#a99a2eaccea2e7fbcdcbc9d49a64ccd69">k</a>;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850       i = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.x/stepFourierX_);
<a name="l00851"></a>00851       j = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.y/stepFourierY_);
<a name="l00852"></a>00852       k = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.z/stepFourierZ_);
<a name="l00853"></a>00853 
<a name="l00854"></a>00854       <span class="keywordflow">if</span> (i&lt;0)
<a name="l00855"></a>00855       {
<a name="l00856"></a>00856         i+=lengthX_;
<a name="l00857"></a>00857       }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859       <span class="keywordflow">if</span> (j&lt;0)
<a name="l00860"></a>00860       {
<a name="l00861"></a>00861         j+=lengthY_;
<a name="l00862"></a>00862       }
<a name="l00863"></a>00863 
<a name="l00864"></a>00864       <span class="keywordflow">if</span> (k&lt;0)
<a name="l00865"></a>00865       {
<a name="l00866"></a>00866         k+=lengthZ_;
<a name="l00867"></a>00867       }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869       internalPos = (k + (j + i*lengthY_)*lengthZ_);
<a name="l00870"></a>00870     }
<a name="l00871"></a>00871 
<a name="l00872"></a>00872     <span class="keywordflow">if</span> ((internalPos &lt; 0) || (internalPos&gt;=(<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) (lengthX_*lengthY_*lengthZ_)))
<a name="l00873"></a>00873     {
<a name="l00874"></a>00874       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00875"></a>00875     }
<a name="l00876"></a>00876     
<a name="l00877"></a>00877     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TRegularData3D.html#a6a806d931455d299c1fca21ead744601">TRegularData3D&lt;Complex&gt;::operator[]</a>((<a class="code" href="classBALL__SIZE__TYPE.html">Position</a>)internalPos);
<a name="l00878"></a>00878   }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880   <span class="comment">/*Complex&amp; TFFT3D&lt;ComplexTraits&gt;::operator[](const Position&amp; pos)</span>
<a name="l00881"></a>00881 <span class="comment">    throw(Exception::OutOfGrid)</span>
<a name="l00882"></a>00882 <span class="comment">  {</span>
<a name="l00883"></a>00883 <span class="comment">    return operator [] (pos);</span>
<a name="l00884"></a>00884 <span class="comment">  }</span>
<a name="l00885"></a>00885 <span class="comment"></span>
<a name="l00886"></a>00886 <span class="comment">  const Complex&amp; TFFT3D&lt;ComplexTraits&gt;::operator[](const Position&amp; pos) const</span>
<a name="l00887"></a>00887 <span class="comment">    throw(Exception::OutOfGrid)</span>
<a name="l00888"></a>00888 <span class="comment">  {</span>
<a name="l00889"></a>00889 <span class="comment">    return operator [] (pos);</span>
<a name="l00890"></a>00890 <span class="comment">  }</span>
<a name="l00891"></a>00891 <span class="comment">*/</span>
<a name="l00892"></a>00892   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00893"></a><a class="code" href="classBALL_1_1TFFT3D.html#a4577167db42f278c8c9adf3c3d6f5c95">00893</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TFFT3D.html#a4577167db42f278c8c9adf3c3d6f5c95">TFFT3D&lt;ComplexTraits&gt;::phase</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; pos)<span class="keyword"> const</span>
<a name="l00894"></a>00894 <span class="keyword">  </span>{
<a name="l00895"></a>00895     
<a name="l00896"></a>00896     <span class="comment">// AR: old version: -2.*M_PI...</span>
<a name="l00897"></a>00897     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT3D.html#a4577167db42f278c8c9adf3c3d6f5c95">phase</a> = 2.*M_PI*(  (<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>/<a class="code" href="classBALL_1_1TFFT3D.html#aac57d2c6c6b74abd3331e30259e88d56">stepFourierX_</a>))*(<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a2f557afc0d2f05a3db314759edffb997">x</a>/<a class="code" href="classBALL_1_1TFFT3D.html#a915e7ff337505ce4163678e854361d67">stepPhysX_</a>))
<a name="l00898"></a>00898                               /<a class="code" href="classBALL_1_1TFFT3D.html#a996dd4471e081aacfa580005ff0eadc8">lengthX_</a>
<a name="l00899"></a>00899                             + (<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>/<a class="code" href="classBALL_1_1TFFT3D.html#a610bc82a6217bbe1d08c973d335e8c86">stepFourierY_</a>))*(<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#a9ce51f254c7d9a36bb908671e4647770">y</a>/<a class="code" href="classBALL_1_1TFFT3D.html#a26166483d7b5de6f8af1090153db0f3a">stepPhysY_</a>))
<a name="l00900"></a>00900                               /<a class="code" href="classBALL_1_1TFFT3D.html#a3d3d2df0f9154be7ede36c83605dd139">lengthY_</a>
<a name="l00901"></a>00901                             + (<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(pos.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>/<a class="code" href="classBALL_1_1TFFT3D.html#ad73489bd11b9bd49c95df3ab64026a2b">stepFourierZ_</a>))*(<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">Maths::rint</a>(<a class="code" href="classBALL_1_1TFFT3D.html#aa6c94e8bb833000db7b04921941f730d" title="Origin of the grid (offset).">origin_</a>.<a class="code" href="classBALL_1_1TVector3.html#ae9e86d411c82766f6fc8886f81e06201">z</a>/<a class="code" href="classBALL_1_1TFFT3D.html#a685a581b5fa3c29d6ffadf4499006f06">stepPhysZ_</a>))
<a name="l00902"></a>00902                               /<a class="code" href="classBALL_1_1TFFT3D.html#a99ab8552a4b2994af84a36474f111659">lengthZ_</a> );
<a name="l00903"></a>00903   
<a name="l00904"></a>00904 
<a name="l00905"></a>00905     <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a> result = <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">Complex</a>(cos(phase), sin(phase));
<a name="l00906"></a>00906             
<a name="l00907"></a>00907     <span class="keywordflow">return</span> result;
<a name="l00908"></a>00908     
<a name="l00909"></a>00909     <span class="comment">/*double phase = -2.*M_PI*(  (rint(pos.x/stepFourierX_))*(rint(origin_.x/stepPhysX_))</span>
<a name="l00910"></a>00910 <span class="comment">                              /lengthX_</span>
<a name="l00911"></a>00911 <span class="comment">                            + (Maths::rint(pos.y/stepFourierY_))*(Maths::rint(origin_.y/stepPhysY_))</span>
<a name="l00912"></a>00912 <span class="comment">                              /lengthY_</span>
<a name="l00913"></a>00913 <span class="comment">                            + (Maths::rint(pos.z/stepFourierZ_))*(Maths::rint(origin_.z/stepPhysZ_))</span>
<a name="l00914"></a>00914 <span class="comment">                              /lengthZ_ );</span>
<a name="l00915"></a>00915 <span class="comment">  </span>
<a name="l00916"></a>00916 <span class="comment"></span>
<a name="l00917"></a>00917 <span class="comment">    Complex result = Complex(cos(phase), sin(phase));</span>
<a name="l00918"></a>00918 <span class="comment">            </span>
<a name="l00919"></a>00919 <span class="comment">    return result;*/</span>
<a name="l00920"></a>00920   }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00923"></a><a class="code" href="classBALL_1_1TFFT3D.html#adb04f543ba9008685b35d428ac7229f9">00923</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT3D.html#adb04f543ba9008685b35d428ac7229f9">TFFT3D&lt;ComplexTraits&gt;::isInFourierSpace</a>()<span class="keyword"> const</span>
<a name="l00924"></a>00924 <span class="keyword">  </span>{
<a name="l00925"></a>00925     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT3D.html#aacb32d7527011db3d9fbdfd62c41422b">inFourierSpace_</a>;
<a name="l00926"></a>00926   }
<a name="l00927"></a>00927   
<a name="l00928"></a>00928   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00929"></a>00929   <span class="keyword">const</span> <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;&amp; <span class="keyword">operator</span>&lt;&lt; 
<a name="l00930"></a><a class="code" href="namespaceBALL.html#a4bc43779ec5edee296d4ec23c431a536">00930</a>     (<a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;&amp; to, <span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT3D.html">TFFT3D&lt;ComplexTraits&gt;</a>&amp; from)
<a name="l00931"></a>00931   {
<a name="l00932"></a>00932     <span class="comment">// first decide if the TFFT3D data is in Fourier space.</span>
<a name="l00933"></a>00933     <span class="keywordflow">if</span> (!from.isInFourierSpace())
<a name="l00934"></a>00934     {
<a name="l00935"></a>00935       <span class="comment">// create a new grid</span>
<a name="l00936"></a>00936       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthX = from.getMaxXIndex()+1;
<a name="l00937"></a>00937       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthY = from.getMaxYIndex()+1;
<a name="l00938"></a>00938       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthZ = from.getMaxZIndex()+1;
<a name="l00939"></a>00939       
<a name="l00940"></a>00940       <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt; newGrid(<a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D</a>&lt;<span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;::IndexType(lengthX, lengthY, lengthZ),
<a name="l00941"></a>00941                                       <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getPhysSpaceMinX(), from.getPhysSpaceMinY(), from.getPhysSpaceMinZ()),
<a name="l00942"></a>00942                                       <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getPhysSpaceMaxX(), from.getPhysSpaceMaxY(), from.getPhysSpaceMaxZ()));
<a name="l00943"></a>00943 
<a name="l00944"></a>00944       <span class="comment">// and fill it</span>
<a name="l00945"></a>00945       <span class="keywordtype">double</span> normalization=1./(pow((<span class="keywordtype">float</span>)(lengthX*lengthY*lengthZ),(<span class="keywordtype">int</span>)from.getNumberOfInverseTransforms()));
<a name="l00946"></a>00946       <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataIn;
<a name="l00947"></a>00947       <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataOut;
<a name="l00948"></a>00948       
<a name="l00949"></a>00949       <span class="keywordflow">for</span> (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l00950"></a>00950       {
<a name="l00951"></a>00951         <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> x, y, z;
<a name="l00952"></a>00952 
<a name="l00953"></a>00953         z =  i % lengthZ;
<a name="l00954"></a>00954         y = (i % (lengthY * lengthZ)) / lengthZ;
<a name="l00955"></a>00955         x =  i / (lengthY * lengthZ);
<a name="l00956"></a>00956 
<a name="l00957"></a>00957         dataIn  = from[i];
<a name="l00958"></a>00958         dataOut = dataIn;
<a name="l00959"></a>00959         
<a name="l00960"></a>00960         newGrid[x + (y + z*lengthY)*lengthZ] = dataOut*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)normalization;
<a name="l00961"></a>00961       }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963       to = newGrid;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965       <span class="keywordflow">return</span> to;
<a name="l00966"></a>00966     }
<a name="l00967"></a>00967     <span class="keywordflow">else</span>
<a name="l00968"></a>00968     {
<a name="l00969"></a>00969       <span class="comment">// we are in Fourier space</span>
<a name="l00970"></a>00970       
<a name="l00971"></a>00971       <span class="comment">// create a new grid</span>
<a name="l00972"></a>00972       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthX = from.getMaxXIndex()+1;
<a name="l00973"></a>00973       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthY = from.getMaxYIndex()+1;
<a name="l00974"></a>00974       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthZ = from.getMaxZIndex()+1;
<a name="l00975"></a>00975       <span class="comment">//float stepPhysX = from.getPhysStepWidthX();</span>
<a name="l00976"></a>00976       <span class="comment">//float stepPhysY = from.getPhysStepWidthY();</span>
<a name="l00977"></a>00977       <span class="comment">//float stepPhysZ = from.getPhysStepWidthZ();</span>
<a name="l00978"></a>00978       <span class="keywordtype">float</span> stepFourierX = from.getFourierStepWidthX();
<a name="l00979"></a>00979       <span class="keywordtype">float</span> stepFourierY = from.getFourierStepWidthY();
<a name="l00980"></a>00980       <span class="keywordtype">float</span> stepFourierZ = from.getFourierStepWidthZ();
<a name="l00981"></a>00981 
<a name="l00982"></a>00982 
<a name="l00983"></a>00983       
<a name="l00984"></a>00984       <a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D&lt;typename TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt; newGrid(<a class="code" href="classBALL_1_1TRegularData3D.html">TRegularData3D</a>&lt;<span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a>&gt;::IndexType(lengthX, lengthY, lengthZ),
<a name="l00985"></a>00985                                       <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getFourierSpaceMinX(), 
<a name="l00986"></a>00986                                               from.getFourierSpaceMinY(),
<a name="l00987"></a>00987                                               from.getFourierSpaceMinZ()),
<a name="l00988"></a>00988                                       <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getFourierSpaceMaxX(),
<a name="l00989"></a>00989                                               from.getFourierSpaceMaxY(),
<a name="l00990"></a>00990                                               from.getFourierSpaceMaxZ()));
<a name="l00991"></a>00991 
<a name="l00992"></a>00992       <span class="comment">// and fill it</span>
<a name="l00993"></a>00993       <span class="comment">// AR: old double normalization=1./(sqrt(2.*M_PI))*(stepPhysX*stepPhysY*stepPhysZ)/(pow((float)(lengthX*lengthY*lengthZ),from.getNumberOfInverseTransforms()));</span>
<a name="l00994"></a>00994       <span class="keywordtype">double</span> normalization=1./pow(sqrt(2.*M_PI),3)/(pow((<span class="keywordtype">float</span>)(lengthX*lengthY*lengthZ),(<span class="keywordtype">int</span>)from.getNumberOfInverseTransforms()));
<a name="l00995"></a>00995       
<a name="l00996"></a>00996       
<a name="l00997"></a>00997       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> x, y, z;
<a name="l00998"></a>00998       <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> r;
<a name="l00999"></a>00999       <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataIn;
<a name="l01000"></a>01000       <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT3D.html#a037ed783745f375bbc70b4689e8933ff">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataOut;
<a name="l01001"></a>01001   
<a name="l01002"></a>01002       <span class="keywordflow">for</span> (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l01003"></a>01003       {
<a name="l01004"></a>01004         z =  i % lengthZ;
<a name="l01005"></a>01005         y = (i % (lengthY * lengthZ)) / lengthZ;
<a name="l01006"></a>01006         x =  i / (lengthY * lengthZ);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordflow">if</span> (x&gt;lengthX/2.)
<a name="l01009"></a>01009         {
<a name="l01010"></a>01010           x-=lengthX;
<a name="l01011"></a>01011         }
<a name="l01012"></a>01012 
<a name="l01013"></a>01013         <span class="keywordflow">if</span> (y&gt;lengthY/2.)
<a name="l01014"></a>01014         {
<a name="l01015"></a>01015           y-=lengthY;
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018         <span class="keywordflow">if</span> (z&gt;lengthZ/2.)
<a name="l01019"></a>01019         {
<a name="l01020"></a>01020           z-=lengthZ;
<a name="l01021"></a>01021         }
<a name="l01022"></a>01022 
<a name="l01023"></a>01023         r.<a class="code" href="classBALL_1_1TVector3.html#aa970790dafd3e206bc25b4388da60363">set</a>((<span class="keywordtype">float</span>)x * stepFourierX,
<a name="l01024"></a>01024               (<span class="keywordtype">float</span>)y * stepFourierY,
<a name="l01025"></a>01025               (<span class="keywordtype">float</span>)z * stepFourierZ);
<a name="l01026"></a>01026 
<a name="l01027"></a>01027         dataIn = from[i];
<a name="l01028"></a>01028         dataOut = dataIn;
<a name="l01029"></a>01029         
<a name="l01030"></a>01030         newGrid[x + (y + z*lengthY)*lengthZ] = dataOut*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)normalization*from.phase(r);
<a name="l01031"></a>01031       }
<a name="l01032"></a>01032 
<a name="l01033"></a>01033       to = newGrid;
<a name="l01034"></a>01034 
<a name="l01035"></a>01035       <span class="keywordflow">return</span> to;
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037   }
<a name="l01038"></a>01038   
<a name="l01039"></a>01039   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l01040"></a>01040   <span class="keyword">const</span> <a class="code" href="namespaceBALL.html#a4d66d487ac43a499e5f5ec49ee376671">RegularData3D</a>&amp; operator &lt;&lt; (RegularData3D&amp; to, const TFFT3D&lt;ComplexTraits&gt;&amp; from)
<a name="l01041"></a>01041   {
<a name="l01042"></a>01042     <span class="comment">// first decide if the TFFT3D data is in Fourier space.</span>
<a name="l01043"></a>01043     <span class="keywordflow">if</span> (!from.isInFourierSpace())
<a name="l01044"></a>01044     {
<a name="l01045"></a>01045       <span class="comment">// create a new grid</span>
<a name="l01046"></a>01046       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthX = from.getMaxXIndex()+1;
<a name="l01047"></a>01047       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthY = from.getMaxYIndex()+1;
<a name="l01048"></a>01048       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthZ = from.getMaxZIndex()+1;
<a name="l01049"></a>01049       
<a name="l01050"></a>01050       <a class="code" href="namespaceBALL.html#a4d66d487ac43a499e5f5ec49ee376671">RegularData3D</a> newGrid(RegularData3D::IndexType(lengthX, lengthY, lengthZ), <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getPhysSpaceMinX(), from.getPhysSpaceMinY(), from.getPhysSpaceMinZ()),
<a name="l01051"></a>01051 <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getPhysSpaceMaxX(), from.getPhysSpaceMaxY(), from.getPhysSpaceMaxZ()));
<a name="l01052"></a>01052 
<a name="l01053"></a>01053       <span class="comment">// and fill it</span>
<a name="l01054"></a>01054       <span class="keywordtype">double</span> normalization = 1./(pow((<span class="keywordtype">float</span>)(lengthX*lengthY*lengthZ),(<span class="keywordtype">int</span>)from.getNumberOfInverseTransforms()));
<a name="l01055"></a>01055       <span class="keyword">typename</span> <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataIn;
<a name="l01056"></a>01056       <span class="keyword">typename</span> <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataOut;
<a name="l01057"></a>01057       
<a name="l01058"></a>01058       <span class="keywordflow">for</span> (<a class="code" href="namespaceBALL.html#a82ff7480a7f116784f9ee4ce6b1dbc93">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l01059"></a>01059       {
<a name="l01060"></a>01060         <a class="code" href="namespaceBALL.html#a82ff7480a7f116784f9ee4ce6b1dbc93">Position</a> x, y, z;
<a name="l01061"></a>01061 
<a name="l01062"></a>01062         z =  i % lengthZ;
<a name="l01063"></a>01063         y = (i % (lengthY * lengthZ)) / lengthZ;
<a name="l01064"></a>01064         x =  i / (lengthY * lengthZ);
<a name="l01065"></a>01065 
<a name="l01066"></a>01066         dataIn  = from[i];
<a name="l01067"></a>01067         dataOut = dataIn;
<a name="l01068"></a>01068         
<a name="l01069"></a>01069         newGrid[x + (y + z*lengthY)*lengthZ] = dataOut.real()*normalization;
<a name="l01070"></a>01070       }
<a name="l01071"></a>01071 
<a name="l01072"></a>01072       to = newGrid;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074       <span class="keywordflow">return</span> to;
<a name="l01075"></a>01075     }
<a name="l01076"></a>01076     <span class="keywordflow">else</span>
<a name="l01077"></a>01077     {
<a name="l01078"></a>01078       <span class="comment">// we are in Fourier space</span>
<a name="l01079"></a>01079       
<a name="l01080"></a>01080       <span class="comment">// create a new grid</span>
<a name="l01081"></a>01081       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthX = from.getMaxXIndex()+1;
<a name="l01082"></a>01082       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthY = from.getMaxYIndex()+1;
<a name="l01083"></a>01083       <a class="code" href="namespaceBALL.html#a2a2e3db12eb28d34cc8bd86376326413">Size</a> lengthZ = from.getMaxZIndex()+1;
<a name="l01084"></a>01084       <span class="comment">//float stepPhysX = from.getPhysStepWidthX();</span>
<a name="l01085"></a>01085       <span class="comment">//float stepPhysY = from.getPhysStepWidthY();</span>
<a name="l01086"></a>01086       <span class="comment">//float stepPhysZ = from.getPhysStepWidthZ();</span>
<a name="l01087"></a>01087       <span class="keywordtype">float</span> stepFourierX = from.getFourierStepWidthX();
<a name="l01088"></a>01088       <span class="keywordtype">float</span> stepFourierY = from.getFourierStepWidthY();
<a name="l01089"></a>01089       <span class="keywordtype">float</span> stepFourierZ = from.getFourierStepWidthZ();
<a name="l01090"></a>01090 
<a name="l01091"></a>01091 
<a name="l01092"></a>01092       
<a name="l01093"></a>01093       <a class="code" href="namespaceBALL.html#a4d66d487ac43a499e5f5ec49ee376671">RegularData3D</a> newGrid(RegularData3D::IndexType(lengthX, lengthY, lengthZ), <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getFourierSpaceMinX(), from.getFourierSpaceMinY(), from.getFourierSpaceMinZ()), <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a>(from.getFourierSpaceMaxX(), from.getFourierSpaceMaxY(), from.getFourierSpaceMaxZ()));
<a name="l01094"></a>01094 
<a name="l01095"></a>01095       <span class="comment">// and fill it</span>
<a name="l01096"></a>01096       <span class="comment">// AR: old version double normalization=1./(sqrt(2.*M_PI))*(stepPhysX*stepPhysY*stepPhysZ)/(pow((float)(lengthX*lengthY*lengthZ),from.getNumberOfInverseTransforms()));</span>
<a name="l01097"></a>01097       <span class="keywordtype">double</span> normalization=1./pow(sqrt(2.*M_PI),3)/(pow((<span class="keywordtype">float</span>)(lengthX*lengthY*lengthZ),(<span class="keywordtype">int</span>)from.getNumberOfInverseTransforms()));
<a name="l01098"></a>01098       
<a name="l01099"></a>01099       <a class="code" href="namespaceBALL.html#af0843eac59f86cb6e03bf77a9c462868">Index</a> x, y, z;
<a name="l01100"></a>01100       <span class="keywordtype">signed</span> <span class="keywordtype">int</span> xp, yp, zp;
<a name="l01101"></a>01101       <a class="code" href="namespaceBALL.html#aa9fccf5a468c02f8dc3cd89925e7affd">Vector3</a> r;
<a name="l01102"></a>01102       <span class="keyword">typename</span> <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataIn;
<a name="l01103"></a>01103       <span class="keyword">typename</span> <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">TFFT3D&lt;ComplexTraits&gt;::Complex</a> dataOut;
<a name="l01104"></a>01104   
<a name="l01105"></a>01105       <span class="keywordflow">for</span> (<a class="code" href="namespaceBALL.html#a82ff7480a7f116784f9ee4ce6b1dbc93">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l01106"></a>01106       {
<a name="l01107"></a>01107         z =  i % lengthZ;
<a name="l01108"></a>01108         y = (i % (lengthY * lengthZ)) / lengthZ;
<a name="l01109"></a>01109         x =  i / (lengthY * lengthZ);
<a name="l01110"></a>01110         
<a name="l01111"></a>01111         xp = x;
<a name="l01112"></a>01112         yp = y;
<a name="l01113"></a>01113         zp = z;
<a name="l01114"></a>01114 
<a name="l01115"></a>01115         <span class="keywordflow">if</span> (xp&gt;=lengthX/2.)
<a name="l01116"></a>01116         {
<a name="l01117"></a>01117           xp-=(int)lengthX;
<a name="l01118"></a>01118         }
<a name="l01119"></a>01119         <span class="keywordflow">if</span> (yp&gt;=lengthY/2.)
<a name="l01120"></a>01120         {
<a name="l01121"></a>01121           yp-=(int)lengthY;
<a name="l01122"></a>01122         }
<a name="l01123"></a>01123         <span class="keywordflow">if</span> (zp&gt;=lengthZ/2.)
<a name="l01124"></a>01124         {
<a name="l01125"></a>01125           zp-=(int)lengthZ;
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         <span class="keywordflow">if</span> (x&gt;=lengthX/2.)
<a name="l01129"></a>01129         {
<a name="l01130"></a>01130           x-=(int)(lengthX/2.);
<a name="l01131"></a>01131         }
<a name="l01132"></a>01132         <span class="keywordflow">else</span>
<a name="l01133"></a>01133         {
<a name="l01134"></a>01134           x+=(int)(lengthX/2.);
<a name="l01135"></a>01135         }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137         <span class="keywordflow">if</span> (y&gt;=lengthY/2.)
<a name="l01138"></a>01138         {
<a name="l01139"></a>01139           y-=(int)(lengthY/2.);
<a name="l01140"></a>01140         }
<a name="l01141"></a>01141         <span class="keywordflow">else</span>
<a name="l01142"></a>01142         {
<a name="l01143"></a>01143           y+=(int)(lengthY/2.);
<a name="l01144"></a>01144         }
<a name="l01145"></a>01145 
<a name="l01146"></a>01146         <span class="keywordflow">if</span> (z&gt;=lengthZ/2.)
<a name="l01147"></a>01147         {
<a name="l01148"></a>01148           z-=(int)(lengthZ/2.);
<a name="l01149"></a>01149         }
<a name="l01150"></a>01150         <span class="keywordflow">else</span>
<a name="l01151"></a>01151         {
<a name="l01152"></a>01152           z+=(int)(lengthZ/2.);
<a name="l01153"></a>01153         }
<a name="l01154"></a>01154 
<a name="l01155"></a>01155         r.set((<span class="keywordtype">float</span>)xp * stepFourierX,
<a name="l01156"></a>01156               (<span class="keywordtype">float</span>)yp * stepFourierY,
<a name="l01157"></a>01157               (<span class="keywordtype">float</span>)zp * stepFourierZ);
<a name="l01158"></a>01158 
<a name="l01159"></a>01159         dataIn = from[i];
<a name="l01160"></a>01160         dataOut = dataIn;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162         newGrid[x + (y + z*lengthY)*lengthZ] = (dataOut*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)normalization*from.phase(r)).real();
<a name="l01163"></a>01163       }
<a name="l01164"></a>01164 
<a name="l01165"></a>01165       to = newGrid;
<a name="l01166"></a>01166 
<a name="l01167"></a>01167       return to;
<a name="l01168"></a>01168     }
<a name="l01169"></a>01169   } 
<a name="l01170"></a>01170 }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172 <span class="preprocessor">#endif // BALL_MATHS_TFFT3D_H</span>
</pre></div></div>
</div>
</body>
</html>
