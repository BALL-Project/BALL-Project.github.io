<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
  <div class="navpath"><a class="el" href="namespaceBALL.html">BALL</a>::<a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a>
  </div>
<div class="contents">
<h1>BALL::StrangLBFGSMinimizer Class Reference<br/>
<small>
[<a class="el" href="group__MolmecEnergyMinimizer.html">Energy Minimizer</a>]</small>
</h1><!-- doxytag: class="BALL::StrangLBFGSMinimizer" --><!-- doxytag: inherits="BALL::EnergyMinimizer" -->
<p><code>#include &lt;<a class="el" href="strangLBFGS_8h_source.html">BALL/MOLMEC/MINIMIZATION/strangLBFGS.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BALL::StrangLBFGSMinimizer:</div>
<div class="dynsection">
<img class="center" src="classBALL_1_1StrangLBFGSMinimizer.png" usemap="#BALL::StrangLBFGSMinimizer_map" alt=""/>
<map id="BALL::StrangLBFGSMinimizer_map">
<area href="classBALL_1_1EnergyMinimizer.html" alt="BALL::EnergyMinimizer" shape="rect" coords="0,0,180,24"/>
</map>
</div>

<p><a href="classBALL_1_1StrangLBFGSMinimizer-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br/><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBALL_1_1StrangLBFGSMinimizer_1_1Default.html">Default</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBALL_1_1StrangLBFGSMinimizer_1_1Option.html">Option</a></td></tr>
<tr><td colspan="2"><br/><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors and Destructors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#aade06c1eed8a038cdf56ef368728b0be">StrangLBFGSMinimizer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a6c0466ef893da85f9a829f9da1519ee1">StrangLBFGSMinimizer</a> (<a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;force_field)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#aae03450aacde92765b8a8ca70a374d47">StrangLBFGSMinimizer</a> (<a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;force_field, <a class="el" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a> *ssm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a88a5d3649f3a73790287ef4524c4a3d3">StrangLBFGSMinimizer</a> (<a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;force_field, <a class="el" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a> *ssm, const <a class="el" href="classBALL_1_1Options.html">Options</a> &amp;<a class="el" href="classBALL_1_1EnergyMinimizer.html#a96b309d96054f91c2ee6b631ae9dacb7">options</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a2c5aa30a217cda9d942ddc95b3e98007">StrangLBFGSMinimizer</a> (<a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;force_field, const <a class="el" href="classBALL_1_1Options.html">Options</a> &amp;<a class="el" href="classBALL_1_1EnergyMinimizer.html#a96b309d96054f91c2ee6b631ae9dacb7">options</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#af3a9e512df9c67ce71a582e1405f4f55">StrangLBFGSMinimizer</a> (const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a> &amp;rhs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a4cd6986b78ea0d20a1024e31013c0a33">~StrangLBFGSMinimizer</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader">Assignments</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a2230228b5edaf4fd2abe832b896d4337">operator=</a> (const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a> &amp;rhs)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Setup methods. They do all necessary preparations.</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a861d3d9a9536ef977c369d27c932ca16">specificSetup</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader">Accessors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a90ab583dbccbc375b30de91a099e605b">setMaxNumOfStoredVectPairs</a> (<a class="el" href="classBALL__SIZE__TYPE.html">Size</a> num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a8df12442c46fcb241b1549960942259a">getMaxNumOfStoredVectPairs</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a377c51906ceb0288aa85ad523bf0f5ed">setImprovedFlag</a> (<a class="el" href="classbool.html">bool</a> flag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a7b0ba3bf6208bfeae7c75d61093c619b">getImprovedFlag</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a24ae7fae3579c13b90f3b8f0a7452ddc">findStep</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a5c8fc2f49e18d5ae98f8a8dfe39c99d5">updateDirection</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a69af23e7f46f9ba26de0872dd7b1d0a4">minimize</a> (<a class="el" href="classBALL__SIZE__TYPE.html">Size</a> iterations=0, <a class="el" href="classbool.html">bool</a> resume=false)</td></tr>
<tr><td colspan="2"><br/><h2>Protected Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Protected Attributes</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL_1_1LineSearch.html">LineSearch</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ab54bc016fdc878fd1c5e8f93b47c4043">line_search_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a4a44fa5b52ceda4992c4ecec285fd324">first_iter_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ac35e9843ffa836ec34f006653e66f903">number_of_atoms_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a3b07b12c8f57c354c0802fd3efada72e">max_num_of_vect_pairs_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a8544b115b1201d6ecd25dcb1e0c38904">curr_num_of_vect_pairs_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a888c406a0381617eae64c91036fa155d">improved_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="classfloat.html">float</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ac3fe2e040f801ee5bcc2b0e19b5870b4">rho_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="classBALL_1_1TVector3.html">Vector3</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a71d385216b75d6ccd540c480a1fa10f3">stored_s_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="classBALL_1_1TVector3.html">Vector3</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a1901bd82b113b39454cfa50639602ec3">stored_y_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="classfloat.html">float</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a32c45b7c564763727a67868b7e780f5c">work_val_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ad254a6f88b4f9ac040fd44f117f62561">index_of_free_vect_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classBALL_1_1TVector3.html">Vector3</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a683fe6a85fa864e6d9ddd2f8296dd986">initial_atoms_</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Limited-memory BFGS minimizer based on the Strang recurrence. A minimizer for geometry optimization based on the limited-memory BFGS method proposed in</p>
<p>[1] Nocedal J.: Updating quasi-Newton matrices with limited storage. Math. Comp. 35 (1980) 773-782.</p>
<p>[2] Liu D.C., Nocedal J.: On the limited memory BFGS method for large scale optimization. Math. Programming 45 (1989) 503-528.</p>
<p>If the 'improved' option is set, ideas proposed in</p>
<p>[3] Mehiddin Al-Baali: Improved Hessian approximations for the limited memory BFGS method. Numerical Algorithms 22 (1999) 99-112</p>
<p>are adopted. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aade06c1eed8a038cdf56ef368728b0be"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="aade06c1eed8a038cdf56ef368728b0be" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="structBALL_1_1StrangLBFGSMinimizer_1_1Default.html">Default</a> constructor. </p>

</div>
</div>
<a class="anchor" id="a6c0466ef893da85f9a829f9da1519ee1"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="a6c0466ef893da85f9a829f9da1519ee1" args="(ForceField &amp;force_field)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>force_field</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor expecting a valid force field </p>

</div>
</div>
<a class="anchor" id="aae03450aacde92765b8a8ca70a374d47"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="aae03450aacde92765b8a8ca70a374d47" args="(ForceField &amp;force_field, SnapShotManager *ssm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>force_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a> *&nbsp;</td>
          <td class="paramname"> <em>ssm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor expecting a valid force field and a snapshot manager </p>

</div>
</div>
<a class="anchor" id="a88a5d3649f3a73790287ef4524c4a3d3"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="a88a5d3649f3a73790287ef4524c4a3d3" args="(ForceField &amp;force_field, SnapShotManager *ssm, const Options &amp;options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>force_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a> *&nbsp;</td>
          <td class="paramname"> <em>ssm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBALL_1_1Options.html">Options</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor expecting a valid force field, a snapshot manager and options </p>

</div>
</div>
<a class="anchor" id="a2c5aa30a217cda9d942ddc95b3e98007"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="a2c5aa30a217cda9d942ddc95b3e98007" args="(ForceField &amp;force_field, const Options &amp;options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL_1_1ForceField.html">ForceField</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>force_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classBALL_1_1Options.html">Options</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor expecting a valid force field and options </p>

</div>
</div>
<a class="anchor" id="af3a9e512df9c67ce71a582e1405f4f55"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer" ref="af3a9e512df9c67ce71a582e1405f4f55" args="(const StrangLBFGSMinimizer &amp;rhs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::StrangLBFGSMinimizer::StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>rhs</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Copy constructor </p>

</div>
</div>
<a class="anchor" id="a4cd6986b78ea0d20a1024e31013c0a33"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::~StrangLBFGSMinimizer" ref="a4cd6986b78ea0d20a1024e31013c0a33" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual BALL::StrangLBFGSMinimizer::~StrangLBFGSMinimizer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a24ae7fae3579c13b90f3b8f0a7452ddc"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::findStep" ref="a24ae7fae3579c13b90f3b8f0a7452ddc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classdouble.html">double</a> BALL::StrangLBFGSMinimizer::findStep </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate the next step. First, this method updates the model. Second, it performs a line search along the calculated direction afterwards. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>double <img class="formulaInl" alt="$\geq 0$" src="form_50.png"/> if the line search found an acceptable solution, otherwise -1. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classBALL_1_1EnergyMinimizer.html#af01e38cba7fc52449aa9676cf9e01138">EnergyMinimizer::findStep</a> </dd></dl>

<p>Reimplemented from <a class="el" href="classBALL_1_1EnergyMinimizer.html#af01e38cba7fc52449aa9676cf9e01138">BALL::EnergyMinimizer</a>.</p>

</div>
</div>
<a class="anchor" id="a7b0ba3bf6208bfeae7c75d61093c619b"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::getImprovedFlag" ref="a7b0ba3bf6208bfeae7c75d61093c619b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> BALL::StrangLBFGSMinimizer::getImprovedFlag </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the improved flag </p>

</div>
</div>
<a class="anchor" id="a8df12442c46fcb241b1549960942259a"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::getMaxNumOfStoredVectPairs" ref="a8df12442c46fcb241b1549960942259a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> BALL::StrangLBFGSMinimizer::getMaxNumOfStoredVectPairs </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the maximum number of stored vector pairs </p>

</div>
</div>
<a class="anchor" id="a69af23e7f46f9ba26de0872dd7b1d0a4"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::minimize" ref="a69af23e7f46f9ba26de0872dd7b1d0a4" args="(Size iterations=0, bool resume=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classbool.html">bool</a> BALL::StrangLBFGSMinimizer::minimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td>
          <td class="paramname"> <em>iterations</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>resume</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Minimize the energy of the system. This method executes at most <code>iterations</code> minimization steps. If the number of iterations is not given, the number specified in the options is taken. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>iterations</em>&nbsp;</td><td>the maximum number of iterations </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resume</em>&nbsp;</td><td><b>true</b> to resume a previous run </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classBALL_1_1EnergyMinimizer.html#a34520480888d31ce00c80bafaf79435f">EnergyMinimizer::minimize</a> </dd></dl>

<p>Reimplemented from <a class="el" href="classBALL_1_1EnergyMinimizer.html#a34520480888d31ce00c80bafaf79435f">BALL::EnergyMinimizer</a>.</p>

</div>
</div>
<a class="anchor" id="a2230228b5edaf4fd2abe832b896d4337"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::operator=" ref="a2230228b5edaf4fd2abe832b896d4337" args="(const StrangLBFGSMinimizer &amp;rhs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a>&amp; BALL::StrangLBFGSMinimizer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html">StrangLBFGSMinimizer</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>rhs</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assignment operator </p>

</div>
</div>
<a class="anchor" id="a377c51906ceb0288aa85ad523bf0f5ed"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::setImprovedFlag" ref="a377c51906ceb0288aa85ad523bf0f5ed" args="(bool flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::StrangLBFGSMinimizer::setImprovedFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>flag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the improved flag </p>

</div>
</div>
<a class="anchor" id="a90ab583dbccbc375b30de91a099e605b"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::setMaxNumOfStoredVectPairs" ref="a90ab583dbccbc375b30de91a099e605b" args="(Size num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::StrangLBFGSMinimizer::setMaxNumOfStoredVectPairs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td>
          <td class="paramname"> <em>num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the maximum number of stored vector pairs </p>

</div>
</div>
<a class="anchor" id="a861d3d9a9536ef977c369d27c932ca16"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::specificSetup" ref="a861d3d9a9536ef977c369d27c932ca16" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classbool.html">bool</a> BALL::StrangLBFGSMinimizer::specificSetup </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Specific setup </p>

<p>Reimplemented from <a class="el" href="classBALL_1_1EnergyMinimizer.html#aa05d05386489ef9dc404a701afa6f83c">BALL::EnergyMinimizer</a>.</p>

</div>
</div>
<a class="anchor" id="a5c8fc2f49e18d5ae98f8a8dfe39c99d5"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::updateDirection" ref="a5c8fc2f49e18d5ae98f8a8dfe39c99d5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BALL::StrangLBFGSMinimizer::updateDirection </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update the stored vector pairs, either by adding a new pair or if there is no space left by replacing the oldest pair. Compute the search direction afterwards by using the Strang recurrence formula (optional: with an improvement idea of Al-Baali). </p>

<p>Reimplemented from <a class="el" href="classBALL_1_1EnergyMinimizer.html#aea65fead0141ec5396ead1fb9501fbff">BALL::EnergyMinimizer</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a8544b115b1201d6ecd25dcb1e0c38904"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::curr_num_of_vect_pairs_" ref="a8544b115b1201d6ecd25dcb1e0c38904" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a8544b115b1201d6ecd25dcb1e0c38904">BALL::StrangLBFGSMinimizer::curr_num_of_vect_pairs_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Current number of stored vector pairs. </p>

</div>
</div>
<a class="anchor" id="a4a44fa5b52ceda4992c4ecec285fd324"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::first_iter_" ref="a4a44fa5b52ceda4992c4ecec285fd324" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a4a44fa5b52ceda4992c4ecec285fd324">BALL::StrangLBFGSMinimizer::first_iter_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is this an initial first iteration? </p>

</div>
</div>
<a class="anchor" id="a888c406a0381617eae64c91036fa155d"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::improved_" ref="a888c406a0381617eae64c91036fa155d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a888c406a0381617eae64c91036fa155d">BALL::StrangLBFGSMinimizer::improved_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Should the improved version be used? </p>

</div>
</div>
<a class="anchor" id="ad254a6f88b4f9ac040fd44f117f62561"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::index_of_free_vect_" ref="ad254a6f88b4f9ac040fd44f117f62561" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ad254a6f88b4f9ac040fd44f117f62561">BALL::StrangLBFGSMinimizer::index_of_free_vect_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Index of the vector pair which will be used for saving the data of the current step (usually by replacing old data). </p>

</div>
</div>
<a class="anchor" id="a683fe6a85fa864e6d9ddd2f8296dd986"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::initial_atoms_" ref="a683fe6a85fa864e6d9ddd2f8296dd986" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classBALL_1_1TVector3.html">Vector3</a>&gt; <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a683fe6a85fa864e6d9ddd2f8296dd986">BALL::StrangLBFGSMinimizer::initial_atoms_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Positions of movable atoms when starting an iteration. This is used to reduce slightly rounding errors </p>

</div>
</div>
<a class="anchor" id="ab54bc016fdc878fd1c5e8f93b47c4043"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::line_search_" ref="ab54bc016fdc878fd1c5e8f93b47c4043" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL_1_1LineSearch.html">LineSearch</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ab54bc016fdc878fd1c5e8f93b47c4043">BALL::StrangLBFGSMinimizer::line_search_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The line search </p>

</div>
</div>
<a class="anchor" id="a3b07b12c8f57c354c0802fd3efada72e"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::max_num_of_vect_pairs_" ref="a3b07b12c8f57c354c0802fd3efada72e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a3b07b12c8f57c354c0802fd3efada72e">BALL::StrangLBFGSMinimizer::max_num_of_vect_pairs_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Maximum number of stored vector pairs. </p>

</div>
</div>
<a class="anchor" id="ac35e9843ffa836ec34f006653e66f903"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::number_of_atoms_" ref="ac35e9843ffa836ec34f006653e66f903" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ac35e9843ffa836ec34f006653e66f903">BALL::StrangLBFGSMinimizer::number_of_atoms_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of movable atoms. </p>

</div>
</div>
<a class="anchor" id="ac3fe2e040f801ee5bcc2b0e19b5870b4"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::rho_" ref="ac3fe2e040f801ee5bcc2b0e19b5870b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="classfloat.html">float</a>&gt; <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#ac3fe2e040f801ee5bcc2b0e19b5870b4">BALL::StrangLBFGSMinimizer::rho_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Old and new scaling values. Also used in the Strang recurrence formula. </p>

</div>
</div>
<a class="anchor" id="a71d385216b75d6ccd540c480a1fa10f3"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::stored_s_" ref="a71d385216b75d6ccd540c480a1fa10f3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="classBALL_1_1TVector3.html">Vector3</a>&gt; <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a71d385216b75d6ccd540c480a1fa10f3">BALL::StrangLBFGSMinimizer::stored_s_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stored former steps. Vectors stored in column order. </p>

</div>
</div>
<a class="anchor" id="a1901bd82b113b39454cfa50639602ec3"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::stored_y_" ref="a1901bd82b113b39454cfa50639602ec3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="classBALL_1_1TVector3.html">Vector3</a>&gt; <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a1901bd82b113b39454cfa50639602ec3">BALL::StrangLBFGSMinimizer::stored_y_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stored former changes in gradients. Vectors stored in column order. </p>

</div>
</div>
<a class="anchor" id="a32c45b7c564763727a67868b7e780f5c"></a><!-- doxytag: member="BALL::StrangLBFGSMinimizer::work_val_" ref="a32c45b7c564763727a67868b7e780f5c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="classfloat.html">float</a>&gt; <a class="el" href="classBALL_1_1StrangLBFGSMinimizer.html#a32c45b7c564763727a67868b7e780f5c">BALL::StrangLBFGSMinimizer::work_val_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Temporarily used memory for saving scalars associated with the stored vector pairs. </p>

</div>
</div>
</div>
</div>
</body>
</html>
