<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
<h1>fragmentDB.h</h1><a href="fragmentDB_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++; tab-width: 2; -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vi: set ts=2:</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// $Id: fragmentDB.h,v 1.35.18.1 2007/03/25 21:25:25 oliver Exp $</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef BALL_STRUCTURE_FRAGMENTDB_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define BALL_STRUCTURE_FRAGMENTDB_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef BALL_DATATYPE_STRINGHASHMAP_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="stringHashMap_8h.html">BALL/DATATYPE/stringHashMap.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef BALL_KERNEL_RESIDUE_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="residue_8h.html">BALL/KERNEL/residue.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#endif</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef BALL_KERNEL_MOLECULE_H</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="molecule_8h.html">BALL/KERNEL/molecule.h</a>&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#endif</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef BALL_KERNEL_BOND_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="bond_8h.html">BALL/KERNEL/bond.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#endif</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#ifndef BALL_STRUCTURE_RECONSTRUCTFRAGMENTPROCESSOR_H</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="reconstructFragmentProcessor_8h.html">BALL/STRUCTURE/reconstructFragmentProcessor.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#endif</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="keyword">namespace </span>BALL 
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   <span class="keyword">class </span>ResourceEntry;
<a name="l00037"></a>00037 
<a name="l00046"></a><a class="code" href="classBALL_1_1FragmentDB.html">00046</a>   <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a> 
<a name="l00047"></a>00047   {
<a name="l00048"></a>00048     <span class="keyword">public</span>:
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classBALL_1_1FragmentDB.html#af66f8b6c04dda4c2034cc857a7d25c84">00050</a>     <span class="keyword">class </span>AddHydrogensProcessor;
<a name="l00051"></a>00051     <span class="keyword">friend</span> <span class="keyword">class </span>FragmentDB::AddHydrogensProcessor;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053     <a class="code" href="group__Common.html#ga7531fd77ac8e175306413c4539a10c01">BALL_CREATE_DEEP</a>(<a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>)
<a name="l00054"></a>00054   
<a name="l00055"></a>00055     
<a name="l00058"></a>00058 
<a name="l00061"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897f">00061</a>     enum <a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897f">FragmentTypes</a> 
<a name="l00062"></a>00062     {
<a name="l00063"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897fa6569fa61b521e05fbc22dfc3dd8fb01f">00063</a>       TYPE__UNKNOWN = -1,
<a name="l00064"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897faec37d9416a5e9ca300f18c0fe05aaa60">00064</a>       TYPE__FRAGMENT,
<a name="l00065"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897faab18e01089f3aa6b7928e33fe7c96768">00065</a>       TYPE__RESIDUE,
<a name="l00066"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa624431cc69f63a009af609697c9897fa042d9585f3e834c20e4759cb07e2338f">00066</a>       TYPE__MOLECULE
<a name="l00067"></a>00067     };
<a name="l00069"></a>00069 
<a name="l00073"></a>00073 
<a name="l00076"></a><a class="code" href="classBALL_1_1FragmentDB.html#a933acaeded7aa89d57d010661d881c95">00076</a>     <span class="keyword">typedef</span> <span class="keywordtype">short</span> <a class="code" href="classBALL_1_1FragmentDB.html#a933acaeded7aa89d57d010661d881c95">Type</a>;
<a name="l00078"></a><a class="code" href="classBALL_1_1FragmentDB.html#a4d93938fd1377c04738dccea91c2e785">00078</a>     <span class="keyword">typedef</span> <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;String&gt;</a> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>;
<a name="l00079"></a>00079 
<a name="l00081"></a>00081 
<a name="l00084"></a>00084     
<a name="l00089"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html">00089</a>     <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html">NoFragmentNode</a>
<a name="l00090"></a>00090       : <span class="keyword">public</span> Exception::GeneralException
<a name="l00091"></a>00091     {
<a name="l00092"></a>00092       <span class="keyword">public</span>:
<a name="l00093"></a>00093       <a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html">NoFragmentNode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; filename) ;
<a name="l00094"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html#a8eb44ed1f1f5c5271287050dd60adabe">00094</a>       <a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html#a8eb44ed1f1f5c5271287050dd60adabe">~NoFragmentNode</a>() throw() {}
<a name="l00095"></a>00095 
<a name="l00096"></a>00096       <span class="keyword">protected</span>:
<a name="l00097"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html#a26cdb7088e4d2d0c937613e2584afa9d">00097</a>       <span class="keywordtype">string</span> filename_;
<a name="l00098"></a>00098     };
<a name="l00099"></a>00099 
<a name="l00101"></a>00101 
<a name="l00104"></a>00104   
<a name="l00107"></a>00107     <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>();
<a name="l00108"></a>00108 
<a name="l00113"></a>00113     <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; filename)
<a name="l00114"></a>00114       <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1FileNotFound.html">Exception::FileNotFound</a>);
<a name="l00115"></a>00115 
<a name="l00118"></a>00118     <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; db, <span class="keywordtype">bool</span> deep = <span class="keyword">true</span>); 
<a name="l00119"></a>00119 
<a name="l00121"></a>00121     <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; operator = (<span class="keyword">const</span> <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; db)
<a name="l00122"></a>00122       ;
<a name="l00123"></a>00123 
<a name="l00126"></a>00126     <span class="keyword">virtual</span> ~<a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>();
<a name="l00127"></a>00127 
<a name="l00130"></a>00130     <span class="keywordtype">void</span> destroy();
<a name="l00131"></a>00131 
<a name="l00133"></a>00133 
<a name="l00136"></a>00136 
<a name="l00139"></a>00139     <span class="keywordtype">void</span> init()
<a name="l00140"></a>00140       throw(Exception::FileNotFound, <a class="code" href="classBALL_1_1FragmentDB_1_1NoFragmentNode.html">NoFragmentNode</a>);
<a name="l00141"></a>00141     
<a name="l00143"></a>00143 
<a name="l00146"></a>00146 
<a name="l00149"></a>00149     <span class="keywordtype">void</span> setFilename(const <a class="code" href="classBALL_1_1String.html">String</a>&amp; filename)
<a name="l00150"></a>00150       throw(Exception::FileNotFound);
<a name="l00151"></a>00151     
<a name="l00154"></a>00154     const <a class="code" href="classBALL_1_1String.html">String</a>&amp; getFilename() const;
<a name="l00155"></a>00155     
<a name="l00158"></a>00158     <span class="keywordtype">bool</span> has(const <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) const;
<a name="l00159"></a>00159 
<a name="l00161"></a><a class="code" href="classBALL_1_1FragmentDB.html#a97a546a04b79b3241998bf2885544951">00161</a>     const std::vector&lt;<a class="code" href="classBALL_1_1Residue.html">Residue</a>*&gt;&amp;  getFragments() { <span class="keywordflow">return</span> fragments_;}
<a name="l00162"></a>00162     
<a name="l00165"></a>00165     <a class="code" href="classBALL_1_1FragmentDB.html#a933acaeded7aa89d57d010661d881c95">FragmentDB::Type</a> getFragmentType(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00166"></a>00166 
<a name="l00169"></a>00169     list&lt;String&gt; getVariantNames(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; name) <span class="keyword">const</span>;
<a name="l00170"></a>00170     
<a name="l00173"></a>00173     <span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* getFragment(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00174"></a>00174 
<a name="l00181"></a>00181     <span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* getReferenceFragment(<span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment) <span class="keyword">const</span>;
<a name="l00182"></a>00182 
<a name="l00185"></a>00185     <span class="keyword">const</span> <a class="code" href="classBALL_1_1Residue.html">Residue</a>* getResidue(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00186"></a>00186 
<a name="l00195"></a>00195     <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* getFragmentCopy(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00196"></a>00196 
<a name="l00205"></a>00205     <a class="code" href="classBALL_1_1Molecule.html">Molecule</a>* getMoleculeCopy(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00206"></a>00206 
<a name="l00215"></a>00215     <a class="code" href="classBALL_1_1Residue.html">Residue</a>* getResidueCopy(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; fragment_name) <span class="keyword">const</span>;
<a name="l00216"></a>00216 
<a name="l00219"></a>00219     <span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; getDefaultNamingStandard() <span class="keyword">const</span>;
<a name="l00220"></a>00220 
<a name="l00223"></a>00223     <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;NameMap&gt;</a>&amp; getNamingStandards();
<a name="l00224"></a>00224 
<a name="l00231"></a>00231     <span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;String&gt;</a>&amp; getNamingStandard(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; std) <span class="keyword">const</span>
<a name="l00232"></a>00232       <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;String&gt;::IllegalKey</a>);
<a name="l00233"></a>00233 
<a name="l00237"></a>00237     std::vector&lt;String&gt; getAvailableNamingStandards() <span class="keyword">const</span>;
<a name="l00238"></a>00238 
<a name="l00240"></a>00240 
<a name="l00244"></a>00244 
<a name="l00247"></a>00247     <span class="keywordtype">bool</span> isValid() <span class="keyword">const</span>;
<a name="l00248"></a>00248 
<a name="l00250"></a>00250 
<a name="l00253"></a>00253 
<a name="l00258"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">00258</a>     <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">NormalizeNamesProcessor</a> 
<a name="l00259"></a>00259       : <span class="keyword">public</span> <a class="code" href="classBALL_1_1UnaryProcessor.html">UnaryProcessor</a>&lt;Fragment&gt;
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261     
<a name="l00262"></a>00262       <span class="keyword">public</span>:
<a name="l00263"></a>00263 
<a name="l00267"></a>00267 
<a name="l00270"></a>00270       <a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">NormalizeNamesProcessor</a>();
<a name="l00271"></a>00271     
<a name="l00272"></a>00272     
<a name="l00275"></a>00275       <a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">NormalizeNamesProcessor</a>(<a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; db);
<a name="l00276"></a>00276 
<a name="l00279"></a>00279       <span class="keyword">virtual</span> ~<a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">NormalizeNamesProcessor</a>();
<a name="l00280"></a>00280     
<a name="l00282"></a>00282 
<a name="l00285"></a>00285       
<a name="l00288"></a>00288       <span class="keywordtype">void</span> setFragmentDB(<a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; db);
<a name="l00289"></a>00289 
<a name="l00292"></a>00292       <span class="keywordtype">void</span> setNamingStandard(<span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; naming_standard);
<a name="l00293"></a>00293     
<a name="l00296"></a>00296       <span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; getNamingStandard();
<a name="l00297"></a>00297 
<a name="l00300"></a>00300       <span class="keywordtype">bool</span> matchName(<a class="code" href="classBALL_1_1String.html">String</a>&amp; res_name, <a class="code" href="classBALL_1_1String.html">String</a>&amp; atom_name, <span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>&amp; map) <span class="keyword">const</span>;
<a name="l00301"></a>00301    
<a name="l00303"></a>00303 
<a name="l00306"></a>00306       
<a name="l00309"></a>00309       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> start();
<a name="l00310"></a>00310 
<a name="l00313"></a>00313       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> finish();
<a name="l00314"></a>00314     
<a name="l00317"></a>00317       <span class="keyword">virtual</span> <a class="code" href="classBALL_1_1Processor.html#afc8b424f41762b055b9b22f7e9c22e8a">Processor::Result</a> operator () (<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00318"></a>00318 
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       <span class="keyword">private</span>:
<a name="l00322"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html#aa7bf0a47454fda9ad87e72794d614b47af408ceabf13c62be024cc19a28771201">00322</a>         <span class="keyword">enum</span> <a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html#aa7bf0a47454fda9ad87e72794d614b47">CountingMode</a> { ADD, OVERWRITE };
<a name="l00323"></a>00323         <a class="code" href="classBALL_1_1String.html">String</a> getSuffix_(<span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* frag) <span class="keyword">const</span>;
<a name="l00324"></a>00324         <span class="keywordtype">bool</span> doMatch_(<a class="code" href="classBALL_1_1String.html">String</a>&amp; res_name, <span class="keyword">const</span> <a class="code" href="classBALL_1_1String.html">String</a>&amp; res_name_suffix, <a class="code" href="classBALL_1_1String.html">String</a>&amp; atom_name, <span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>&amp; map) <span class="keyword">const</span>;
<a name="l00325"></a>00325         <span class="keywordtype">void</span> countHits_(<a class="code" href="classBALL_1_1HashMap.html" title="HashMap class based on the STL map (containing serveral convenience functions).">HashMap&lt;NameMap*, Index&gt;</a>&amp; maps, <span class="keyword">const</span> std::list&lt;Fragment*&gt;&amp; frags);
<a name="l00326"></a>00326         <span class="keywordtype">void</span> countHits_(<a class="code" href="classBALL_1_1HashMap.html" title="HashMap class based on the STL map (containing serveral convenience functions).">HashMap&lt;NameMap*, Index&gt;</a>&amp; maps, <span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* frag, CountingMode mode = OVERWRITE);
<a name="l00327"></a>00327         <span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>* getBestMap_(<span class="keyword">const</span> <a class="code" href="classBALL_1_1HashMap.html" title="HashMap class based on the STL map (containing serveral convenience functions).">HashMap&lt;NameMap*, Index&gt;</a>&amp; maps) <span class="keyword">const</span>;
<a name="l00328"></a>00328         <span class="keywordtype">void</span> normalizeFragments_(<span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>* map, <span class="keyword">const</span> std::list&lt;Fragment*&gt;&amp; frags);
<a name="l00329"></a>00329         <span class="keywordtype">void</span> normalizeFragment_ (<span class="keyword">const</span> <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>* map, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>* frag);
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html#aca30125e7408eed7d70af670f377c73e">00331</a>       <a class="code" href="classBALL_1_1String.html">String</a>                naming_standard_;
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html#af3ebaabd10b2ae7d4a0e80ab1203745a">00333</a>       <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>*           fragment_db_;
<a name="l00334"></a>00334     
<a name="l00335"></a><a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html#acb7b3ecf7c7465f06211054cdef45f0a">00335</a>       std::list&lt;Fragment*&gt;  fragments_;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     };
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 
<a name="l00342"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">00342</a>     <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">BuildBondsProcessor</a> 
<a name="l00343"></a>00343       : <span class="keyword">public</span> <a class="code" href="classBALL_1_1UnaryProcessor.html">UnaryProcessor</a>&lt;Fragment&gt; 
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345 
<a name="l00346"></a>00346       <span class="keyword">public</span>:
<a name="l00347"></a>00347 
<a name="l00351"></a>00351 
<a name="l00352"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html">00352</a>       <span class="keyword">struct </span><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html">Connection</a>
<a name="l00353"></a>00353       {
<a name="l00354"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#a5e72f839c7b68ed0aa6d0a16a87df63a">00354</a>         <a class="code" href="classBALL_1_1Atom.html">Atom</a>*       atom;
<a name="l00355"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#a63ded642d89f53617c29fc5f0b4789ab">00355</a>         <a class="code" href="classBALL_1_1String.html">String</a>      type_name;
<a name="l00356"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#af7ccb879c527dc02ea5046fe18e8e97c">00356</a>         <a class="code" href="classBALL_1_1String.html">String</a>      connect_to;
<a name="l00357"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#a3cdec200d1bbcff4e9c506ba988b48c3">00357</a>         <a class="code" href="classBALL_1_1Bond.html#afbb461e17d3e1fe517234394025e4405">Bond::Order</a> order;
<a name="l00358"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#ac650bc9923e1c808277c4ef54903c1bf">00358</a>         <span class="keywordtype">float</span>       dist;
<a name="l00359"></a><a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html#a45fe74997b3950aec3e9add2c9857008">00359</a>         <span class="keywordtype">float</span>       delta;
<a name="l00360"></a>00360       };
<a name="l00361"></a>00361 
<a name="l00363"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#acc05320dafeb46bca830a7daa17ebd0e">00363</a>       <span class="keyword">typedef</span> std::list&lt;Connection&gt; <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#acc05320dafeb46bca830a7daa17ebd0e">ConnectionList</a>;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 
<a name="l00370"></a>00370     
<a name="l00372"></a>00372       <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">BuildBondsProcessor</a>();
<a name="l00373"></a>00373       
<a name="l00375"></a>00375       <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">BuildBondsProcessor</a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; db);
<a name="l00376"></a>00376 
<a name="l00378"></a>00378       <span class="keyword">virtual</span> ~<a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">BuildBondsProcessor</a>();
<a name="l00380"></a>00380 
<a name="l00384"></a>00384 
<a name="l00386"></a>00386       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> finish();
<a name="l00387"></a>00387 
<a name="l00389"></a>00389       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> start();
<a name="l00390"></a>00390 
<a name="l00392"></a>00392       <span class="keyword">virtual</span> <a class="code" href="classBALL_1_1Processor.html#afc8b424f41762b055b9b22f7e9c22e8a">Processor::Result</a> operator () (<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00394"></a>00394 
<a name="l00398"></a>00398       
<a name="l00400"></a>00400       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> getNumberOfBondsBuilt();
<a name="l00401"></a>00401 
<a name="l00403"></a>00403       <span class="keywordtype">void</span> setFragmentDB(<span class="keyword">const</span> <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>&amp; fragment_db);
<a name="l00404"></a>00404 
<a name="l00406"></a>00406 
<a name="l00410"></a>00410 
<a name="l00416"></a>00416       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> buildFragmentBonds(<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment) <span class="keyword">const</span>;
<a name="l00417"></a>00417 
<a name="l00424"></a>00424       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> buildFragmentBonds(<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment, <span class="keyword">const</span> <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; tplate) <span class="keyword">const</span>
<a name="l00425"></a>00425         <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1TooManyBonds.html" title="Exception to be thrown if too many bonds for one atom.">Exception::TooManyBonds</a>);
<a name="l00426"></a>00426 
<a name="l00432"></a>00432       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> buildInterFragmentBonds(<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; first, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; second) <span class="keyword">const</span>
<a name="l00433"></a>00433         <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1TooManyBonds.html" title="Exception to be thrown if too many bonds for one atom.">Exception::TooManyBonds</a>);
<a name="l00434"></a>00434 
<a name="l00436"></a>00436 
<a name="l00437"></a>00437       <span class="keyword">protected</span>:
<a name="l00438"></a>00438 
<a name="l00444"></a>00444       <span class="keywordtype">void</span> storeConnections_(<a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00445"></a>00445 
<a name="l00448"></a>00448       <span class="keywordtype">bool</span> buildConnection_(<a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html">Connection</a>&amp; con1, <a class="code" href="structBALL_1_1FragmentDB_1_1BuildBondsProcessor_1_1Connection.html">Connection</a>&amp; con2)
<a name="l00449"></a>00449         <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1TooManyBonds.html" title="Exception to be thrown if too many bonds for one atom.">Exception::TooManyBonds</a>);
<a name="l00450"></a>00450     
<a name="l00453"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#a042081436a33e95b39e059ace53f5814">00453</a>       <a class="code" href="classBALL_1_1FragmentDB.html">FragmentDB</a>*     fragment_db_;
<a name="l00454"></a>00454       
<a name="l00459"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#a5922c2bf174296c97fa178bd988d61d8">00459</a>       std::list&lt;Fragment*&gt;  fragment_list_;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461       <span class="comment">/*_ The number of bonds built.</span>
<a name="l00462"></a>00462 <span class="comment">          This value is reset in the start method, so each application of </span>
<a name="l00463"></a>00463 <span class="comment">          the processor, so &lt;TT&gt;  getNumberOfBuiltBonds &lt;/TT&gt; always returns</span>
<a name="l00464"></a>00464 <span class="comment">          the number of bonds built in the last application.</span>
<a name="l00465"></a>00465 <span class="comment">      */</span>
<a name="l00466"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#acccab1b1c4f678b334b560f173b99d35">00466</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>  bonds_built_;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468       <span class="comment">/*_ The list of connects between(!) fragments still to be examined</span>
<a name="l00469"></a>00469 <span class="comment">      */</span>
<a name="l00470"></a><a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#a442b6a65ed1c601a4f7c242e731c6ad1">00470</a>       <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html#acc05320dafeb46bca830a7daa17ebd0e">ConnectionList</a>  connections_;
<a name="l00471"></a>00471     };
<a name="l00472"></a>00472 
<a name="l00474"></a>00474 
<a name="l00477"></a>00477 
<a name="l00480"></a><a class="code" href="classBALL_1_1FragmentDB.html#acb8be79516d667098e12c49d680dd031">00480</a>     <a class="code" href="classBALL_1_1FragmentDB_1_1NormalizeNamesProcessor.html">NormalizeNamesProcessor</a>   normalize_names;
<a name="l00481"></a>00481 
<a name="l00484"></a><a class="code" href="classBALL_1_1FragmentDB.html#a80a51b01464e7e40d3401fd73de22fdb">00484</a>     <a class="code" href="classBALL_1_1ReconstructFragmentProcessor.html">ReconstructFragmentProcessor</a>  add_hydrogens;
<a name="l00485"></a>00485 
<a name="l00488"></a><a class="code" href="classBALL_1_1FragmentDB.html#a081b7be0e263f31269274e43362a8922">00488</a>     <a class="code" href="classBALL_1_1FragmentDB_1_1BuildBondsProcessor.html">BuildBondsProcessor</a>       build_bonds;
<a name="l00489"></a>00489 
<a name="l00492"></a><a class="code" href="classBALL_1_1FragmentDB.html#a4bac2916e937cc9348764abed5cd5987">00492</a>     <a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>*  tree;
<a name="l00493"></a>00493 
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <span class="keyword">private</span>:
<a name="l00497"></a>00497       
<a name="l00498"></a>00498     <span class="comment">/*_ @name Parse functions</span>
<a name="l00499"></a>00499 <span class="comment">        These functions parse different sections of the fragment DB resource</span>
<a name="l00500"></a>00500 <span class="comment">        tree and translate everything into the correct data structures.</span>
<a name="l00501"></a>00501 <span class="comment">    */</span>
<a name="l00502"></a>00502     <span class="comment">//_@{</span>
<a name="l00503"></a>00503 
<a name="l00504"></a>00504     <span class="comment">/*_ Parses the Atoms entry and creates the atoms of the fragment</span>
<a name="l00505"></a>00505 <span class="comment">    */</span>
<a name="l00506"></a>00506     <span class="keywordtype">void</span> parseAtoms_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; entry, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     <span class="comment">/*_ Parses the Bonds entry and creates the bonds of the fragment</span>
<a name="l00509"></a>00509 <span class="comment">    */</span>
<a name="l00510"></a>00510     <span class="keywordtype">void</span> parseBonds_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; entry, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     <span class="comment">/*_ Parses the properties of a fragment/variant and sets the corresponding properties.</span>
<a name="l00513"></a>00513 <span class="comment">        Properties are set or reset (if the property name starts with &quot;!&quot;) for the current </span>
<a name="l00514"></a>00514 <span class="comment">        fragment. All properties of fragment and residue are recognized, if they</span>
<a name="l00515"></a>00515 <span class="comment">        are written exactly as in the header file (case insensitive) and set.</span>
<a name="l00516"></a>00516 <span class="comment">        Unknown properties are set as name/value pairs as bool properties and set to </span>
<a name="l00517"></a>00517 <span class="comment">        &lt;b&gt;  true &lt;/b&gt;.</span>
<a name="l00518"></a>00518 <span class="comment">    */</span>
<a name="l00519"></a>00519     <span class="keywordtype">void</span> parseProperties_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; entry, <a class="code" href="classBALL_1_1PropertyManager.html">PropertyManager</a>&amp; property_man);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521     <span class="comment">/*_ Parses the Delete section.</span>
<a name="l00522"></a>00522 <span class="comment">        All atoms given in this section are removed from the fragment.</span>
<a name="l00523"></a>00523 <span class="comment">    */</span>
<a name="l00524"></a>00524     <span class="keywordtype">void</span> parseDelete_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; entry, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="comment">/*_ Parses the Rename section.</span>
<a name="l00527"></a>00527 <span class="comment">        All atoms given in this section are renamed to the given new name.</span>
<a name="l00528"></a>00528 <span class="comment">    */</span>
<a name="l00529"></a>00529     <span class="keywordtype">void</span> parseRename_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; entry, <a class="code" href="classBALL_1_1Fragment.html">Fragment</a>&amp; fragment);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     <span class="comment">//_@}</span>
<a name="l00532"></a>00532 
<a name="l00534"></a>00534     <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> addNewFragment_(<a class="code" href="classBALL_1_1Residue.html">Residue</a>* fragment);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     <span class="comment">/*_ Expands all include directives in the resource file.</span>
<a name="l00537"></a>00537 <span class="comment">        This method calls expandFirst_ until it returns true. </span>
<a name="l00538"></a>00538 <span class="comment">    */</span>
<a name="l00539"></a>00539     <span class="keywordtype">void</span> expandTree_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; root_entry);
<a name="l00540"></a>00540    
<a name="l00541"></a>00541     <span class="comment">/*_ Expands the first occuring include directive.</span>
<a name="l00542"></a>00542 <span class="comment">        If no include directive is found, &lt;b&gt;  false &lt;/b&gt; is returned, otherwise &lt;b&gt;  true &lt;/b&gt;.</span>
<a name="l00543"></a>00543 <span class="comment">    */</span>
<a name="l00544"></a>00544     <span class="keywordtype">bool</span> expandFirst_(<a class="code" href="classBALL_1_1ResourceEntry.html">ResourceEntry</a>&amp; root_entry)
<a name="l00545"></a>00545       <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1FileNotFound.html">Exception::FileNotFound</a>);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="comment">// The status of the FragmentDB</span>
<a name="l00548"></a><a class="code" href="classBALL_1_1FragmentDB.html#ac1240a0f453bd4979631a801c59074da">00548</a>     <span class="keywordtype">bool</span>            valid_;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     <span class="comment">// The filename of the master fragment file.</span>
<a name="l00551"></a><a class="code" href="classBALL_1_1FragmentDB.html#abde906e3d9806a3c72847868732122e0">00551</a>     <a class="code" href="classBALL_1_1String.html">String</a>          filename_;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <span class="comment">// The naming standard we default to.</span>
<a name="l00554"></a><a class="code" href="classBALL_1_1FragmentDB.html#a42b7b1ab21a95b793b7c23c7d7dd576d">00554</a>     <a class="code" href="classBALL_1_1String.html">String</a>          default_standard_;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <span class="comment">// An array containing all allocated residues.</span>
<a name="l00557"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa5a322740f335a1a07f656de8e5102b7">00557</a>     std::vector&lt;Residue*&gt;           fragments_;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     <span class="comment">// Maps a fragment name back to a path in the database</span>
<a name="l00560"></a><a class="code" href="classBALL_1_1FragmentDB.html#a936e28b16a038b6255f8b93bddffe3c2">00560</a>     <a class="code" href="classBALL_1_1StringHashMap.html">NameMap</a>                         name_to_path_;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">// Maps a fragment name back to the array index in fragments_</span>
<a name="l00563"></a><a class="code" href="classBALL_1_1FragmentDB.html#ab8c09eb2d82f580fe344150741a8bd4c">00563</a>     <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;Position&gt;</a>         name_to_frag_index_;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="comment">// Maps all variants of a specific fragment back to array indices.</span>
<a name="l00566"></a><a class="code" href="classBALL_1_1FragmentDB.html#aa71c781fdf920cf01dc3aeb785a8fe14">00566</a>     <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;list&lt;Position&gt;</a> &gt;  name_to_variants_;
<a name="l00567"></a>00567 
<a name="l00568"></a>00568     <span class="comment">// Contains the naming standards as a nested map.</span>
<a name="l00569"></a><a class="code" href="classBALL_1_1FragmentDB.html#a819c7ff392ba7d3368f1b6899da6975b">00569</a>     <a class="code" href="classBALL_1_1StringHashMap.html">StringHashMap&lt;NameMap&gt;</a>          standards_;
<a name="l00570"></a>00570   };
<a name="l00571"></a>00571   
<a name="l00572"></a>00572 } <span class="comment">// namespace BALL </span>
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 
<a name="l00575"></a>00575 <span class="preprocessor">#endif // BALL_STRUCTURE_FRAGMENTDB_H</span>
</pre></div></div>
</div>
</body>
</html>
