<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>BALL: BALL::LineSearch Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../d0/d09/namespaceBALL.html">BALL</a>::<a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a>
  </div>
</div>
<div class="contents">
<h1>BALL::LineSearch Class Reference<br/>
<small>
[<a class="el" href="../../d9/d62/group__MolmecEnergyMinimizer.html">Energy Minimizer</a>]</small>
</h1><!-- doxytag: class="BALL::LineSearch" -->
<p><code>#include &lt;<a class="el" href="../../da/d01/lineSearch_8h_source.html">BALL/MOLMEC/MINIMIZATION/lineSearch.h</a>&gt;</code></p>

<p><a href="../../d3/d8c/classBALL_1_1LineSearch-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br/><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors and Destructors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#abd8b7ba195a7748fcba15ddc228278cc">LineSearch</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a5995eda08ca90cd9e5ac8081c10126da">LineSearch</a> (<a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a> &amp;minimizer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#ab59f438cdbd3e5752abc1216da1acb26">LineSearch</a> (const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a> &amp;line_search)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a4171318127ce22fe0e48545817c923af">~LineSearch</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader">Assignments</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a17d138fbc785b46563fd7639f89adeae">operator=</a> (const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a> &amp;<a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a>)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Accessors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a9c2de0a0c0c08d206d38bbdbd97ebd7b">setAlpha</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> alpha)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#aedef2724b5655cccfa7c81c1318c7af9">setBeta</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a8122bed8c00c57004d76cf9828d0131d">getAlpha</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#ab0bb65a27b72d7ef552cbfc7f86a5465">getBeta</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a9924a72d419c4b35310c8ca81f2e4d8a">getMaxSteps</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#ad7a41c56e038fda8ceab793236579a9c">setMaxSteps</a> (<a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a> steps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#abd4ed6839ca50b6af007a8c46f1217a4">setLowerBound</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> lbound)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a042c3c1d3bac9ac6b167c99e9e8bc324">getLowerBound</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#aa7899dffe5709feabb678158e7d2f39a">setXTol</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> xtol)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a3c81f37becd13c045f13bd65197dc04d">getXTol</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a536d0ae9e8d62360041fca0f1b2cb806">setBracketedFlag</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> bracktd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a71b44da638f178d9cf22cdce0cb74267">isBracketed</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a19631a12c0fff0542b547b20463fff6a">setMinimizer</a> (<a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a> &amp;minimizer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a3bdaa274550fbe5592c242bee132e95a">takeStep</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;st_a, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;f_a, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;g_a, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;st_b, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;f_b, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;g_b, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;stp, <a class="el" href="../../df/de6/classdouble.html">double</a> f, <a class="el" href="../../df/de6/classdouble.html">double</a> g, <a class="el" href="../../df/de6/classdouble.html">double</a> minstp, <a class="el" href="../../df/de6/classdouble.html">double</a> maxstp)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Minimization</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/db9/classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a2fc41a6584e342cfe4550a0efccd5cf4">minimize</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;stp, <a class="el" href="../../d9/db9/classbool.html">bool</a> keep_gradient=false)</td></tr>
<tr><td colspan="2"><br/><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a7d85e7b2c96195e239a896dd9b853a72">alpha_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a281134ccb999e20139696f16f28e6c09">beta_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#aefcb4db30a62361fca3a6c4c913eae97">max_steps_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a7f0858c36794f1f0622d1fdb09037f0f">lower_energy_bound_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a60d9acc97eda24aeff794ef737d58747">stptol_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#ae94728489979ab207dc5265314d49259">is_bracketed_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a3f271ba47cc613795472d276e7c49e76">minimizer_</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Basic line search class. This method minimizes the energy of a system along a given direction using a two stage algorithm. It is based on cubic and quadratic interpolation methods of Jorge J. More and David J. Thuente. See</p>
<p>[1] J. More and D. Thuente, "Line search algorithms with guaranteed sufficient decrease," ACM Transactions on Mathematical Software 20 (1994), no. 3, pp. 286-307. </p>

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00032">32</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="abd8b7ba195a7748fcba15ddc228278cc"></a><!-- doxytag: member="BALL::LineSearch::LineSearch" ref="abd8b7ba195a7748fcba15ddc228278cc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::LineSearch::LineSearch </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Default constructor. </p>

</div>
</div>
<a class="anchor" id="a5995eda08ca90cd9e5ac8081c10126da"></a><!-- doxytag: member="BALL::LineSearch::LineSearch" ref="a5995eda08ca90cd9e5ac8081c10126da" args="(EnergyMinimizer &amp;minimizer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::LineSearch::LineSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>minimizer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Detailed constructor. </p>

</div>
</div>
<a class="anchor" id="ab59f438cdbd3e5752abc1216da1acb26"></a><!-- doxytag: member="BALL::LineSearch::LineSearch" ref="ab59f438cdbd3e5752abc1216da1acb26" args="(const LineSearch &amp;line_search)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::LineSearch::LineSearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>line_search</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Copy constructor </p>

</div>
</div>
<a class="anchor" id="a4171318127ce22fe0e48545817c923af"></a><!-- doxytag: member="BALL::LineSearch::~LineSearch" ref="a4171318127ce22fe0e48545817c923af" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual BALL::LineSearch::~LineSearch </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8122bed8c00c57004d76cf9828d0131d"></a><!-- doxytag: member="BALL::LineSearch::getAlpha" ref="a8122bed8c00c57004d76cf9828d0131d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> BALL::LineSearch::getAlpha </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the parameter alpha (convergence criterion for the line search). </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a2fc41a6584e342cfe4550a0efccd5cf4">minimize</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ab0bb65a27b72d7ef552cbfc7f86a5465"></a><!-- doxytag: member="BALL::LineSearch::getBeta" ref="ab0bb65a27b72d7ef552cbfc7f86a5465" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> BALL::LineSearch::getBeta </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the parameter beta (convergence criterion for the line search). </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a2fc41a6584e342cfe4550a0efccd5cf4">minimize</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a042c3c1d3bac9ac6b167c99e9e8bc324"></a><!-- doxytag: member="BALL::LineSearch::getLowerBound" ref="a042c3c1d3bac9ac6b167c99e9e8bc324" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> BALL::LineSearch::getLowerBound </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the lower bound on energy values. </p>

</div>
</div>
<a class="anchor" id="a9924a72d419c4b35310c8ca81f2e4d8a"></a><!-- doxytag: member="BALL::LineSearch::getMaxSteps" ref="a9924a72d419c4b35310c8ca81f2e4d8a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a> BALL::LineSearch::getMaxSteps </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the parameter max_steps. </p>

</div>
</div>
<a class="anchor" id="a3c81f37becd13c045f13bd65197dc04d"></a><!-- doxytag: member="BALL::LineSearch::getXTol" ref="a3c81f37becd13c045f13bd65197dc04d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> BALL::LineSearch::getXTol </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the nonnegative relative tolerance for an acceptable step length. </p>

</div>
</div>
<a class="anchor" id="a71b44da638f178d9cf22cdce0cb74267"></a><!-- doxytag: member="BALL::LineSearch::isBracketed" ref="a71b44da638f178d9cf22cdce0cb74267" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::LineSearch::isBracketed </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return whether a minimizer has already been bracketed. Warning: this returns only the flag <code>is_bracketed_</code>. If this flag has not been set by the algorithm but changed by <code>setBracketedFlag</code> this might not be trustworthy! </p>

</div>
</div>
<a class="anchor" id="a2fc41a6584e342cfe4550a0efccd5cf4"></a><!-- doxytag: member="BALL::LineSearch::minimize" ref="a2fc41a6584e342cfe4550a0efccd5cf4" args="(double &amp;stp, bool keep_gradient=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::LineSearch::minimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>stp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>keep_gradient</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform a line search. Find the minimum position for all atoms along the direction provided by the minimization algorithm. A two stage algorithm is used proposed by Jorge J. More and David J. Thuente. If necessary (the convergence criterion is not fulfilled) a minimizer along the given direction is bracketed in the first stage. In the second stage this function looks for a minimizer whithin the bracketed interval. The routine exits</p>
<p>(1) if the strong Wolfe conditions are satisfied (convergence criterion for the line search), that are </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[E_{k+1} \leq E_k + \alpha\cdot stp\cdot<g_k, d_k>\]" src="../../form_54.png"/>
</p>
<p> and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[|<g_{k+1}, d_k>| \leq \beta\cdot |<g_k, d_k>|\]" src="../../form_55.png"/>
</p>
<p> where <img class="formulaInl" alt="$g_k$" src="../../form_56.png"/> and <img class="formulaInl" alt="$g_{k+1}$" src="../../form_57.png"/> are the initial and the current gradient and <img class="formulaInl" alt="$d_k$" src="../../form_58.png"/> is the search direction, <img class="formulaInl" alt="$E_{k+1}$" src="../../form_59.png"/> is the current and <img class="formulaInl" alt="$E_k$" src="../../form_60.png"/> the initial energy (stp = 0), <img class="formulaInl" alt="$\alpha$" src="../../form_61.png"/> and <img class="formulaInl" alt="$\beta$" src="../../form_62.png"/> are two parameters (usually 0.9 and 0.0001).</p>
<p>(2) if the relative tolerance for an acceptable step is reached (length of the bracketing interval).</p>
<p>(3) if there has been some numerical problems. In this case the best step length which could be found is returned.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>stp</em>&nbsp;</td><td>Unused on entry since the line search always starts with stp = 1.0. On exit the step length corresponding to a successful step or just the best this function was able to find. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>keep_gradient</em>&nbsp;</td><td>If <code>true</code>, we will not calculate the gradient for stp = 1 but assume that this has already been performed instead. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a17d138fbc785b46563fd7639f89adeae"></a><!-- doxytag: member="BALL::LineSearch::operator=" ref="a17d138fbc785b46563fd7639f89adeae" args="(const LineSearch &amp;LineSearch)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a>&amp; BALL::LineSearch::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html">LineSearch</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>LineSearch</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assignment operator </p>

</div>
</div>
<a class="anchor" id="a9c2de0a0c0c08d206d38bbdbd97ebd7b"></a><!-- doxytag: member="BALL::LineSearch::setAlpha" ref="a9c2de0a0c0c08d206d38bbdbd97ebd7b" args="(double alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setAlpha </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the parameter alpha (convergence criterion for the line search). </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a2fc41a6584e342cfe4550a0efccd5cf4">minimize</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aedef2724b5655cccfa7c81c1318c7af9"></a><!-- doxytag: member="BALL::LineSearch::setBeta" ref="aedef2724b5655cccfa7c81c1318c7af9" args="(double beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setBeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the parameter beta (convergence criterion for the line search). </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a2fc41a6584e342cfe4550a0efccd5cf4">minimize</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a536d0ae9e8d62360041fca0f1b2cb806"></a><!-- doxytag: member="BALL::LineSearch::setBracketedFlag" ref="a536d0ae9e8d62360041fca0f1b2cb806" args="(bool bracktd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setBracketedFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>bracktd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the flag <code>is_bracketed_</code>. The algorithm will act as if a minimizer has already been bracketed (true) or not (false). Warning: this can be useful if a user exactly knows what they are doing. Usually, this flag should not be touched! The algorithm sets this flag automatically if a minimizer could be bracketed. </p>

</div>
</div>
<a class="anchor" id="abd4ed6839ca50b6af007a8c46f1217a4"></a><!-- doxytag: member="BALL::LineSearch::setLowerBound" ref="abd4ed6839ca50b6af007a8c46f1217a4" args="(double lbound)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setLowerBound </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>lbound</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the lower bound on energy values. An estimation for the maximum step length is computed based on this value. </p>

</div>
</div>
<a class="anchor" id="ad7a41c56e038fda8ceab793236579a9c"></a><!-- doxytag: member="BALL::LineSearch::setMaxSteps" ref="ad7a41c56e038fda8ceab793236579a9c" args="(Size steps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setMaxSteps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td>
          <td class="paramname"> <em>steps</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the parameter max_steps. </p>

</div>
</div>
<a class="anchor" id="a19631a12c0fff0542b547b20463fff6a"></a><!-- doxytag: member="BALL::LineSearch::setMinimizer" ref="a19631a12c0fff0542b547b20463fff6a" args="(EnergyMinimizer &amp;minimizer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setMinimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>minimizer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the minimizer class which provides the search direction and the force field among other things. </p>

</div>
</div>
<a class="anchor" id="aa7899dffe5709feabb678158e7d2f39a"></a><!-- doxytag: member="BALL::LineSearch::setXTol" ref="aa7899dffe5709feabb678158e7d2f39a" args="(double xtol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::LineSearch::setXTol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>xtol</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the nonnegative relative tolerance for an acceptable step length. </p>

</div>
</div>
<a class="anchor" id="a3bdaa274550fbe5592c242bee132e95a"></a><!-- doxytag: member="BALL::LineSearch::takeStep" ref="a3bdaa274550fbe5592c242bee132e95a" args="(double &amp;st_a, double &amp;f_a, double &amp;g_a, double &amp;st_b, double &amp;f_b, double &amp;g_b, double &amp;stp, double f, double g, double minstp, double maxstp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BALL::LineSearch::takeStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>st_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>f_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>g_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>st_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>f_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>g_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>stp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>minstp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>maxstp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Computes a safeguarded step for a search procedure by case differentiation dependend on whether a minimum could already be bracketed or not. All computations are done by safeguarded quadratic and cubic interpolation. The interval that contains a step that satisfies a sufficient decrease and the curvature condition is updated. This function is based on the proposed step computation of Jorge J. More and David J. Thuente. Don't worry if interval bounds are changed after this routine exits.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>st_a</em>&nbsp;</td><td>Best step obtained so far and an endpoint of the interval that contains the minimizer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_a</em>&nbsp;</td><td>Energy value at <code>st_a</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>g_a</em>&nbsp;</td><td>Directional derivative at <code>st_a</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>st_b</em>&nbsp;</td><td>Second endpoint of the interval that contains the minimizer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_b</em>&nbsp;</td><td>Energy value at <code>st_b</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>g_b</em>&nbsp;</td><td>Directional derivative at <code>st_b</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stp</em>&nbsp;</td><td>Current step. If <code>is_bracketed_</code> is set to <code>true</code> then <code>stp</code> must be between <code>st_a</code> and <code>st_b</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>Energy value at <code>stp</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>g</em>&nbsp;</td><td>Directional derivative at <code>stp</code>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>minstp</em>&nbsp;</td><td>Lower bound for the step. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxstp</em>&nbsp;</td><td>Upper bound for the step. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a7d85e7b2c96195e239a896dd9b853a72"></a><!-- doxytag: member="BALL::LineSearch::alpha_" ref="a7d85e7b2c96195e239a896dd9b853a72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a7d85e7b2c96195e239a896dd9b853a72">BALL::LineSearch::alpha_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00202">202</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="a281134ccb999e20139696f16f28e6c09"></a><!-- doxytag: member="BALL::LineSearch::beta_" ref="a281134ccb999e20139696f16f28e6c09" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a281134ccb999e20139696f16f28e6c09">BALL::LineSearch::beta_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00206">206</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae94728489979ab207dc5265314d49259"></a><!-- doxytag: member="BALL::LineSearch::is_bracketed_" ref="ae94728489979ab207dc5265314d49259" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#ae94728489979ab207dc5265314d49259">BALL::LineSearch::is_bracketed_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00222">222</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7f0858c36794f1f0622d1fdb09037f0f"></a><!-- doxytag: member="BALL::LineSearch::lower_energy_bound_" ref="a7f0858c36794f1f0622d1fdb09037f0f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a7f0858c36794f1f0622d1fdb09037f0f">BALL::LineSearch::lower_energy_bound_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00214">214</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="aefcb4db30a62361fca3a6c4c913eae97"></a><!-- doxytag: member="BALL::LineSearch::max_steps_" ref="aefcb4db30a62361fca3a6c4c913eae97" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d76/classBALL__SIZE__TYPE.html">Size</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#aefcb4db30a62361fca3a6c4c913eae97">BALL::LineSearch::max_steps_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00210">210</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3f271ba47cc613795472d276e7c49e76"></a><!-- doxytag: member="BALL::LineSearch::minimizer_" ref="a3f271ba47cc613795472d276e7c49e76" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d0a/classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a>* <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a3f271ba47cc613795472d276e7c49e76">BALL::LineSearch::minimizer_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00226">226</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
<a class="anchor" id="a60d9acc97eda24aeff794ef737d58747"></a><!-- doxytag: member="BALL::LineSearch::stptol_" ref="a60d9acc97eda24aeff794ef737d58747" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d47/classBALL_1_1LineSearch.html#a60d9acc97eda24aeff794ef737d58747">BALL::LineSearch::stptol_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../da/d01/lineSearch_8h_source.html#l00218">218</a> of file <a class="el" href="../../da/d01/lineSearch_8h_source.html">lineSearch.h</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Dec 7 19:12:50 2010 for BALL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.5.9 </small></address>
</body>
</html>
