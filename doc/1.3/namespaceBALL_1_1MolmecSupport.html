<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
  <div class="navpath"><a class="el" href="namespaceBALL.html">BALL</a>::<a class="el" href="namespaceBALL_1_1MolmecSupport.html">MolmecSupport</a>
  </div>
<div class="contents">
<h1>BALL::MolmecSupport Namespace Reference<br/>
<small>
[<a class="el" href="group__MolmecCommon.html">General Force Field Classes.</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br/><h2>Enumerations</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Enums</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a968bb1f57af1baec18f4f55ffefec12f">PairListAlgorithmType</a> { <a class="el" href="namespaceBALL_1_1MolmecSupport.html#a968bb1f57af1baec18f4f55ffefec12fa70d4dcba8fc7524efe32f38cc4d1d9b1">HASH_GRID</a>, 
<a class="el" href="namespaceBALL_1_1MolmecSupport.html#a968bb1f57af1baec18f4f55ffefec12faec89cfd723ce62ecf9965d20860f1eed">BRUTE_FORCE</a>
 }</td></tr>
<tr><td colspan="2"><br/><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">BALL::Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a4b9b62d4e91daa5351bc4cc544818446">calculateNonBondedAtomPairs</a> (<a class="el" href="classBALL_1_1ForceField.html#a0a275c09a7cbfa92d2b06cfce85f0cd7">ForceField::PairVector</a> &amp;pair_vector, const <a class="el" href="classBALL_1_1AtomVector.html">AtomVector</a> &amp;atom_vector, const <a class="el" href="classBALL_1_1TSimpleBox3.html">SimpleBox3</a> &amp;box, <a class="el" href="classdouble.html">double</a> distance, <a class="el" href="classbool.html">bool</a> periodic_boundary_enabled, <a class="el" href="namespaceBALL_1_1MolmecSupport.html#a968bb1f57af1baec18f4f55ffefec12f">PairListAlgorithmType</a> type)  throw (Exception::OutOfMemory)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a7f7bddfa0f262a05fa33b58e57fcd2c3">sortNonBondedAtomPairsAfterSelection</a> (<a class="el" href="classBALL_1_1ForceField.html#a0a275c09a7cbfa92d2b06cfce85f0cd7">ForceField::PairVector</a> &amp;pair_vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">BALL::Size</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a67c050175da00ee8009394850942390a">addNonOverlappingMolecules</a> (<a class="el" href="classBALL_1_1System.html">System</a> &amp;system, const <a class="el" href="classBALL_1_1HashGrid3.html">HashGrid3</a>&lt; const <a class="el" href="classBALL_1_1Atom.html">Atom</a> * &gt; &amp;solute_grid, const <a class="el" href="classBALL_1_1System.html">System</a> &amp;solvent, const <a class="el" href="classBALL_1_1TSimpleBox3.html">SimpleBox3</a> &amp;box, <a class="el" href="classdouble.html">double</a> distance)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BALL_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#aefa956a5cc8ed6e6db2e00450d9711a5">adaptWaterBox</a> (<a class="el" href="classBALL_1_1System.html">System</a> &amp;system, const <a class="el" href="classBALL_1_1TSimpleBox3.html">SimpleBox3</a> &amp;box)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BALL_EXPORT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a7ee7c0fbe677a9c5d4ef3d38b5d4e070">calculateMinimumImage</a> (<a class="el" href="classBALL_1_1TVector3.html">Vector3</a> &amp;distance, const <a class="el" href="classBALL_1_1TVector3.html">Vector3</a> &amp;period)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename TorsionType , typename AtomIteratorType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a>&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceBALL_1_1MolmecSupport.html#a4418102c58ffa08c86d41cc47210d166">computeTorsions</a> (const AtomIteratorType &amp;start, const AtomIteratorType &amp;end, std::vector&lt; TorsionType &gt; &amp;torsions, <a class="el" href="classbool.html">bool</a> use_selection=false)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="namespaceBALL_1_1MolmecSupport.html">MolmecSupport</a> </p>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="a968bb1f57af1baec18f4f55ffefec12f"></a><!-- doxytag: member="BALL::MolmecSupport::PairListAlgorithmType" ref="a968bb1f57af1baec18f4f55ffefec12f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespaceBALL_1_1MolmecSupport.html#a968bb1f57af1baec18f4f55ffefec12f">BALL::MolmecSupport::PairListAlgorithmType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The type of algorithm used to calculate the pair list. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a968bb1f57af1baec18f4f55ffefec12fa70d4dcba8fc7524efe32f38cc4d1d9b1"></a><!-- doxytag: member="HASH_GRID" ref="a968bb1f57af1baec18f4f55ffefec12fa70d4dcba8fc7524efe32f38cc4d1d9b1" args="" -->HASH_GRID</em>&nbsp;</td><td>
<p>use a hash grid </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a968bb1f57af1baec18f4f55ffefec12faec89cfd723ce62ecf9965d20860f1eed"></a><!-- doxytag: member="BRUTE_FORCE" ref="a968bb1f57af1baec18f4f55ffefec12faec89cfd723ce62ecf9965d20860f1eed" args="" -->BRUTE_FORCE</em>&nbsp;</td><td>
<p>brute force all against all </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aefa956a5cc8ed6e6db2e00450d9711a5"></a><!-- doxytag: member="BALL::MolmecSupport::adaptWaterBox" ref="aefa956a5cc8ed6e6db2e00450d9711a5" args="(System &amp;system, const SimpleBox3 &amp;box)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL_EXPORT void BALL::MolmecSupport::adaptWaterBox </td>
          <td>(</td>
          <td class="paramtype">System &amp;&nbsp;</td>
          <td class="paramname"> <em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SimpleBox3 &amp;&nbsp;</td>
          <td class="paramname"> <em>box</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adapt periodic water (or general solvent) boxes to our periodic boundary definition. Periodic water boxes created by different programs might contain molecules which have their center of gravity outside of the box because of a different defintion of the periodic boundary. This function adapts such boxes to our definition by simply translating such molecules to the opposite boundary wall such that their center of gravity lies in the box afterwards. </p>
<dl class="user"><dt><b></b></dt><dd>This might be obsoleted by PeriodicBoundarry::updateMolecules() </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>system</em>&nbsp;</td><td>the system containing the water box which is to be adapted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>box</em>&nbsp;</td><td>the box definition for the periodic boundary </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a67c050175da00ee8009394850942390a"></a><!-- doxytag: member="BALL::MolmecSupport::addNonOverlappingMolecules" ref="a67c050175da00ee8009394850942390a" args="(System &amp;system, const HashGrid3&lt; const Atom * &gt; &amp;solute_grid, const System &amp;solvent, const SimpleBox3 &amp;box, double distance)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">BALL::Size</a> BALL::MolmecSupport::addNonOverlappingMolecules </td>
          <td>(</td>
          <td class="paramtype">System &amp;&nbsp;</td>
          <td class="paramname"> <em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const HashGrid3&lt; const Atom * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>solute_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const System &amp;&nbsp;</td>
          <td class="paramname"> <em>solvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SimpleBox3 &amp;&nbsp;</td>
          <td class="paramname"> <em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>distance</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Merge the non-overlapping molecules of a system into another system. Fills <code>system</code> with copies of the solvent molecules stored in <code>solvent</code>. Solvent molecules are added to <code>system</code> if the molecules lie in the <code>box</code> and if they do not overlap with the molecules in <code>solute_grid</code>. A molecule has an overlap with another molecule if any atom of the first molecule is within <code> distance</code> of any atom of the other molecule. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>system</em>&nbsp;</td><td>the system to be filled </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>solute_grid</em>&nbsp;</td><td>a hash grid containing the solute molecules </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>solvent</em>&nbsp;</td><td>the system containing the solvent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>box</em>&nbsp;</td><td>the periodic boundary of <code>system</code> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>distance</em>&nbsp;</td><td>used to determine overlaps between two atoms </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of molecules added to <code>system</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a7ee7c0fbe677a9c5d4ef3d38b5d4e070"></a><!-- doxytag: member="BALL::MolmecSupport::calculateMinimumImage" ref="a7ee7c0fbe677a9c5d4ef3d38b5d4e070" args="(Vector3 &amp;distance, const Vector3 &amp;period)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL_EXPORT void BALL::MolmecSupport::calculateMinimumImage </td>
          <td>(</td>
          <td class="paramtype">Vector3 &amp;&nbsp;</td>
          <td class="paramname"> <em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector3 &amp;&nbsp;</td>
          <td class="paramname"> <em>period</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute the minimum image </p>

</div>
</div>
<a class="anchor" id="a4b9b62d4e91daa5351bc4cc544818446"></a><!-- doxytag: member="BALL::MolmecSupport::calculateNonBondedAtomPairs" ref="a4b9b62d4e91daa5351bc4cc544818446" args="(ForceField::PairVector &amp;pair_vector, const AtomVector &amp;atom_vector, const SimpleBox3 &amp;box, double distance, bool periodic_boundary_enabled, PairListAlgorithmType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">BALL::Size</a> BALL::MolmecSupport::calculateNonBondedAtomPairs </td>
          <td>(</td>
          <td class="paramtype">ForceField::PairVector &amp;&nbsp;</td>
          <td class="paramname"> <em>pair_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AtomVector &amp;&nbsp;</td>
          <td class="paramname"> <em>atom_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SimpleBox3 &amp;&nbsp;</td>
          <td class="paramname"> <em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a>&nbsp;</td>
          <td class="paramname"> <em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>periodic_boundary_enabled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PairListAlgorithmType&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td>  throw (<a class="el" href="classBALL_1_1Exception_1_1OutOfMemory.html">Exception::OutOfMemory</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a pair vector for non-bonded interactions. Calculates a vector of atom pairs whose distance is smaller than <code>distance</code>. The <code>type</code> determines if a brute force algorithm (<code>type == BRUTE_FORCE</code>) or a more sophisticated grid method (<code>type == HASH_GRID</code>) is used. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pair_vector</em>&nbsp;</td><td>the vector containing pairs of interacting atoms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>atom_vector</em>&nbsp;</td><td>the atoms to be considered for pairs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>box</em>&nbsp;</td><td>the periodic boundary used (if <code> periodic_boundary_enabled == true</code>) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>distance</em>&nbsp;</td><td>the maximum distance (cut-off distance) for two atoms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>periodic_boundary_enabled</em>&nbsp;</td><td>flag indicating the use of periodic boundary conditions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>the type of algorithm used to calculate the pair vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of pairs generated (<code>pair_vector.size()</code>) </dd></dl>

</div>
</div>
<a class="anchor" id="a4418102c58ffa08c86d41cc47210d166"></a><!-- doxytag: member="BALL::MolmecSupport::computeTorsions" ref="a4418102c58ffa08c86d41cc47210d166" args="(const AtomIteratorType &amp;start, const AtomIteratorType &amp;end, std::vector&lt; TorsionType &gt; &amp;torsions, bool use_selection=false)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TorsionType , typename AtomIteratorType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL__SIZE__TYPE.html">Size</a> BALL::MolmecSupport::computeTorsions </td>
          <td>(</td>
          <td class="paramtype">const AtomIteratorType &amp;&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AtomIteratorType &amp;&nbsp;</td>
          <td class="paramname"> <em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; TorsionType &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>torsions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&nbsp;</td>
          <td class="paramname"> <em>use_selection</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute all torsions in a given set of molecules. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of torsions added to <code>torsions</code> </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>start</em>&nbsp;</td><td>an iterator pointing to the start of the atoms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>end</em>&nbsp;</td><td>a past-the-end iterator for the atoms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>torsions</em>&nbsp;</td><td>the vector of torsions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>use_selection</em>&nbsp;</td><td>if set to <b>true</b>, a torsion will be added only if all four atoms are selected </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classBALL_1_1Selectable.html#a0e102a1707f8ad68d1cf84977e50e96c">BALL::Selectable::isSelected()</a>.</p>

</div>
</div>
<a class="anchor" id="a7f7bddfa0f262a05fa33b58e57fcd2c3"></a><!-- doxytag: member="BALL::MolmecSupport::sortNonBondedAtomPairsAfterSelection" ref="a7f7bddfa0f262a05fa33b58e57fcd2c3" args="(ForceField::PairVector &amp;pair_vector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL_EXPORT <a class="el" href="classBALL__SIZE__TYPE.html">Size</a> BALL::MolmecSupport::sortNonBondedAtomPairsAfterSelection </td>
          <td>(</td>
          <td class="paramtype">ForceField::PairVector &amp;&nbsp;</td>
          <td class="paramname"> <em>pair_vector</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sort the pair list. The atom pairs in the list ar sorted in such a way, that those atom pairs where at least one of the atoms is selected are at the beginning of the list. The number of such pairs is returned. Running time is linear in the length of the list. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of atom pairs in the list, where at least one atom is selected </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pair_vector</em>&nbsp;</td><td>the unsorted pair_list (modified during the sorting) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
</div>
</body>
</html>
