<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
<h1>FFT1D.h</h1><a href="FFT1D_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++; tab-width: 2; -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vi: set ts=2:</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// $Id: FFT1D.h,v 1.19 2006/01/03 17:42:39 anhi Exp $</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef BALL_MATHS_TFFT1D_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define BALL_MATHS_TFFT1D_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef BALL_COMMON_EXCEPTION_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="exception_8h.html">BALL/COMMON/exception.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef BALL_DATATYPE_REGULARDATA1D_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="regularData1D_8h.html">BALL/DATATYPE/regularData1D.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#endif</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;complex&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;fftw3.h&gt;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="fftwCommon_8h.html">BALL/MATHS/fftwCommon.h</a>&gt;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">namespace </span>BALL
<a name="l00025"></a>00025 {
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00037"></a>00037   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00038"></a><a class="code" href="classBALL_1_1TFFT1D.html">00038</a>   <span class="keyword">class </span><a class="code" href="classBALL_1_1TFFT1D.html">TFFT1D</a> 
<a name="l00039"></a>00039     : <span class="keyword">public</span> <a class="code" href="classBALL_1_1TRegularData1D.html">TRegularData1D</a>&lt;std::complex&lt;typename ComplexTraits::ComplexPrecision&gt; &gt;
<a name="l00040"></a>00040   {
<a name="l00041"></a>00041     <span class="keyword">public</span>:
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">00043</a>     <span class="keyword">typedef</span> std::complex&lt;typename ComplexTraits::ComplexPrecision&gt; <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>;
<a name="l00044"></a><a class="code" href="classBALL_1_1TFFT1D.html#a8ac6bc83461bc3b56aecbf2b176fd44d">00044</a>     <span class="keyword">typedef</span> <a class="code" href="classBALL_1_1TRegularData1D.html">TRegularData1D&lt;std::complex&lt;typename ComplexTraits::ComplexPrecision&gt;</a> &gt; <a class="code" href="classBALL_1_1TRegularData1D.html">ComplexVector</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046     <a class="code" href="group__Common.html#ga84998f74fd7a58cecfcbb81d48b4323b">BALL_CREATE</a>(<a class="code" href="classBALL_1_1TFFT1D.html">TFFT1D</a>)
<a name="l00047"></a>00047 
<a name="l00048"></a>00048     
<a name="l00051"></a>00051 
<a name="l00053"></a>00053     <a class="code" href="classBALL_1_1TFFT1D.html">TFFT1D</a>();
<a name="l00054"></a>00054 
<a name="l00056"></a>00056     TFFT1D(const TFFT1D &amp;data);
<a name="l00057"></a>00057 
<a name="l00067"></a>00067      <span class="comment">// AR: ldn is not any longer the binary logarithm but the absolute number of grid points</span>
<a name="l00068"></a>00068     TFFT1D(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> ldn, <span class="keywordtype">double</span> stepPhys = 1., <span class="keywordtype">double</span> origin = 0., <span class="keywordtype">bool</span> inFourierSpace = false);
<a name="l00069"></a>00069     
<a name="l00071"></a>00071     virtual ~TFFT1D();
<a name="l00072"></a>00072     
<a name="l00074"></a>00074 
<a name="l00078"></a>00078 
<a name="l00080"></a>00080     const TFFT1D&amp; operator = (const TFFT1D&amp; fft1d);
<a name="l00081"></a>00081     
<a name="l00084"></a>00084     virtual <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#a3455b10096ca422eb5f0d74316b0796b">clear</a>();
<a name="l00085"></a>00085     
<a name="l00088"></a>00088     virtual <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae2acc576bc3bf14564b400285a0dc26b">destroy</a>();
<a name="l00089"></a>00089 
<a name="l00091"></a>00091 
<a name="l00095"></a>00095 
<a name="l00098"></a>00098     <span class="keywordtype">bool</span> operator == (const TFFT1D&amp; fft1d) const;
<a name="l00100"></a>00100     
<a name="l00101"></a>00101     <span class="comment">// @name Accessors</span>
<a name="l00102"></a>00102     
<a name="l00105"></a>00105     <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#a6811a0a60f6a9c480034e3de424a3a04">doFFT</a>();
<a name="l00106"></a>00106 
<a name="l00109"></a>00109     <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae0f3d7e652e245c0b1407d699dc0a33f">doiFFT</a>();
<a name="l00110"></a>00110 
<a name="l00115"></a>00115     <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a04b87e4e7a2b2a447abedebc81e33c14">translate</a>(<span class="keywordtype">double</span> trans_origin);
<a name="l00116"></a>00116 
<a name="l00122"></a>00122     <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a959b03934cdaf8a28c00df50f4a3be41">setPhysStepWidth</a>(<span class="keywordtype">double</span> new_width);
<a name="l00123"></a>00123 
<a name="l00126"></a>00126     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a840b42c7d91165569218c1b63aff9e96">getPhysStepWidth</a>() const;
<a name="l00127"></a>00127 
<a name="l00130"></a>00130     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac6c94d767e9d713a0063ae0185c26a32">getFourierStepWidth</a>() const;
<a name="l00131"></a>00131 
<a name="l00134"></a>00134     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a2179695e7bb9213c3b3acfb276961ca6">getPhysSpaceMin</a>() const;
<a name="l00135"></a>00135 
<a name="l00138"></a>00138     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae5170727eecdcc1400edd3f0b42b3a0c">getPhysSpaceMax</a>() const;
<a name="l00139"></a>00139 
<a name="l00142"></a>00142     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a814534b61e594187c4ac85bd324df363">getFourierSpaceMin</a>() const;
<a name="l00143"></a>00143 
<a name="l00146"></a>00146     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#af87d84bd442a5ed0a5e240228b403bf9">getFourierSpaceMax</a>() const;
<a name="l00147"></a>00147       
<a name="l00153"></a>00153     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#af7637fdb8b6a3bfa7dc5fa78d7dfd656">getMaxIndex</a>() const;
<a name="l00154"></a>00154 
<a name="l00158"></a>00158     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#ad6cf91724d3b7428d20a5f439d89c05e">getNumberOfInverseTransforms</a>() const;
<a name="l00159"></a>00159   
<a name="l00162"></a>00162     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac0e073426e3763ef45d27f44f545c7c9">getGridCoordinates</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> position) const;
<a name="l00163"></a>00163 
<a name="l00168"></a>00168     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#a67d701b55f3dc294f80f4c07ff0cc8f7">getData</a>(const <span class="keywordtype">double</span> pos) const
<a name="l00169"></a>00169       throw(Exception::OutOfGrid);
<a name="l00170"></a>00170 
<a name="l00176"></a>00176     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#a454334aaecbf0d965a4a72d5fb232934">getInterpolatedValue</a>(const <span class="keywordtype">double</span> pos) const
<a name="l00177"></a>00177       throw(Exception::OutOfGrid);
<a name="l00178"></a>00178 
<a name="l00183"></a>00183     <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#a3d84fc21a7f00a8aa428423023a863a1">setData</a>(<span class="keywordtype">double</span> pos, <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> val)
<a name="l00184"></a>00184       throw(Exception::OutOfGrid);
<a name="l00185"></a>00185 
<a name="l00189"></a>00189     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>&amp; operator [] (const <span class="keywordtype">double</span> pos)
<a name="l00190"></a>00190       throw(Exception::OutOfGrid);
<a name="l00191"></a>00191 
<a name="l00195"></a>00195     const <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>&amp; operator [] (const <span class="keywordtype">double</span> pos) const
<a name="l00196"></a>00196       throw(Exception::OutOfGrid);
<a name="l00197"></a>00197     
<a name="l00200"></a><a class="code" href="classBALL_1_1TFFT1D.html#ac3a236e6bc10adcd423d62710ae37c6b">00200</a>     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>&amp; operator[](const <a class="code" href="classBALL__SIZE__TYPE.html">Position</a>&amp; pos)
<a name="l00201"></a>00201       throw(Exception::OutOfGrid)
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203       <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">TRegularData1D&lt;Complex&gt;::operator[]</a>(pos);
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205       
<a name="l00208"></a><a class="code" href="classBALL_1_1TFFT1D.html#a8f352ebb0966a81b4655207d0f8c01f4">00208</a>     <span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">operator[]</a>(<span class="keyword">const</span> <a class="code" href="classBALL__SIZE__TYPE.html">Position</a>&amp; pos) <span class="keyword">const</span>
<a name="l00209"></a>00209       <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211       <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">TRegularData1D&lt;Complex&gt;::operator[]</a>(pos);
<a name="l00212"></a>00212     } 
<a name="l00213"></a>00213     
<a name="l00214"></a>00214     <span class="comment">// AR:</span>
<a name="l00215"></a><a class="code" href="classBALL_1_1TFFT1D.html#a2233f9c44e218aad91bf9dad9a3915b0">00215</a>     <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#a2233f9c44e218aad91bf9dad9a3915b0">setNumberOfFFTTransforms</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> num)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217       <a class="code" href="classBALL_1_1TFFT1D.html#aff15943a0fd5f07b130842cc0926e95d">numPhysToFourier_</a> = num;
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219       
<a name="l00220"></a>00220     <span class="comment">// AR:</span>
<a name="l00221"></a><a class="code" href="classBALL_1_1TFFT1D.html#aa772a1cad5bec16dcc786e15676ed558">00221</a>     <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#aa772a1cad5bec16dcc786e15676ed558">setNumberOfiFFTTransforms</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> num)
<a name="l00222"></a>00222     {
<a name="l00223"></a>00223       <a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">numFourierToPhys_</a> = num;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     
<a name="l00229"></a>00229     <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a75784f470a5078e65a5abeb8ba0e269f">isInFourierSpace</a>() <span class="keyword">const</span>;
<a name="l00230"></a>00230     
<a name="l00236"></a>00236     <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#ace038daa8ea5b5c39d9c0cb9d3c0a3b1">phase</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos) <span class="keyword">const</span>;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="keyword">protected</span>:
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">00240</a>     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>;
<a name="l00241"></a><a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">00241</a>     <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a>;
<a name="l00242"></a><a class="code" href="classBALL_1_1TFFT1D.html#aff15943a0fd5f07b130842cc0926e95d">00242</a>     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#aff15943a0fd5f07b130842cc0926e95d">numPhysToFourier_</a>;
<a name="l00243"></a><a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">00243</a>     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">numFourierToPhys_</a>;
<a name="l00244"></a><a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d">00244</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>;
<a name="l00245"></a><a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">00245</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>;
<a name="l00246"></a><a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">00246</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>;
<a name="l00247"></a><a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">00247</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a>;
<a name="l00248"></a><a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">00248</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a>;
<a name="l00249"></a><a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">00249</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a>;
<a name="l00250"></a><a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">00250</a>     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a>;
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="classBALL_1_1TFFT1D.html#a28f76bd03093e0f327869ca5f2c254b0">00252</a>     <span class="keyword">typename</span> ComplexTraits::FftwPlan <a class="code" href="classBALL_1_1TFFT1D.html#a28f76bd03093e0f327869ca5f2c254b0">planForward_</a>;
<a name="l00253"></a><a class="code" href="classBALL_1_1TFFT1D.html#a3e3a3aabd35f6ea4ff06f77d86210a48">00253</a>     <span class="keyword">typename</span> ComplexTraits::FftwPlan <a class="code" href="classBALL_1_1TFFT1D.html#a3e3a3aabd35f6ea4ff06f77d86210a48">planBackward_</a>;
<a name="l00254"></a>00254     
<a name="l00255"></a>00255     <span class="comment">// AR: to control plan calculation with new fftw3</span>
<a name="l00256"></a><a class="code" href="classBALL_1_1TFFT1D.html#a968cd71435d3f76c09a55040284d0095">00256</a>     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> *<a class="code" href="classBALL_1_1TFFT1D.html#a968cd71435d3f76c09a55040284d0095">dataAdress_</a>;
<a name="l00257"></a><a class="code" href="classBALL_1_1TFFT1D.html#ac6a44cfeb08ed2a2958722b340af725f">00257</a>     <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac6a44cfeb08ed2a2958722b340af725f">planCalculated_</a>;
<a name="l00258"></a>00258   };
<a name="l00260"></a>00260   
<a name="l00263"></a><a class="code" href="namespaceBALL.html#aa2dd366a9e3f19dd1d9ab69698216bf7">00263</a>   <span class="keyword">typedef</span> <a class="code" href="classBALL_1_1TFFT1D.html">TFFT1D&lt;BALL_FFTW_DEFAULT_TRAITS&gt;</a> <a class="code" href="classBALL_1_1TFFT1D.html">FFT1D</a>;
<a name="l00264"></a>00264   
<a name="l00265"></a>00265   <span class="comment">// AR:</span>
<a name="l00268"></a>00268 <span class="comment"></span><span class="comment">//  const TRegularData1D&lt;Complex&gt;&amp; operator &lt;&lt; (TRegularData1D&lt;Complex&gt;&amp; to, const TFFT1D&amp; from)</span>
<a name="l00269"></a>00269   <span class="comment">//; ?????</span>
<a name="l00270"></a>00270   
<a name="l00275"></a>00275 <span class="comment">//  const RegularData1D&amp; operator &lt;&lt; (RegularData1D&amp; to, const TFFT1D&amp; from)</span>
<a name="l00276"></a>00276 <span class="comment">//; ???????</span>
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00281"></a><a class="code" href="classBALL_1_1TFFT1D.html#aae451c1bbeef0d041e2c7dd2c85ed2ac">00281</a>   <a class="code" href="classBALL_1_1TFFT1D.html#aae451c1bbeef0d041e2c7dd2c85ed2ac" title="Default constructor.">TFFT1D&lt;ComplexTraits&gt;::TFFT1D</a>()
<a name="l00282"></a>00282     : <a class="code" href="classBALL_1_1TRegularData1D.html">TRegularData1D</a>&lt;<a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>&gt;(0, 0, 1.),  <span class="comment">// AR: old case: This is necessary because FFTW_COMPLEX has no default constructor</span>
<a name="l00283"></a>00283       length_(0),
<a name="l00284"></a>00284       inFourierSpace_(false),
<a name="l00285"></a>00285       dataAdress_(0),
<a name="l00286"></a>00286       planCalculated_(false)
<a name="l00287"></a>00287   {
<a name="l00288"></a>00288   }
<a name="l00289"></a>00289     
<a name="l00290"></a>00290 
<a name="l00291"></a>00291   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00292"></a><a class="code" href="classBALL_1_1TFFT1D.html#a4bbea85c34f5ff09d65d0aa7ac8b073f">00292</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a4bbea85c34f5ff09d65d0aa7ac8b073f">TFFT1D&lt;ComplexTraits&gt;::operator == </a>(<span class="keyword">const</span> <a class="code" href="classBALL_1_1TFFT1D.html">TFFT1D&lt;ComplexTraits&gt;</a>&amp; fft1d)<span class="keyword"> const</span>
<a name="l00293"></a>00293 <span class="keyword">  </span>{
<a name="l00294"></a>00294     <span class="keywordflow">if</span> (<a class="code" href="classBALL_1_1TRegularData1D.html#a9498bf284e18b347ef171e76d9910cd5">ComplexVector::size</a>() == fft1d.<a class="code" href="classBALL_1_1TRegularData1D.html#a9498bf284e18b347ef171e76d9910cd5">size</a>() &amp;&amp;
<a name="l00295"></a>00295         <a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a> &amp;&amp;
<a name="l00296"></a>00296         <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a> &amp;&amp;
<a name="l00297"></a>00297         <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a> &amp;&amp;
<a name="l00298"></a>00298         <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a> &amp;&amp;
<a name="l00299"></a>00299         <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a> &amp;&amp;
<a name="l00300"></a>00300         <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a> &amp;&amp;
<a name="l00301"></a>00301         <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a> &amp;&amp;
<a name="l00302"></a>00302         <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a> &amp;&amp;
<a name="l00303"></a>00303         <a class="code" href="classBALL_1_1TFFT1D.html#aff15943a0fd5f07b130842cc0926e95d">numPhysToFourier_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#aff15943a0fd5f07b130842cc0926e95d">numPhysToFourier_</a> &amp;&amp;
<a name="l00304"></a>00304         <a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">numFourierToPhys_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">numFourierToPhys_</a> &amp;&amp;
<a name="l00305"></a>00305         <a class="code" href="classBALL_1_1TFFT1D.html#ac6a44cfeb08ed2a2958722b340af725f">planCalculated_</a> == fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#ac6a44cfeb08ed2a2958722b340af725f">planCalculated_</a>)
<a name="l00306"></a>00306     {
<a name="l00307"></a>00307       <span class="keywordtype">double</span> <a class="code" href="group__MathsCommon.html#ga48cc5e26e859eca3082fc4ee4be51fa9">min</a>  = <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a> ?  <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a> :  <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a>;
<a name="l00308"></a>00308       <span class="keywordtype">double</span> <a class="code" href="group__MathsCommon.html#ga7454a5315c85deffac5ab82b40185c7a">max</a>  = <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a> ?  <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a> :  <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a>;
<a name="l00309"></a>00309       <span class="keywordtype">double</span> step = <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a> ? <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a> : <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>;
<a name="l00310"></a>00310         
<a name="l00311"></a>00311       <span class="keywordflow">for</span> (<span class="keywordtype">double</span> pos=min; pos&lt;=max; pos+=step)
<a name="l00312"></a>00312       {
<a name="l00313"></a>00313         <span class="keywordflow">if</span> (<a class="code" href="classBALL_1_1TFFT1D.html#a67d701b55f3dc294f80f4c07ff0cc8f7">getData</a>(pos) != fft1d.<a class="code" href="classBALL_1_1TFFT1D.html#a67d701b55f3dc294f80f4c07ff0cc8f7">getData</a>(pos))
<a name="l00314"></a>00314         {
<a name="l00315"></a>00315           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317       }
<a name="l00318"></a>00318       
<a name="l00319"></a>00319       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321   
<a name="l00322"></a>00322     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00323"></a>00323   } 
<a name="l00324"></a>00324 
<a name="l00325"></a>00325   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00326"></a><a class="code" href="classBALL_1_1TFFT1D.html#a04b87e4e7a2b2a447abedebc81e33c14">00326</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a04b87e4e7a2b2a447abedebc81e33c14">TFFT1D&lt;ComplexTraits&gt;::translate</a>(<span class="keywordtype">double</span> trans_origin)
<a name="l00327"></a>00327   {
<a name="l00328"></a>00328     <a class="code" href="classBALL__SIZE__TYPE.html">Position</a> internalOrigin = (int) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>(trans_origin/<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>);
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (internalOrigin &lt;= <a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>)
<a name="l00330"></a>00330     {
<a name="l00331"></a>00331       <a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a> = trans_origin;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333       <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a> = ((-1.)*<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>);
<a name="l00334"></a>00334       <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a> = (((<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>-1)*<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>)-<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>);
<a name="l00335"></a>00335       <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a> = ((-1.)*(<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>);
<a name="l00336"></a>00336       <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a> = ((<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>/2.)*<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>);
<a name="l00337"></a>00337       
<a name="l00338"></a>00338       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00339"></a>00339     }
<a name="l00340"></a>00340     <span class="keywordflow">else</span>
<a name="l00341"></a>00341     {
<a name="l00342"></a>00342       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344   }
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00347"></a><a class="code" href="classBALL_1_1TFFT1D.html#a959b03934cdaf8a28c00df50f4a3be41">00347</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a959b03934cdaf8a28c00df50f4a3be41">TFFT1D&lt;ComplexTraits&gt;::setPhysStepWidth</a>(<span class="keywordtype">double</span> new_width)
<a name="l00348"></a>00348   {
<a name="l00349"></a>00349     <span class="keywordflow">if</span> (new_width &lt; 0)
<a name="l00350"></a>00350     {
<a name="l00351"></a>00351       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353     <span class="keywordflow">else</span>
<a name="l00354"></a>00354     {
<a name="l00355"></a>00355       <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a> = new_width;
<a name="l00356"></a>00356       <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a> = 2.*M_PI/(<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>*<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>);
<a name="l00357"></a>00357 
<a name="l00358"></a>00358       <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a> = ((-1.)*<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>);
<a name="l00359"></a>00359       <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a> = (((<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>-1)*<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>)-<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>);
<a name="l00360"></a>00360       <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a> = ((-1.)*(<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>/2.-1)*<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>);
<a name="l00361"></a>00361       <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a> = ((<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>/2.)*<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00364"></a>00364     }
<a name="l00365"></a>00365   }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt; 
<a name="l00368"></a><a class="code" href="classBALL_1_1TFFT1D.html#a840b42c7d91165569218c1b63aff9e96">00368</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a840b42c7d91165569218c1b63aff9e96">TFFT1D&lt;ComplexTraits&gt;::getPhysStepWidth</a>()<span class="keyword"> const</span>
<a name="l00369"></a>00369 <span class="keyword">  </span>{
<a name="l00370"></a>00370     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>;
<a name="l00371"></a>00371   }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00374"></a><a class="code" href="classBALL_1_1TFFT1D.html#ac6c94d767e9d713a0063ae0185c26a32">00374</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac6c94d767e9d713a0063ae0185c26a32">TFFT1D&lt;ComplexTraits&gt;::getFourierStepWidth</a>()<span class="keyword"> const</span>
<a name="l00375"></a>00375 <span class="keyword">  </span>{
<a name="l00376"></a>00376     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>;
<a name="l00377"></a>00377   }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00380"></a><a class="code" href="classBALL_1_1TFFT1D.html#a2179695e7bb9213c3b3acfb276961ca6">00380</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a2179695e7bb9213c3b3acfb276961ca6">TFFT1D&lt;ComplexTraits&gt;::getPhysSpaceMin</a>()<span class="keyword"> const</span>
<a name="l00381"></a>00381 <span class="keyword">  </span>{
<a name="l00382"></a>00382     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#aa11b7e3e70f2deb12168ef8979041ae8">minPhys_</a>;
<a name="l00383"></a>00383   }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00386"></a><a class="code" href="classBALL_1_1TFFT1D.html#ae5170727eecdcc1400edd3f0b42b3a0c">00386</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae5170727eecdcc1400edd3f0b42b3a0c">TFFT1D&lt;ComplexTraits&gt;::getPhysSpaceMax</a>()<span class="keyword"> const</span>
<a name="l00387"></a>00387 <span class="keyword">  </span>{
<a name="l00388"></a>00388     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#ae007f6685e3e1ff230106be1ceeef040">maxPhys_</a>;
<a name="l00389"></a>00389   }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00392"></a><a class="code" href="classBALL_1_1TFFT1D.html#a814534b61e594187c4ac85bd324df363">00392</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#a814534b61e594187c4ac85bd324df363">TFFT1D&lt;ComplexTraits&gt;::getFourierSpaceMin</a>()<span class="keyword"> const</span>
<a name="l00393"></a>00393 <span class="keyword">  </span>{
<a name="l00394"></a>00394     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#abea003891ed52da30b80ab1a656df97b">minFourier_</a>;
<a name="l00395"></a>00395   }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00398"></a><a class="code" href="classBALL_1_1TFFT1D.html#af87d84bd442a5ed0a5e240228b403bf9">00398</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#af87d84bd442a5ed0a5e240228b403bf9">TFFT1D&lt;ComplexTraits&gt;::getFourierSpaceMax</a>()<span class="keyword"> const</span>
<a name="l00399"></a>00399 <span class="keyword">  </span>{
<a name="l00400"></a>00400     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#aab22646c8ebb0c0853c047ef25dec6e3">maxFourier_</a>;
<a name="l00401"></a>00401   }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt; 
<a name="l00404"></a><a class="code" href="classBALL_1_1TFFT1D.html#af7637fdb8b6a3bfa7dc5fa78d7dfd656">00404</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#af7637fdb8b6a3bfa7dc5fa78d7dfd656">TFFT1D&lt;ComplexTraits&gt;::getMaxIndex</a>()<span class="keyword"> const</span>
<a name="l00405"></a>00405 <span class="keyword">  </span>{
<a name="l00406"></a>00406     <span class="keywordflow">return</span> (<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a> - 1);
<a name="l00407"></a>00407   }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt; 
<a name="l00410"></a><a class="code" href="classBALL_1_1TFFT1D.html#ad6cf91724d3b7428d20a5f439d89c05e">00410</a>   <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> <a class="code" href="classBALL_1_1TFFT1D.html#ad6cf91724d3b7428d20a5f439d89c05e">TFFT1D&lt;ComplexTraits&gt;::getNumberOfInverseTransforms</a>()<span class="keyword"> const</span>
<a name="l00411"></a>00411 <span class="keyword">  </span>{
<a name="l00412"></a>00412     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#a21cadf06172337a36fa88156849d6aa2">numFourierToPhys_</a>;
<a name="l00413"></a>00413   }
<a name="l00414"></a>00414   
<a name="l00415"></a>00415   <span class="comment">// AR: new </span>
<a name="l00416"></a>00416   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00417"></a><a class="code" href="classBALL_1_1TFFT1D.html#ac0e073426e3763ef45d27f44f545c7c9">00417</a>   <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ac0e073426e3763ef45d27f44f545c7c9">TFFT1D&lt;ComplexTraits&gt;::getGridCoordinates</a>(<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> position)<span class="keyword"> const</span>
<a name="l00418"></a>00418 <span class="keyword">  </span>{
<a name="l00419"></a>00419     <span class="keywordflow">if</span> (!<a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a>)
<a name="l00420"></a>00420     {
<a name="l00421"></a>00421       <span class="keywordflow">if</span> (position &gt;= <a class="code" href="classBALL_1_1TRegularData1D.html#a9498bf284e18b347ef171e76d9910cd5">ComplexVector::size</a>())
<a name="l00422"></a>00422       {
<a name="l00423"></a>00423         <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00424"></a>00424       }
<a name="l00425"></a>00425     
<a name="l00426"></a>00426       <span class="keywordtype">double</span> r;
<a name="l00427"></a>00427       
<a name="l00428"></a>00428       r = -<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a> + (<a class="code" href="classfloat.html">float</a>)position * <a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430       <span class="keywordflow">return</span> r;
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432     <span class="keywordflow">else</span>
<a name="l00433"></a>00433     {
<a name="l00434"></a>00434       <span class="keywordflow">if</span> (position &gt;= <a class="code" href="classBALL_1_1TRegularData1D.html#a9498bf284e18b347ef171e76d9910cd5">ComplexVector::size</a>())
<a name="l00435"></a>00435       {
<a name="l00436"></a>00436         <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00437"></a>00437       }
<a name="l00438"></a>00438     
<a name="l00439"></a>00439       <span class="keywordtype">double</span> r;
<a name="l00440"></a>00440       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> x;
<a name="l00441"></a>00441   
<a name="l00442"></a>00442       x = position;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444       <span class="keywordflow">if</span> (x&gt;=<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>/2.)
<a name="l00445"></a>00445       {
<a name="l00446"></a>00446         x-=<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>;
<a name="l00447"></a>00447       }
<a name="l00448"></a>00448       
<a name="l00449"></a>00449       r = (<a class="code" href="classfloat.html">float</a>)x * <a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451       <span class="keywordflow">return</span> r;
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453   }
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00456"></a><a class="code" href="classBALL_1_1TFFT1D.html#a67d701b55f3dc294f80f4c07ff0cc8f7">00456</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">TFFT1D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#a67d701b55f3dc294f80f4c07ff0cc8f7">TFFT1D&lt;ComplexTraits&gt;::getData</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos) <span class="keyword">const</span>
<a name="l00457"></a>00457     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00458"></a>00458   {
<a name="l00459"></a>00459     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> result;
<a name="l00460"></a>00460     <span class="keywordtype">double</span> normalization=1.;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00463"></a>00463     {
<a name="l00464"></a>00464       result = (*this)[pos];<span class="comment">//Complex((*this)[pos].real(), (*this)[pos].imag());</span>
<a name="l00465"></a>00465       normalization=1./pow((<span class="keywordtype">double</span>)length_,(<span class="keywordtype">int</span>)numFourierToPhys_);
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467     <span class="keywordflow">else</span>
<a name="l00468"></a>00468     {
<a name="l00469"></a>00469       result = (*this)[pos]*phase(pos);<span class="comment">//Complex((*this)[pos].real(),(*this)[pos].imag()) * phase(pos);</span>
<a name="l00470"></a>00470       <span class="comment">//Log.error() &lt;&lt; pos &lt;&lt;  &quot; &quot; &lt;&lt; phase(pos).real() &lt;&lt;  std::endl;</span>
<a name="l00471"></a>00471       normalization=1./(sqrt(2.*M_PI))/pow((<span class="keywordtype">double</span>)length_,(int)numFourierToPhys_);
<a name="l00472"></a>00472     }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474     result *= normalization;
<a name="l00475"></a>00475     
<a name="l00476"></a>00476     <span class="keywordflow">return</span> result;
<a name="l00477"></a>00477   }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00480"></a><a class="code" href="classBALL_1_1TFFT1D.html#a454334aaecbf0d965a4a72d5fb232934">00480</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">TFFT1D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#a454334aaecbf0d965a4a72d5fb232934">TFFT1D&lt;ComplexTraits&gt;::getInterpolatedValue</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos) <span class="keyword">const</span>
<a name="l00481"></a>00481     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00482"></a>00482   {
<a name="l00483"></a>00483     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> result;
<a name="l00484"></a>00484     
<a name="l00485"></a>00485     <span class="keywordtype">double</span> <a class="code" href="group__MathsCommon.html#ga48cc5e26e859eca3082fc4ee4be51fa9">min</a>  = inFourierSpace_ ? minFourier_  :  minPhys_;
<a name="l00486"></a>00486     <span class="keywordtype">double</span> <a class="code" href="group__MathsCommon.html#ga7454a5315c85deffac5ab82b40185c7a">max</a>  = inFourierSpace_ ? maxFourier_  :  maxPhys_;
<a name="l00487"></a>00487     <span class="keywordtype">double</span> step = inFourierSpace_ ? stepFourier_ : stepPhys_;
<a name="l00488"></a>00488     
<a name="l00489"></a>00489     <span class="keywordflow">if</span> ((pos &lt; min) || (pos &gt; max))
<a name="l00490"></a>00490     {
<a name="l00491"></a>00491       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="keywordtype">double</span> <a class="code" href="namespaceBALL_1_1Constants.html#a4dd9a265fa2bfc6417cabda1b3c1a0b5">h</a> = pos - min;
<a name="l00495"></a>00495     <span class="keywordtype">double</span> mod = fmod(h,step);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (mod ==0) <span class="comment">// we are on the grid</span>
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499       <span class="keywordflow">return</span> getData(pos);
<a name="l00500"></a>00500     }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="keywordtype">double</span> before = <a class="code" href="group__MathsCommon.html#gabb631d8f284308c9fa8247dd6b549af0">floor</a>(h/step)*step+ min;
<a name="l00503"></a>00503     <span class="keywordtype">double</span> after  = ceil(h/step)*step+ min;
<a name="l00504"></a>00504       
<a name="l00505"></a>00505     <span class="keywordtype">double</span> t = (pos - before)/step;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     result  =  getData(before)*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(1.-t);
<a name="l00508"></a>00508     result +=  getData(after)*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)t; 
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="keywordflow">return</span> result;
<a name="l00511"></a>00511   }
<a name="l00512"></a>00512 
<a name="l00513"></a>00513   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00514"></a><a class="code" href="classBALL_1_1TFFT1D.html#a3d84fc21a7f00a8aa428423023a863a1">00514</a>   <span class="keywordtype">void</span> <a class="code" href="classBALL_1_1TFFT1D.html#a3d84fc21a7f00a8aa428423023a863a1">TFFT1D&lt;ComplexTraits&gt;::setData</a>(<span class="keywordtype">double</span> pos, <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> val)
<a name="l00515"></a>00515     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00516"></a>00516   {
<a name="l00517"></a>00517     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> dummy;
<a name="l00518"></a>00518     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00519"></a>00519     {
<a name="l00520"></a>00520       dummy = <a class="code" href="namespaceBALL.html#ae9f52d0eb4d93b3ed3464538a4a96989">Complex</a>(val.real()*((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(length_),(<span class="keywordtype">int</span>)numFourierToPhys_)),
<a name="l00521"></a>00521                        val.imag()*((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)(length_),(<span class="keywordtype">int</span>)numFourierToPhys_)));
<a name="l00522"></a>00522   
<a name="l00523"></a>00523       (*this)[pos]=dummy;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525     <span class="keywordflow">else</span>
<a name="l00526"></a>00526     {
<a name="l00527"></a>00527       val*=phase(pos)*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)((sqrt(2*M_PI)/stepPhys_))
<a name="l00528"></a>00528                      *(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)pow((<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)length_,(<span class="keywordtype">int</span>)numFourierToPhys_);
<a name="l00529"></a>00529       
<a name="l00530"></a>00530       dummy = val;
<a name="l00531"></a>00531       
<a name="l00532"></a>00532       (*this)[pos]=dummy;
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534   }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00537"></a><a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">00537</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">TFFT1D&lt;ComplexTraits&gt;::Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">TFFT1D&lt;ComplexTraits&gt;::operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos) 
<a name="l00538"></a>00538     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00539"></a>00539   {
<a name="l00540"></a>00540     <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> internalPos;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00543"></a>00543     {
<a name="l00544"></a>00544       internalPos = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>((pos+origin_)/stepPhys_);
<a name="l00545"></a>00545     }
<a name="l00546"></a>00546     <span class="keywordflow">else</span>
<a name="l00547"></a>00547     {
<a name="l00548"></a>00548       internalPos =  (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>(pos/stepFourier_);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550       <span class="keywordflow">if</span> (internalPos &lt; 0)
<a name="l00551"></a>00551       {
<a name="l00552"></a>00552         internalPos+=length_;
<a name="l00553"></a>00553       }
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <span class="keywordflow">if</span> ((internalPos &lt; 0) || (internalPos&gt;=(<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) length_))
<a name="l00557"></a>00557     {
<a name="l00558"></a>00558       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     
<a name="l00561"></a>00561     <span class="keywordflow">return</span> operator [] (internalPos);
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00565"></a><a class="code" href="classBALL_1_1TFFT1D.html#a2254bdcd589adac5ce00ac33d8fafb02">00565</a>   <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">TFFT1D&lt;ComplexTraits&gt;::Complex</a>&amp; <a class="code" href="classBALL_1_1TFFT1D.html#ac40241f8fdab950b4a691fee999e7496">TFFT1D&lt;ComplexTraits&gt;::operator[]</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos) <span class="keyword">const</span>
<a name="l00566"></a>00566     <span class="keywordflow">throw</span>(<a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>)
<a name="l00567"></a>00567   {
<a name="l00568"></a>00568     <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> internalPos;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     <span class="keywordflow">if</span> (!inFourierSpace_)
<a name="l00571"></a>00571     {
<a name="l00572"></a>00572       internalPos = (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>((pos+origin_)/stepPhys_);
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574     <span class="keywordflow">else</span>
<a name="l00575"></a>00575     {
<a name="l00576"></a>00576       internalPos =  (<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) <a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>(pos/stepFourier_);
<a name="l00577"></a>00577 
<a name="l00578"></a>00578       <span class="keywordflow">if</span> (internalPos &lt; 0)
<a name="l00579"></a>00579       {
<a name="l00580"></a>00580         internalPos+=length_;
<a name="l00581"></a>00581       }
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="keywordflow">if</span> ((internalPos &lt; 0) || (internalPos&gt;=(<a class="code" href="classBALL__INDEX__TYPE.html">Index</a>) length_))
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586       <span class="keywordflow">throw</span> <a class="code" href="classBALL_1_1Exception_1_1OutOfGrid.html">Exception::OutOfGrid</a>(__FILE__, __LINE__);
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588     
<a name="l00589"></a>00589     <span class="keywordflow">return</span> operator [] (internalPos);
<a name="l00590"></a>00590   }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00593"></a><a class="code" href="classBALL_1_1TFFT1D.html#ace038daa8ea5b5c39d9c0cb9d3c0a3b1">00593</a>   <span class="keyword">typename</span> <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">TFFT1D&lt;ComplexTraits&gt;::Complex</a> <a class="code" href="classBALL_1_1TFFT1D.html#ace038daa8ea5b5c39d9c0cb9d3c0a3b1">TFFT1D&lt;ComplexTraits&gt;::phase</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pos)<span class="keyword"> const</span>
<a name="l00594"></a>00594 <span class="keyword">  </span>{
<a name="l00595"></a>00595     <span class="keywordtype">double</span> <a class="code" href="classBALL_1_1TFFT1D.html#ace038daa8ea5b5c39d9c0cb9d3c0a3b1">phase</a> = 2.*M_PI*(<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>(pos/<a class="code" href="classBALL_1_1TFFT1D.html#ab72905a40c634689b46cd18c9b43fc3e">stepFourier_</a>))
<a name="l00596"></a>00596                          *(<a class="code" href="group__MathsCommon.html#gaa3ca210fe911129edaeb7a88fc13158f" title="round to integral value in floating-point format">rint</a>(<a class="code" href="classBALL_1_1TFFT1D.html#a6ad91310f05472d0f70fc7aecfb7534d" title="The origin of the data set.">origin_</a>/<a class="code" href="classBALL_1_1TFFT1D.html#a8712cd53412615be66c8db43db059fc8">stepPhys_</a>))
<a name="l00597"></a>00597                          /<a class="code" href="classBALL_1_1TFFT1D.html#a05a68635e8e76defeec00a2cb859dd01">length_</a>;
<a name="l00598"></a>00598     <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a> result = <a class="code" href="classBALL_1_1TFFT1D.html#a32d4c7e458c2213cdf2971a8767fbd49">Complex</a>(cos(phase), sin(phase));
<a name="l00599"></a>00599             
<a name="l00600"></a>00600     <span class="keywordflow">return</span> result;
<a name="l00601"></a>00601   }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00604"></a><a class="code" href="classBALL_1_1TFFT1D.html#a75784f470a5078e65a5abeb8ba0e269f">00604</a>   <span class="keywordtype">bool</span> <a class="code" href="classBALL_1_1TFFT1D.html#a75784f470a5078e65a5abeb8ba0e269f">TFFT1D&lt;ComplexTraits&gt;::isInFourierSpace</a>()<span class="keyword"> const</span>
<a name="l00605"></a>00605 <span class="keyword">  </span>{
<a name="l00606"></a>00606     <span class="keywordflow">return</span> <a class="code" href="classBALL_1_1TFFT1D.html#a4fddced099c0b65fbc51671446e531b6">inFourierSpace_</a>;
<a name="l00607"></a>00607   }
<a name="l00608"></a>00608 <span class="comment">/*  </span>
<a name="l00609"></a>00609 <span class="comment">  const TRegularData1D&lt;Complex &gt;&amp; operator &lt;&lt; (TRegularData1D&lt;Complex &gt;&amp; to, const TFFT1D&lt;ComplexTraits&gt;&amp; from)</span>
<a name="l00610"></a>00610 <span class="comment">  {</span>
<a name="l00611"></a>00611 <span class="comment">    // first decide if the TFFT1D data is in Fourier space.</span>
<a name="l00612"></a>00612 <span class="comment">    if (!from.isInFourierSpace())</span>
<a name="l00613"></a>00613 <span class="comment">    {</span>
<a name="l00614"></a>00614 <span class="comment">      // create a new grid</span>
<a name="l00615"></a>00615 <span class="comment">      Size lengthX = from.getMaxIndex()+1;</span>
<a name="l00616"></a>00616 <span class="comment">      </span>
<a name="l00617"></a>00617 <span class="comment">      TRegularData1D&lt;Complex &gt; newGrid(TRegularData1D&lt;Complex &gt;::IndexType(lengthX), from.getPhysSpaceMin(), from.getPhysSpaceMax());</span>
<a name="l00618"></a>00618 <span class="comment"></span>
<a name="l00619"></a>00619 <span class="comment">      // and fill it</span>
<a name="l00620"></a>00620 <span class="comment">      double normalization=1./(pow((float)(lengthX),from.getNumberOfInverseTransforms()));</span>
<a name="l00621"></a>00621 <span class="comment">      </span>
<a name="l00622"></a>00622 <span class="comment">      for (Position i = 0; i &lt; from.size(); i++)</span>
<a name="l00623"></a>00623 <span class="comment">      {</span>
<a name="l00624"></a>00624 <span class="comment">        newGrid[i] = from[i]*(ComplexTraits::ComplexPrecision)normalization;</span>
<a name="l00625"></a>00625 <span class="comment">      }</span>
<a name="l00626"></a>00626 <span class="comment"></span>
<a name="l00627"></a>00627 <span class="comment">      to = newGrid;</span>
<a name="l00628"></a>00628 <span class="comment"></span>
<a name="l00629"></a>00629 <span class="comment">      return to;</span>
<a name="l00630"></a>00630 <span class="comment">    }</span>
<a name="l00631"></a>00631 <span class="comment">    else</span>
<a name="l00632"></a>00632 <span class="comment">    {</span>
<a name="l00633"></a>00633 <span class="comment">      // we are in Fourier space</span>
<a name="l00634"></a>00634 <span class="comment">      </span>
<a name="l00635"></a>00635 <span class="comment">      // create a new grid</span>
<a name="l00636"></a>00636 <span class="comment">      Size lengthX = from.getMaxIndex()+1;</span>
<a name="l00637"></a>00637 <span class="comment">      //float stepPhysX = from.getPhysStepWidthX();</span>
<a name="l00638"></a>00638 <span class="comment">      float stepFourierX = from.getFourierStepWidth();</span>
<a name="l00639"></a>00639 <span class="comment"></span>
<a name="l00640"></a>00640 <span class="comment">      </span>
<a name="l00641"></a>00641 <span class="comment">      TRegularData1D&lt;Complex &gt; newGrid(TRegularData1D&lt;Complex &gt;::IndexType(lengthX),</span>
<a name="l00642"></a>00642 <span class="comment">                                      from.getFourierSpaceMin(), </span>
<a name="l00643"></a>00643 <span class="comment">                                      from.getFourierSpaceMax());</span>
<a name="l00644"></a>00644 <span class="comment"></span>
<a name="l00645"></a>00645 <span class="comment">      // and fill it</span>
<a name="l00646"></a>00646 <span class="comment">      // AR: old double normalization=1./(sqrt(2.*M_PI))*(stepPhysX*stepPhysY*stepPhysZ)/(pow((float)(lengthX*lengthY*lengthZ),from.getNumberOfInverseTransforms()));</span>
<a name="l00647"></a>00647 <span class="comment">      double normalization=1./sqrt(2.*M_PI)/(pow((float)(lengthX),from.getNumberOfInverseTransforms()));</span>
<a name="l00648"></a>00648 <span class="comment">      </span>
<a name="l00649"></a>00649 <span class="comment">      </span>
<a name="l00650"></a>00650 <span class="comment">      Index x;</span>
<a name="l00651"></a>00651 <span class="comment">      float r;</span>
<a name="l00652"></a>00652 <span class="comment">  </span>
<a name="l00653"></a>00653 <span class="comment">      for (Position i = 0; i &lt; from.size(); i++)</span>
<a name="l00654"></a>00654 <span class="comment">      {</span>
<a name="l00655"></a>00655 <span class="comment">        x = i;</span>
<a name="l00656"></a>00656 <span class="comment"></span>
<a name="l00657"></a>00657 <span class="comment">        if (x&gt;lengthX/2.)</span>
<a name="l00658"></a>00658 <span class="comment">        {</span>
<a name="l00659"></a>00659 <span class="comment">          x-=lengthX;</span>
<a name="l00660"></a>00660 <span class="comment">        }</span>
<a name="l00661"></a>00661 <span class="comment"></span>
<a name="l00662"></a>00662 <span class="comment">        r = (float)x * stepFourierX;</span>
<a name="l00663"></a>00663 <span class="comment"></span>
<a name="l00664"></a>00664 <span class="comment">        newGrid[i] = from[i]*(ComplexTraits::ComplexPrecision)normalization*from.phase(r);</span>
<a name="l00665"></a>00665 <span class="comment">      }</span>
<a name="l00666"></a>00666 <span class="comment"></span>
<a name="l00667"></a>00667 <span class="comment">      to = newGrid;</span>
<a name="l00668"></a>00668 <span class="comment"></span>
<a name="l00669"></a>00669 <span class="comment">      return to;</span>
<a name="l00670"></a>00670 <span class="comment">    }</span>
<a name="l00671"></a>00671 <span class="comment">  }</span>
<a name="l00672"></a>00672 <span class="comment">  */</span>
<a name="l00673"></a>00673   
<a name="l00674"></a>00674   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ComplexTraits&gt;
<a name="l00675"></a><a class="code" href="namespaceBALL.html#a9622b65bb20d5246d42ea045eec9fe7c">00675</a>   <span class="keyword">const</span> <a class="code" href="classBALL_1_1TRegularData1D.html">RegularData1D</a>&amp; operator &lt;&lt; (RegularData1D&amp; to, const TFFT1D&lt;ComplexTraits&gt;&amp; from)
<a name="l00676"></a>00676   {
<a name="l00677"></a>00677     <span class="comment">// first decide if the FFT1D data is in Fourier space.</span>
<a name="l00678"></a>00678     <span class="keywordflow">if</span> (!from.isInFourierSpace())
<a name="l00679"></a>00679     {
<a name="l00680"></a>00680       <span class="comment">// create a new grid</span>
<a name="l00681"></a>00681       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthX = from.getMaxIndex()+1;
<a name="l00682"></a>00682       
<a name="l00683"></a>00683       <a class="code" href="classBALL_1_1TRegularData1D.html">RegularData1D</a> newGrid(lengthX);
<a name="l00684"></a>00684       newGrid.<a class="code" href="classBALL_1_1TRegularData1D.html#a8becd1e528440feb1380f92bea17f1fe">setOrigin</a>(from.getPhysSpaceMin());
<a name="l00685"></a>00685       newGrid.<a class="code" href="classBALL_1_1TRegularData1D.html#a6d1e23a5679f7cc29d64756a395d2c0b">setDimension</a>(from.getPhysSpaceMax()-from.getPhysSpaceMin());
<a name="l00686"></a>00686 
<a name="l00687"></a>00687       <span class="comment">// and fill it</span>
<a name="l00688"></a>00688       <span class="keywordtype">double</span> normalization = 1./(pow((<span class="keywordtype">float</span>)(lengthX),from.getNumberOfInverseTransforms()));
<a name="l00689"></a>00689       
<a name="l00690"></a>00690       <span class="keywordflow">for</span> (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l00691"></a>00691       {
<a name="l00692"></a>00692         newGrid[i] = from[i].real()*normalization;
<a name="l00693"></a>00693       }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695       to = newGrid;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697       <span class="keywordflow">return</span> to;
<a name="l00698"></a>00698     }
<a name="l00699"></a>00699     <span class="keywordflow">else</span>
<a name="l00700"></a>00700     {
<a name="l00701"></a>00701       <span class="comment">// we are in Fourier space</span>
<a name="l00702"></a>00702       
<a name="l00703"></a>00703       <span class="comment">// create a new grid</span>
<a name="l00704"></a>00704       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> lengthX = from.getMaxIndex()+1;
<a name="l00705"></a>00705       <span class="comment">//float stepPhysX = from.getPhysStepWidth();</span>
<a name="l00706"></a>00706       <span class="keywordtype">float</span> stepFourierX = from.getFourierStepWidth();
<a name="l00707"></a>00707 
<a name="l00708"></a>00708       <a class="code" href="classBALL_1_1TRegularData1D.html">RegularData1D</a> newGrid(lengthX);
<a name="l00709"></a>00709       newGrid.<a class="code" href="classBALL_1_1TRegularData1D.html#a8becd1e528440feb1380f92bea17f1fe">setOrigin</a>(from.getFourierSpaceMin());
<a name="l00710"></a>00710       newGrid.<a class="code" href="classBALL_1_1TRegularData1D.html#a6d1e23a5679f7cc29d64756a395d2c0b">setDimension</a>(from.getFourierSpaceMax()-from.getFourierSpaceMin());
<a name="l00711"></a>00711 
<a name="l00712"></a>00712       <span class="comment">// and fill it</span>
<a name="l00713"></a>00713       <span class="comment">// AR: old version double normalization=1./(sqrt(2.*M_PI))*(stepPhysX*stepPhysY*stepPhysZ)/(pow((float)(lengthX*lengthY*lengthZ),from.getNumberOfInverseTransforms()));</span>
<a name="l00714"></a>00714       <span class="keywordtype">double</span> normalization=1./sqrt(2.*M_PI)/(pow((<span class="keywordtype">float</span>)(lengthX),from.getNumberOfInverseTransforms()));
<a name="l00715"></a>00715       
<a name="l00716"></a>00716       <a class="code" href="classBALL__INDEX__TYPE.html">Index</a> x;
<a name="l00717"></a>00717       <span class="keywordtype">signed</span> <span class="keywordtype">int</span> xp;
<a name="l00718"></a>00718       <span class="keywordtype">float</span> r;
<a name="l00719"></a>00719   
<a name="l00720"></a>00720       <span class="keywordflow">for</span> (<a class="code" href="classBALL__SIZE__TYPE.html">Position</a> i = 0; i &lt; from.size(); i++)
<a name="l00721"></a>00721       {
<a name="l00722"></a>00722         x =  i;
<a name="l00723"></a>00723         
<a name="l00724"></a>00724         xp = x;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726         <span class="keywordflow">if</span> (xp&gt;=lengthX/2.)
<a name="l00727"></a>00727         {
<a name="l00728"></a>00728           xp-=(int)lengthX;
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731         <span class="keywordflow">if</span> (x&gt;=lengthX/2.)
<a name="l00732"></a>00732         {
<a name="l00733"></a>00733           x-=(int)(lengthX/2.);
<a name="l00734"></a>00734         }
<a name="l00735"></a>00735         <span class="keywordflow">else</span>
<a name="l00736"></a>00736         {
<a name="l00737"></a>00737           x+=(int)(lengthX/2.);
<a name="l00738"></a>00738         }
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         r = ((<a class="code" href="classfloat.html">float</a>)xp * stepFourierX);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         newGrid[i] = (from[i]*(<span class="keyword">typename</span> ComplexTraits::ComplexPrecision)normalization*from.phase(r)).real();
<a name="l00744"></a>00744       }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746       to = newGrid;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748       <span class="keywordflow">return</span> to;
<a name="l00749"></a>00749     }
<a name="l00750"></a>00750   }
<a name="l00751"></a>00751 }
<a name="l00752"></a>00752 <span class="preprocessor">#endif // BALL_MATHS_TFFT1D_H</span>
</pre></div></div>
</div>
</body>
</html>
