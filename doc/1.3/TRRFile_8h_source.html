<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
<h1>TRRFile.h</h1><a href="TRRFile_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++; tab-width: 2; -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vi: set ts=2:</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// $Id: TRRFile.h,v 1.13 2005/12/23 17:01:45 amoll Exp $</span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef BALL_FORMAT_TRRFILE_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define BALL_FORMAT_TRRFILE_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef BALL_FORMAT_TRAJECTORYFILE_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="trajectoryFile_8h.html">BALL/FORMAT/trajectoryFile.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="keyword">namespace </span>BALL
<a name="l00015"></a>00015 {
<a name="l00026"></a><a class="code" href="classBALL_1_1TRRFile.html">00026</a>   <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1TRRFile.html">TRRFile</a>
<a name="l00027"></a>00027     : <span class="keyword">public</span> <a class="code" href="classBALL_1_1TrajectoryFile.html">TrajectoryFile</a>
<a name="l00028"></a>00028   {
<a name="l00029"></a>00029 
<a name="l00030"></a>00030     <span class="keyword">public</span>:
<a name="l00031"></a>00031 
<a name="l00035"></a>00035 
<a name="l00042"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html">00042</a>     <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html">TRRHeader</a>
<a name="l00043"></a>00043     {
<a name="l00044"></a>00044 
<a name="l00045"></a>00045       <span class="keyword">public</span>: 
<a name="l00046"></a>00046 
<a name="l00048"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ad19254928d8f605d42af27f72971f6a3">00048</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        MAGIC;
<a name="l00050"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ae734120fdb1bebd7f20583158afa64b5">00050</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        VERSION;
<a name="l00052"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a6f6ce3c53bd77599efa75f56b5ea4e56">00052</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        title_string_length;
<a name="l00054"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a9aa52ace44c21ac5ae7ca0f93f8acfff">00054</a>       <a class="code" href="classBALL_1_1String.html">String</a>      title_string;
<a name="l00058"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a4e674a99bbe809fb6ba94fe1351728c0">00058</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        ir_size;
<a name="l00062"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a72080562474682ecc287556d8a1efc57">00062</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        e_size;
<a name="l00063"></a>00063 
<a name="l00070"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a8cab997c7b838a810e0dbf354b0058c7">00070</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        bounding_box_data_size;
<a name="l00071"></a>00071 
<a name="l00076"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a8c30e3d6a93e576adaf96cfb44c7a782">00076</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        vir_size;
<a name="l00077"></a>00077 
<a name="l00082"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a3a5495656e3589ffe0f69dab2f6c477f">00082</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        pres_size;
<a name="l00083"></a>00083 
<a name="l00087"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#acdea5eabea76254dea632e0e9fbc934f">00087</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        top_size;
<a name="l00088"></a>00088 
<a name="l00092"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ae96c37706e62b2445a8e6ac7f310402a">00092</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        sym_size;
<a name="l00093"></a>00093 
<a name="l00097"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a87e48c077aa2be0cdabd91bcd4452f11">00097</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        position_data_size;
<a name="l00098"></a>00098 
<a name="l00103"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a3940af985086a050a5a7e327ef4bf577">00103</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        velocity_data_size;
<a name="l00104"></a>00104 
<a name="l00109"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a91a217e9944599da45bd1fd6c3563255">00109</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        force_data_size;
<a name="l00110"></a>00110 
<a name="l00113"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ac2872a2a1ac02cd4d0059b10b2c99fcc">00113</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        number_of_atoms;
<a name="l00114"></a>00114 
<a name="l00117"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#a19effdc5c390c6da47a710b6dd9b0d8f">00117</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        timestep_index;
<a name="l00118"></a>00118 
<a name="l00122"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ac30beed735b099493ab5c5273c472fae">00122</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a>        nre;
<a name="l00123"></a>00123 
<a name="l00126"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#ad944642e48964b1e830ad3e1ea74b49b">00126</a>       <span class="keywordtype">float</span>       timestep_time;
<a name="l00127"></a>00127 
<a name="l00131"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#adb65255cb214b3a4852f360f236d6390">00131</a>       <span class="keywordtype">float</span>       lambda;
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html#aab54daf1f403e4ad91f5070321fa48d3">00133</a>       <a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html">TRRHeader</a>()
<a name="l00134"></a>00134         
<a name="l00135"></a>00135         : MAGIC(1993),
<a name="l00136"></a>00136           VERSION(13),
<a name="l00137"></a>00137           title_string_length(24),
<a name="l00138"></a>00138           title_string(<span class="stringliteral">&quot;Created by BALL::TRRFile&quot;</span>),
<a name="l00139"></a>00139           ir_size(0),
<a name="l00140"></a>00140           e_size(0),
<a name="l00141"></a>00141           vir_size(0),
<a name="l00142"></a>00142           pres_size(0),
<a name="l00143"></a>00143           top_size(0),
<a name="l00144"></a>00144           sym_size(0),
<a name="l00145"></a>00145           velocity_data_size(0),
<a name="l00146"></a>00146           force_data_size(0),
<a name="l00147"></a>00147           timestep_index(0),
<a name="l00148"></a>00148           nre(0),
<a name="l00149"></a>00149           timestep_time(0.002),
<a name="l00150"></a>00150           lambda(0)
<a name="l00151"></a>00151       {
<a name="l00152"></a>00152       }
<a name="l00153"></a>00153     };
<a name="l00154"></a>00154 
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <a class="code" href="group__Common.html#ga84998f74fd7a58cecfcbb81d48b4323b">BALL_CREATE</a>(<a class="code" href="classBALL_1_1TRRFile.html">TRRFile</a>)
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     
<a name="l00162"></a>00162 
<a name="l00164"></a>00164     <a class="code" href="classBALL_1_1TRRFile.html">TRRFile</a>() ;
<a name="l00165"></a>00165 
<a name="l00167"></a>00167     TRRFile(const TRRFile&amp; file) throw(Exception::FileNotFound);
<a name="l00168"></a>00168 
<a name="l00170"></a>00170     TRRFile(const <a class="code" href="classBALL_1_1String.html">String</a>&amp; name, <a class="code" href="classBALL_1_1File.html">File</a>::OpenMode open_mode = std::ios::in) ;
<a name="l00171"></a>00171 
<a name="l00173"></a>00173     virtual ~TRRFile() ;
<a name="l00175"></a>00175 
<a name="l00179"></a>00179 
<a name="l00181"></a>00181     const TRRFile&amp; operator = (const TRRFile&amp; file) ;
<a name="l00182"></a>00182 
<a name="l00184"></a>00184     virtual <span class="keywordtype">void</span> clear() ;
<a name="l00186"></a>00186 
<a name="l00190"></a>00190 
<a name="l00192"></a>00192     <span class="keywordtype">bool</span> operator == (const TRRFile&amp; file) const ;
<a name="l00194"></a>00194 
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 
<a name="l00199"></a>00199     virtual <span class="keywordtype">bool</span> init() ;
<a name="l00200"></a>00200 
<a name="l00206"></a>00206     virtual <span class="keywordtype">bool</span> writeNextHeader(const TRRHeader&amp; header) ;
<a name="l00207"></a>00207 
<a name="l00212"></a>00212     virtual <span class="keywordtype">bool</span> readNextHeader(TRRHeader&amp; header) ;
<a name="l00213"></a>00213     
<a name="l00218"></a>00218     virtual <span class="keywordtype">bool</span> append(const <a class="code" href="classBALL_1_1SnapShot.html">SnapShot</a>&amp; snapshot) ;
<a name="l00219"></a>00219 
<a name="l00224"></a>00224     virtual <span class="keywordtype">bool</span> read(<a class="code" href="classBALL_1_1SnapShot.html">SnapShot</a>&amp; snapshot) ;
<a name="l00225"></a>00225 
<a name="l00227"></a>00227     virtual TRRFile&amp; operator &gt;&gt; (<a class="code" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a>&amp; ssm) ;
<a name="l00228"></a>00228     
<a name="l00231"></a>00231     virtual <span class="keywordtype">bool</span> flushToDisk(const std::vector&lt;<a class="code" href="classBALL_1_1SnapShot.html">SnapShot</a>&gt;&amp; buffer)
<a name="l00232"></a>00232       throw(<a class="code" href="classBALL_1_1File.html">File</a>::CannotWrite);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00238"></a>00238 
<a name="l00240"></a>00240     <span class="keywordtype">bool</span> hasVelocities() const ;
<a name="l00241"></a>00241 
<a name="l00243"></a>00243     <span class="keywordtype">void</span> setVelocityStorage(<span class="keywordtype">bool</span> storage) ;
<a name="l00244"></a>00244 
<a name="l00246"></a>00246     <span class="keywordtype">bool</span> hasForces() const ;
<a name="l00247"></a>00247 
<a name="l00249"></a>00249     <span class="keywordtype">void</span> setForceStorage(<span class="keywordtype">bool</span> storage) ;
<a name="l00250"></a>00250 
<a name="l00252"></a>00252     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> getPrecision() const ;
<a name="l00253"></a>00253 
<a name="l00255"></a>00255     <span class="keywordtype">bool</span> setPrecision(const <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> precision) ;
<a name="l00256"></a>00256 
<a name="l00258"></a>00258     <span class="keywordtype">float</span> getTimestep() const ;
<a name="l00259"></a>00259 
<a name="l00261"></a>00261     <span class="keywordtype">void</span> setTimestep(<span class="keywordtype">float</span> timestep) ;
<a name="l00262"></a>00262 
<a name="l00264"></a>00264     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> getBoundingBoxX() const ;
<a name="l00265"></a>00265 
<a name="l00267"></a>00267     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> getBoundingBoxY() const ;
<a name="l00268"></a>00268 
<a name="l00270"></a>00270     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> getBoundingBoxZ() const ;
<a name="l00271"></a>00271 
<a name="l00273"></a>00273     <span class="keywordtype">void</span> setBoundingBox(const <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; x, const <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; y, const <a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&amp; z) ;
<a name="l00274"></a>00274 
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     protected:
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     <span class="comment">// the current step&apos;s header</span>
<a name="l00280"></a><a class="code" href="classBALL_1_1TRRFile.html#a92eea73bca0e3d0b9624c58aa285d3c4">00280</a>     <a class="code" href="classBALL_1_1TRRFile_1_1TRRHeader.html">TRRHeader</a> header_;
<a name="l00281"></a>00281     
<a name="l00282"></a>00282     <span class="comment">// the precision of the file in bytes per value</span>
<a name="l00283"></a><a class="code" href="classBALL_1_1TRRFile.html#a453bc85c764e528a1d96830fbb7a614a">00283</a>     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> precision_;
<a name="l00284"></a>00284     
<a name="l00285"></a>00285     <span class="comment">// a flag deciding if the file contains velocities</span>
<a name="l00286"></a><a class="code" href="classBALL_1_1TRRFile.html#a8fe701d5d6bc73ebc923061e32305a50">00286</a>     <span class="keywordtype">bool</span> has_velocities_;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <span class="comment">// a flag deciding if the file contains forces</span>
<a name="l00289"></a><a class="code" href="classBALL_1_1TRRFile.html#a685bb3a07f7a9b705e74c243c7cb59e6">00289</a>     <span class="keywordtype">bool</span> has_forces_;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <span class="comment">// the index of the current timestep / snapshot</span>
<a name="l00292"></a><a class="code" href="classBALL_1_1TRRFile.html#aa2aaec41ab94a19089345d465e7ed3c2">00292</a>     <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> timestep_index_;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="comment">// the length of the timestep</span>
<a name="l00295"></a><a class="code" href="classBALL_1_1TRRFile.html#a8ef35ccdbc5d0c68e77bd7e45a116568">00295</a>     <span class="keywordtype">float</span> timestep_;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     <span class="comment">// three vectors containing the base vectors of the box in</span>
<a name="l00298"></a>00298     <span class="comment">// nanometers</span>
<a name="l00299"></a><a class="code" href="classBALL_1_1TRRFile.html#aea3b996ecd5faa0670792adc7d2da03f">00299</a>     <a class="code" href="classBALL_1_1TVector3.html">Vector3</a> box1_, box2_, box3_;
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="classBALL_1_1TRRFile.html#a267ddddee71c587d0d6887dec313843d">00301</a>     <a class="code" href="classBALL_1_1BinaryFileAdaptor.html">BinaryFileAdaptor</a>&lt;<a class="code" href="classBALL__SIZE__TYPE.html">Size</a>&gt; adapt_size_;
<a name="l00302"></a><a class="code" href="classBALL_1_1TRRFile.html#aae019535563761c4ab743988d11da5d3">00302</a>     <a class="code" href="classBALL_1_1BinaryFileAdaptor.html">BinaryFileAdaptor</a>&lt;<span class="keywordtype">char</span>&gt; adapt_char_;
<a name="l00303"></a><a class="code" href="classBALL_1_1TRRFile.html#ac2dc9c93b18e1d833f43b9d33df26ace">00303</a>     <a class="code" href="classBALL_1_1BinaryFileAdaptor.html">BinaryFileAdaptor</a>&lt;<span class="keywordtype">float</span>&gt; adapt_float_;
<a name="l00304"></a><a class="code" href="classBALL_1_1TRRFile.html#afadc258457192429055e477720cedc43">00304</a>     <a class="code" href="classBALL_1_1BinaryFileAdaptor.html">BinaryFileAdaptor</a>&lt;<span class="keywordtype">double</span>&gt; adapt_double_;
<a name="l00305"></a>00305   };
<a name="l00306"></a>00306 } <span class="comment">// namespace BALL</span>
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="preprocessor">#endif // BALL_FORMAT_TRRFILE_H </span>
</pre></div></div>
</div>
</body>
</html>
