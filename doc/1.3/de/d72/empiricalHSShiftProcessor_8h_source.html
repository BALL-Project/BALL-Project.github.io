<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>BALL: empiricalHSShiftProcessor.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>empiricalHSShiftProcessor.h</h1><a href="../../de/d72/empiricalHSShiftProcessor_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef BALL_NMR_EMPIRICALHSSHIFTPROCESSOR_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define BALL_NMR_EMPIRICALHSSHIFTPROCESSOR_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#ifndef BALL_MATHS_CUBICSPLINE2D_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="../../de/d8a/cubicSpline2D_8h.html">BALL/MATHS/cubicSpline2D.h</a>&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#endif</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span>
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef BALL_MATHS_CUBICSPLINE1D_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="../../da/d5e/cubicSpline1D_8h.html">BALL/MATHS/cubicSpline1D.h</a>&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#endif</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#ifndef BALL_FORMAT_GENERICMOLFILE_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="../../de/db9/genericMolFile_8h.html">BALL/FORMAT/genericMolFile.h</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#endif</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="preprocessor">#ifndef BALL_NMR_SHIFT_MODULE_H</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span><span class="preprocessor"># include&lt;<a class="code" href="../../da/d5e/shiftModule_8h.html">BALL/NMR/shiftModule.h</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#endif</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a>00021 <span class="preprocessor">#ifndef BALL_KERNEL_EXPRESSION_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor"># include&lt;<a class="code" href="../../d3/d1b/expression_8h.html">BALL/KERNEL/expression.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#endif</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#ifndef BALL_DATATYPE_OPTIONS_H</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="../../d7/d5b/options_8h.html">BALL/DATATYPE/options.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#endif</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;set&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="keyword">namespace </span>BALL 
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035   <span class="keyword">class </span><a class="code" href="../../dc/d72/namespaceBALL_1_1PDB.html#a0b90efd02f78a2adb8d2ef346ac30462">Atom</a>;
<a name="l00036"></a>00036     
<a name="l00040"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">00040</a>   <span class="keyword">class </span><a class="code" href="../../d0/d84/COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>
<a name="l00041"></a>00041     : <span class="keyword">public</span> <a class="code" href="../../d0/d0a/classBALL_1_1ShiftModule.html">ShiftModule</a>
<a name="l00042"></a>00042   {
<a name="l00043"></a>00043     <span class="keyword">public</span>:
<a name="l00044"></a>00044 
<a name="l00045"></a>00045     <a class="code" href="../../d1/dc5/group__Common.html#ga84998f74fd7a58cecfcbb81d48b4323b">BALL_CREATE</a>(<a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>)
<a name="l00046"></a>00046     
<a name="l00047"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a6d8ce63c8ee7cec4c45efe29ceb16560">00047</a>     static const <span class="keywordtype">int</span> VERBOSITY_LEVEL_CRITICAL;
<a name="l00048"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a6d9f40a870d5e75214a1a6184781f43a">00048</a>     static const <span class="keywordtype">int</span> VERBOSITY_LEVEL_DEBUG;
<a name="l00049"></a>00049 
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="../../d6/dca/structBALL_1_1EmpiricalHSShiftProcessor_1_1Option.html">00054</a>     struct <a class="code" href="../../d0/d84/COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="../../d6/dca/structBALL_1_1EmpiricalHSShiftProcessor_1_1Option.html" title="Option names.">Option</a>
<a name="l00055"></a>00055     { 
<a name="l00058"></a><a class="code" href="../../d6/dca/structBALL_1_1EmpiricalHSShiftProcessor_1_1Option.html#a426df0d23948dde7847555fd0665a353">00058</a>       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* VERBOSITY;
<a name="l00059"></a>00059       
<a name="l00060"></a>00060     };
<a name="l00061"></a>00061     
<a name="l00063"></a><a class="code" href="../../df/d29/structBALL_1_1EmpiricalHSShiftProcessor_1_1Default.html">00063</a>     <span class="keyword">struct </span><a class="code" href="../../d0/d84/COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="../../df/d29/structBALL_1_1EmpiricalHSShiftProcessor_1_1Default.html" title="Default values for options.">Default</a>
<a name="l00064"></a>00064     {
<a name="l00065"></a><a class="code" href="../../df/d29/structBALL_1_1EmpiricalHSShiftProcessor_1_1Default.html#a8c95a8eb5fb763b0b817eea41b754784">00065</a>       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> VERBOSITY;
<a name="l00066"></a>00066     };
<a name="l00067"></a>00067   
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00074"></a>00074 
<a name="l00078"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a4f7ff14f93a5244ac80aeab4860e068e">00078</a>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* PROPERTY__EHS_SHIFT;
<a name="l00079"></a>00079   
<a name="l00081"></a>00081 
<a name="l00084"></a>00084 
<a name="l00087"></a>00087     <a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>()
<a name="l00088"></a>00088       throw();
<a name="l00089"></a>00089 
<a name="l00092"></a>00092     virtual ~<a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>()
<a name="l00093"></a>00093       throw();  
<a name="l00094"></a>00094 
<a name="l00096"></a>00096 
<a name="l00099"></a>00099   
<a name="l00132"></a>00132     virtual <span class="keywordtype">void</span> init()
<a name="l00133"></a>00133       throw();
<a name="l00134"></a>00134 
<a name="l00136"></a>00136 
<a name="l00139"></a>00139     
<a name="l00145"></a>00145     virtual <span class="keywordtype">bool</span> start()
<a name="l00146"></a>00146       throw();
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 
<a name="l00161"></a>00161     virtual <a class="code" href="../../d0/d9b/classBALL_1_1Processor.html">Processor</a>::Result operator () (<a class="code" href="../../d9/d7e/classBALL_1_1Composite.html">Composite</a>&amp; composite)
<a name="l00162"></a>00162       throw();
<a name="l00163"></a>00163 
<a name="l00181"></a>00181     virtual <span class="keywordtype">bool</span> finish()
<a name="l00182"></a>00182       throw();
<a name="l00183"></a>00183       
<a name="l00185"></a>00185 
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a2df52b5bbe4d2bc9dca2b8652aee111c">00189</a>       <a class="code" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> options;
<a name="l00190"></a>00190 
<a name="l00193"></a>00193       <span class="keywordtype">void</span> setDefaultOptions();
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     protected:
<a name="l00197"></a>00197     
<a name="l00198"></a>00198     
<a name="l00199"></a>00199     <span class="comment">/*_ Neested class providing atom properties for the shift computations </span>
<a name="l00200"></a>00200 <span class="comment">     * */</span> 
<a name="l00201"></a><a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html">00201</a>     class <a class="code" href="../../d0/d84/COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html">PropertiesForShift_</a>
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203       <span class="keyword">public</span>:
<a name="l00204"></a>00204               
<a name="l00207"></a>00207         PropertiesForShift_(<span class="keywordtype">int</span> verbosity_ = <a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a6d8ce63c8ee7cec4c45efe29ceb16560">EmpiricalHSShiftProcessor::VERBOSITY_LEVEL_CRITICAL</a>) 
<a name="l00208"></a>00208           <span class="keywordflow">throw</span>();
<a name="l00209"></a>00209 
<a name="l00212"></a><a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html#a3672a2248dd1d31bf427d4690a2c3a61">00212</a>         <a class="code" href="../../d4/d2c/classBALL_1_1Atom.html">Atom</a>*       current_atom;
<a name="l00213"></a>00213 
<a name="l00230"></a>00230         <span class="keywordtype">bool</span> computeProperties_(<a class="code" href="../../d4/d2c/classBALL_1_1Atom.html">Atom</a>* atom, std::set&lt;String&gt; properties)  <span class="keywordflow">throw</span>();  
<a name="l00231"></a>00231 
<a name="l00243"></a>00243         std::pair&lt;float, String&gt; operator [] (<span class="keyword">const</span> <a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a>&amp; property_name) <span class="keywordflow">throw</span>();
<a name="l00244"></a>00244 
<a name="l00249"></a>00249         <span class="keyword">static</span> <span class="keywordtype">bool</span> isDiscrete(<a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> property) <span class="keywordflow">throw</span>();
<a name="l00250"></a>00250         
<a name="l00254"></a>00254         <span class="keyword">static</span> <span class="keywordtype">bool</span> isMixed(<a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> property) <span class="keywordflow">throw</span>();
<a name="l00255"></a>00255 
<a name="l00256"></a>00256       <span class="keyword">protected</span>:
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         <span class="comment">// Storing the atoms properties </span>
<a name="l00259"></a>00259         <span class="comment">// ...as numerical value</span>
<a name="l00260"></a><a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html#ad15907383ea0bbe3680c09fcd9664103">00260</a>         std::map&lt;String, float&gt;  properties_real_;
<a name="l00261"></a>00261         <span class="comment">// ... as alphanumerical/discrete value</span>
<a name="l00262"></a><a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html#ad2efcf9aba363062354d86ea958db9e2">00262</a>         std::map&lt;String, String&gt; properties_string_;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264       <span class="keyword">protected</span>:
<a name="l00265"></a>00265         
<a name="l00266"></a>00266         <span class="keywordtype">float</span>     getChiAngle_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00267"></a>00267         <span class="keywordtype">float</span>     getChi2Angle_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00268"></a>00268         <span class="keywordtype">char</span>      getAminoAcid_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00269"></a>00269         <span class="keywordtype">char</span>      getSecondaryStructure_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00270"></a>00270         <span class="keywordtype">float</span>     getHA_HBondLen_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00271"></a>00271         <span class="keywordtype">float</span>     getHA2_HBondLen_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00272"></a>00272         <span class="keywordtype">float</span>     getHN_HBondLen_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00273"></a>00273         <span class="keywordtype">float</span>     getO_HBondLen_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00274"></a>00274         <span class="keywordtype">bool</span>      hasDisulfidBond_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00275"></a>00275         <span class="keywordtype">bool</span>      hasHA_HBond_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00276"></a>00276         <span class="keywordtype">bool</span>      hasHA2_HBond_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00277"></a>00277         <span class="keywordtype">bool</span>      hasHN_HBond_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00278"></a>00278         <span class="keywordtype">bool</span>      hasO_HBond_(<a class="code" href="../../d9/d3e/classBALL_1_1Residue.html">Residue</a>* residue) <span class="keywordflow">throw</span>();
<a name="l00279"></a>00279         
<a name="l00280"></a>00280       <span class="keyword">private</span>:
<a name="l00281"></a>00281         <span class="comment">// verbosity of the classes methods</span>
<a name="l00282"></a><a class="code" href="../../da/de9/classBALL_1_1EmpiricalHSShiftProcessor_1_1PropertiesForShift__.html#a441a48ca7a9f1890a0fba65a4b019bc8">00282</a>         <span class="keywordtype">int</span>     verbosity_;
<a name="l00283"></a>00283     }; <span class="comment">// end of nested class</span>
<a name="l00284"></a>00284     
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <span class="comment">/*_ Neested class handling the empirical hypersurfaces. </span>
<a name="l00287"></a>00287 <span class="comment">     **/</span>
<a name="l00288"></a>00288     
<a name="l00289"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">00289</a>     <span class="keyword">class </span><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">ShiftHyperSurface_</a>
<a name="l00290"></a>00290     {
<a name="l00291"></a>00291       <span class="keyword">public</span>:
<a name="l00292"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a2cf5f41e5372c687e0672561ed450bce">00292</a>         <span class="keyword">typedef</span> std::map&lt;String, std::map&lt;String, float&gt; &gt; <a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a2cf5f41e5372c687e0672561ed450bce">tabletype</a>;
<a name="l00293"></a>00293 
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fe">00298</a>         <span class="keyword">enum</span> <a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fe">HYPERSURFACE__TYPE</a>{
<a name="l00299"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2feacdbdd917d9101cc435984677152096cd">00299</a>           REAL__REAL,
<a name="l00300"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea7a11b79561a42769d56ad2891436dac1">00300</a>           REAL__DISCRETE,     
<a name="l00301"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea7b08759fcf14ca6e79297a15a040f0e8">00301</a>           DISCRETE__REAL,     <span class="comment">// not used </span>
<a name="l00302"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea79aaa07c270bfdae018066579d1a6e74">00302</a>           DISCRETE__DISCRETE,
<a name="l00303"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2feab74e3ed281e031eefcea30c78acc8aa5">00303</a>           CHI__REAL,          <span class="comment">// not used</span>
<a name="l00304"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea387b1271a19c6eff1b722b6fc8ac7364">00304</a>           REAL__CHI,
<a name="l00305"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea4934dec2b85674ad483ec32f9788aee4">00305</a>           CHI__DISCRETE,      
<a name="l00306"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2feaa12ed0a196e782d8df724f66a62cfeb3">00306</a>           DISCRETE__CHI,      
<a name="l00307"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2feabe62d600b6ac304a8d0d643d23f7bf6f">00307</a>           CHI__CHI,           
<a name="l00308"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2feaa6adeca1eb661ade0605c90c7eca11ce">00308</a>           SINGLE__REAL,  
<a name="l00309"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea8f99a26b16463e6e87976e84def31a0a">00309</a>           SINGLE__DISCRETE, 
<a name="l00310"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aab1fe7e8360a6a7fc438e0524068a2fea37260556714244b29b0d1afe3b2cb6ac">00310</a>           SINGLE__CHI         
<a name="l00311"></a>00311         };
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <span class="comment">/*_  Constructors and Destructors.</span>
<a name="l00314"></a>00314 <span class="comment">        */</span>
<a name="l00315"></a>00315         <a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">ShiftHyperSurface_</a>(<span class="keywordtype">int</span> verbosity = <a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a6d8ce63c8ee7cec4c45efe29ceb16560">EmpiricalHSShiftProcessor::VERBOSITY_LEVEL_CRITICAL</a>) throw();
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         <span class="comment">/*_ Detailed constructor. </span>
<a name="l00318"></a>00318 <span class="comment">         *  Creates a ShiftHyperSurface given the &lt;b&gt;filename&lt;\b&gt; of the data file, </span>
<a name="l00319"></a>00319 <span class="comment">         *  the atom type, and the two property types according to its deduced </span>
<a name="l00320"></a>00320 <span class="comment">         *  hypersurface types (see {\tt HYPERSURFACE__TYPE()}).</span>
<a name="l00321"></a>00321 <span class="comment">         *  </span>
<a name="l00322"></a>00322 <span class="comment">         *  If the data file cannot be found, no hypersurface is created.</span>
<a name="l00323"></a>00323 <span class="comment">         *</span>
<a name="l00324"></a>00324 <span class="comment">         *  In the special case that the two properties have the same type, we create just one table entry in </span>
<a name="l00325"></a>00325 <span class="comment">         *  {\tt table_} or just one spline  { \tt in s1d_ }. </span>
<a name="l00326"></a>00326 <span class="comment">         *  </span>
<a name="l00327"></a>00327 <span class="comment">         *  In case of hypersurfaces of type {\tt REAL__DISCRETE} the splines default values are set to the  </span>
<a name="l00328"></a>00328 <span class="comment">         *  row-averages if given specified in the datafile. </span>
<a name="l00329"></a>00329 <span class="comment">         *  </span>
<a name="l00330"></a>00330 <span class="comment">         *  In case of hypersurfaces of type {\tt  REAL__CHI, REAL__REAL } the splines default values are </span>
<a name="l00331"></a>00331 <span class="comment">         *  set to the splines averages. </span>
<a name="l00332"></a>00332 <span class="comment">         *</span>
<a name="l00333"></a>00333 <span class="comment">         *  In all cases but look-up tables the bounds for the splines are set as specified in </span>
<a name="l00334"></a>00334 <span class="comment">         *  the datafile if specified.</span>
<a name="l00335"></a>00335 <span class="comment">         * </span>
<a name="l00336"></a>00336 <span class="comment">         *  Note: </span>
<a name="l00337"></a>00337 <span class="comment">         *  The spline or value can be accessed </span>
<a name="l00338"></a>00338 <span class="comment">         *  by the {\tt operator () } given __not__ the property-value, but the property name. </span>
<a name="l00339"></a>00339 <span class="comment">         *  </span>
<a name="l00340"></a>00340 <span class="comment">         */</span>
<a name="l00341"></a>00341         <a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">ShiftHyperSurface_</a>(<a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> filename, <a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> atomtype, 
<a name="l00342"></a>00342                            <a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> firstproperty, <a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a> secondproperty, 
<a name="l00343"></a>00343                            <span class="keywordtype">int</span> verbosity = <a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>::VERBOSITY_LEVEL_CRITICAL)
<a name="l00344"></a>00344           throw(Exception::FileNotFound);  
<a name="l00345"></a>00345 
<a name="l00348"></a>00348         virtual ~<a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">ShiftHyperSurface_</a>() throw();
<a name="l00349"></a>00349 
<a name="l00359"></a>00359         <span class="keywordtype">float</span> operator () (PropertiesForShift_&amp; properties) throw();  
<a name="l00360"></a>00360 
<a name="l00364"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a154d26ec25110e955a443df319ab99c4">00364</a>         <span class="keywordtype">bool</span> isvalid() throw(){<span class="keywordflow">return</span> !invalid_;}
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         <span class="comment">// Returns the total average given in the input file.</span>
<a name="l00367"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a87adba6ed9c0dfa100ffc5818c8a3bd3">00367</a>         <span class="keywordtype">float</span> <a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a87adba6ed9c0dfa100ffc5818c8a3bd3">getTotalAverage</a>() throw() {<span class="keywordflow">return</span> average_;}
<a name="l00368"></a>00368 
<a name="l00369"></a>00369       <span class="keyword">private</span>:
<a name="l00370"></a>00370 
<a name="l00371"></a>00371         <span class="comment">// Computes the average of the look-up table values.</span>
<a name="l00372"></a>00372         <span class="keywordtype">float</span> getTableAverage_() throw();
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         <span class="comment">// Computes the row average of the look-up table given a row name.</span>
<a name="l00375"></a>00375         <span class="keywordtype">float</span> getTableRowAverage_(const std::map&lt;<a class="code" href="../../d3/d4e/classBALL_1_1String.html">String</a>, <span class="keywordtype">float</span>&gt;&amp; row) throw();
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <span class="comment">// Computes the column average of the look-up table given a column name.</span>
<a name="l00378"></a>00378         <span class="keywordtype">float</span> getTableColumnAverage_(const String&amp; name) throw();
<a name="l00379"></a>00379 
<a name="l00384"></a>00384         <span class="keywordtype">bool</span> tableHasColumn_(const String&amp; name) throw();
<a name="l00385"></a>00385 
<a name="l00405"></a>00405         <span class="keywordtype">void</span> parseDataFile_(BALL::<a class="code" href="../../db/db5/classBALL_1_1File.html">File</a>&amp; file, String filename) throw();
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         <span class="comment">// Method to convert a vector of strings into a vector of floats {/tt output}.</span>
<a name="l00408"></a>00408         <span class="keywordtype">void</span> convertToReal_(const vector&lt;String&gt;&amp; input, vector&lt;<span class="keywordtype">float</span>&gt;&amp; output) throw();
<a name="l00409"></a>00409 
<a name="l00413"></a>00413         <span class="keywordtype">void</span> setType_(String firstproperty, String secondproperty) throw();
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         <span class="comment">// The type of the hypersurface.</span>
<a name="l00416"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a341ad710e62556798a27a67f76832cc1">00416</a>         <span class="keywordtype">int</span> type_;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         <span class="comment">// The properties of the hypersurface. </span>
<a name="l00419"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#ad3a80618baea244605849d53200bd0c8">00419</a>         String  first_property_; 
<a name="l00420"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aa797eeaf412616686eca6696cb35e797">00420</a>         String  second_property_;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         <span class="comment">// The hypersurface can be a 2D spline, 1D spline or a look-up table.</span>
<a name="l00423"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aeed6d5c07aaa65d0beb4a9b35a9e2082">00423</a>         <a class="code" href="../../d4/d23/classBALL_1_1CubicSpline2D.html">CubicSpline2D</a>                               s2d_;
<a name="l00424"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a519814a50fa295062177e8e1e9c77eac">00424</a>         std::map &lt;String, <a class="code" href="../../d0/ded/classBALL_1_1CubicSpline1D.html">CubicSpline1D</a> &gt;           s1d_;
<a name="l00425"></a>00425         <span class="comment">// Note: access of the look--up table: first the discrete key x, second the numerical key y. </span>
<a name="l00426"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a241ac295adcc3a3a09b56dea34ea97cf">00426</a>         std::map &lt;String, std::map&lt;String, <span class="keywordtype">float</span>&gt; &gt; table_;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         <span class="comment">// The averages of the hypersurface as read from the file.</span>
<a name="l00429"></a>00429         <span class="comment">// //TODO rename to row_defaults</span>
<a name="l00430"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a860466f38991d80b60337e60b82b3e65">00430</a>         std::map &lt;String, <span class="keywordtype">float</span>&gt;                    row_averages_;
<a name="l00431"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aed6425e8df088cff1a7589ff676032fc">00431</a>         std::map &lt;String, <span class="keywordtype">float</span>&gt;                    col_averages_;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433         <span class="comment">// The spacing in x and y direction as read from the file.</span>
<a name="l00434"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#ac517b03230e95c7cdad6cfa289a63b1a">00434</a>         <span class="keywordtype">float</span> row_spacing_;
<a name="l00435"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#ad4a7467c657b39d5eb042219f6deb325">00435</a>         <span class="keywordtype">float</span> col_spacing_;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437         <span class="comment">// Flag to store whether the spline we created is valid.</span>
<a name="l00438"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#ad357277da31999359cc79884fbb90949">00438</a>         <span class="keywordtype">bool</span> invalid_;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440         <span class="comment">// The average over the complete hypersurface as read from the file.</span>
<a name="l00441"></a>00441         <span class="comment">// Note: this average maybe weighted in non-obvious ways! </span>
<a name="l00442"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a41cc1c5a25e80519381c552fe6616864">00442</a>         <span class="keywordtype">float</span> average_;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444         <span class="comment">// verbosity of the method</span>
<a name="l00445"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a33621030d160e4719af2b4fcd45b7bbf">00445</a>         <span class="keywordtype">int</span> verbosity_;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447         <span class="comment">// The underlying data of the hypersurface as read from the file.</span>
<a name="l00448"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#aeb515c89d9384c799a40bfb4b1e206ff">00448</a>         vector&lt;String&gt;           y_axis_values_;
<a name="l00449"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#ab1805e1f43e64a9eeab3a59764fde42e">00449</a>         vector&lt;vector&lt;String&gt; &gt;  x_axis_values_;
<a name="l00450"></a><a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html#a7259c10dce87c30fd41de1f1fdd4fe9b">00450</a>         vector&lt;vector&lt;<span class="keywordtype">float</span>&gt; &gt;   sample_values_;
<a name="l00451"></a>00451     };
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="comment">/*_ The target atoms collected by {\tt operator ()}.</span>
<a name="l00457"></a>00457 <span class="comment">    */</span>
<a name="l00458"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#aa1414b9ecfc1cc1de2495a0905ba5f71">00458</a>     std::vector&lt;PropertiesForShift_&gt;        targets_;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     <span class="comment">/*_ The target atom types stored as a vector of strings collected from the ini-file</span>
<a name="l00461"></a>00461 <span class="comment">     *  by {\tt init ()}.</span>
<a name="l00462"></a>00462 <span class="comment">     */</span>
<a name="l00463"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a3aba6cfde659664dff0e03f5c3e06695">00463</a>     vector&lt;String&gt;                      target_names_;  
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="comment">/*_ The target properties used for determine the </span>
<a name="l00466"></a>00466 <span class="comment">     * empirical hypersurface shifts. The properties are collected </span>
<a name="l00467"></a>00467 <span class="comment">     * from the ini-file by {\tt init ()} and are stored per target atom</span>
<a name="l00468"></a>00468 <span class="comment">     * in the same order as the target_names.</span>
<a name="l00469"></a>00469 <span class="comment">     */</span>
<a name="l00470"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#ad860d42a9e2c755e2990b9d802d8e9fa">00470</a>     vector&lt; std::set&lt;String&gt; &gt;      target_property_names_;
<a name="l00471"></a>00471 
<a name="l00472"></a>00472     <span class="comment">/*_ The file names of the files storing the property-data-splines for computing the</span>
<a name="l00473"></a>00473 <span class="comment">     * shift contributions are stored in a map, whose key is the pair of</span>
<a name="l00474"></a>00474 <span class="comment">     * properties, to which the splines belong.</span>
<a name="l00475"></a>00475 <span class="comment">     * The maps are stored per target atom type in the same order as the target_names.</span>
<a name="l00476"></a>00476 <span class="comment">     * The files are specified in the section {\tt EmpiricalShiftHyperSurfaces} </span>
<a name="l00477"></a>00477 <span class="comment">     * of the file {\tt ShiftX.ini} and are collected by {\tt init ()}.</span>
<a name="l00478"></a>00478 <span class="comment">     */</span>
<a name="l00479"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a97da525e732b5e996c86b095a0894c12">00479</a>     vector&lt; std::map&lt; std::pair&lt;String, String&gt;, String &gt; &gt;   property_files_; 
<a name="l00480"></a>00480 
<a name="l00481"></a>00481     <span class="comment">/*_ The property pairs for each atom type are stored in this map.</span>
<a name="l00482"></a>00482 <span class="comment">     *  The map is created in {\tt init ()}.</span>
<a name="l00483"></a>00483 <span class="comment">     **/</span>
<a name="l00484"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#aa7e45b45f61ef6bbeda7428f55e04d12">00484</a>     std::map&lt; String, vector&lt; std::pair&lt;String, String&gt; &gt; &gt;  property_pairs_;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     <span class="comment">/*_ The hypersurfaces are precomputed by {\tt init()}</span>
<a name="l00487"></a>00487 <span class="comment">     *  and then are stored per atom type in a  map with key atom_type of </span>
<a name="l00488"></a>00488 <span class="comment">     *  maps with the property pair as key.</span>
<a name="l00489"></a>00489 <span class="comment">     */</span>
<a name="l00490"></a>00490 
<a name="l00491"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#ac27b96e2dcce9a8673218a7a8c104027">00491</a>     std::map&lt;String, std::map &lt;std::pair&lt;String, String&gt;,<a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html">EmpiricalHSShiftProcessor</a>::<a class="code" href="../../df/d4d/classBALL_1_1EmpiricalHSShiftProcessor_1_1ShiftHyperSurface__.html">ShiftHyperSurface_</a>&gt; &gt; hypersurfaces_;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493     <span class="comment">/*_ Option to exclude prolins from the shift computations. </span>
<a name="l00494"></a>00494 <span class="comment">      Default is false.</span>
<a name="l00495"></a>00495 <span class="comment">      */</span>
<a name="l00496"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a5359ce265bfbb24d15de245b12cf1eff">00496</a>     <span class="keywordtype">bool</span> exclude_prolins_;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <span class="comment">// Map containing possible correction terms for ssbonds.</span>
<a name="l00499"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a1402debc4daf4e94462e646a5a76030c">00499</a>     std::map&lt;String, <span class="keywordtype">float</span>&gt; ssbond_correction_;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   private:
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="comment">/*_ Some debugging functions printing parameter/effector/target information</span>
<a name="l00504"></a>00504 <span class="comment">     *   to the Log stream.</span>
<a name="l00505"></a>00505 <span class="comment">     */</span>
<a name="l00506"></a>00506     <span class="keywordtype">void</span>      printParameters_() throw();
<a name="l00507"></a>00507     <span class="keywordtype">void</span>      printTargets_() throw();  
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">/*_ A function to perform some ShiftX-y postprocessing: </span>
<a name="l00510"></a>00510 <span class="comment">      add for all CA-atoms 0.2 times the EF-shift-value of the bound HA-atoms.</span>
<a name="l00511"></a>00511 <span class="comment">      Due to some reason ShiftX does not perform this postprocessing </span>
<a name="l00512"></a>00512 <span class="comment">      for the empirical Hypersurface contributions.</span>
<a name="l00513"></a>00513 <span class="comment">      */</span>
<a name="l00514"></a>00514     <span class="keywordtype">void</span>      postprocessing_() throw();
<a name="l00515"></a>00515 
<a name="l00517"></a><a class="code" href="../../dd/d40/classBALL_1_1EmpiricalHSShiftProcessor.html#a22a6a225b7219471873b64ada60a62c5">00517</a>     <span class="keywordtype">int</span>       verbosity_;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519   };<span class="comment">// end of class</span>
<a name="l00520"></a>00520 } <span class="comment">// end of namespace</span>
<a name="l00521"></a>00521 <span class="preprocessor">#endif // BALL_NMR_EMPIRICALHSSHIFTPROCESSOR_H</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Dec 7 19:12:29 2010 for BALL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.5.9 </small></address>
</body>
</html>
