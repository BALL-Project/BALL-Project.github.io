<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
<h1>conjugateGradient.h</h1><a href="conjugateGradient_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// -*- Mode: C++; tab-width: 2; -*-</span>
<a name="l00002"></a>00002 <span class="comment">// vi: set ts=2:</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">// $Id: conjugateGradient.h,v 1.29.20.6 2007/08/07 09:12:33 aleru Exp $ </span>
<a name="l00005"></a>00005 <span class="comment">//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef BALL_MOLMEC_MINIMIZATION_CONJUGATEGRADIENT_H </span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define BALL_MOLMEC_MINIMIZATION_CONJUGATEGRADIENT_H </span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef BALL_MOLMEC_MINIMIZATION_ENERGYMINIMIZER_H</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="energyMinimizer_8h.html">BALL/MOLMEC/MINIMIZATION/energyMinimizer.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#endif</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef BALL_MOLMEC_MINIMIZATION_LINESEARCH_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="lineSearch_8h.html">BALL/MOLMEC/MINIMIZATION/lineSearch.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#endif</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a>00018 <span class="keyword">namespace </span>BALL
<a name="l00019"></a>00019 {
<a name="l00040"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html">00040</a>   <span class="keyword">class </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html">ConjugateGradientMinimizer</a> 
<a name="l00041"></a>00041     : <span class="keyword">public</span> <a class="code" href="classBALL_1_1EnergyMinimizer.html">EnergyMinimizer</a>
<a name="l00042"></a>00042   {
<a name="l00043"></a>00043     <span class="keyword">public</span>:
<a name="l00044"></a>00044       
<a name="l00048"></a>00048       
<a name="l00052"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42b">00052</a>       <span class="keyword">enum</span> <a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42b">UpdateMethod</a>
<a name="l00053"></a>00053       {
<a name="l00056"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42ba0d212f4d1c69d6cd712cd7e22ab7254f">00056</a>         POLAK_RIBIERE = 1,
<a name="l00057"></a>00057         
<a name="l00060"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42bab3717b244f279986ebfc4a4aada8c2a1">00060</a>         FLETCHER_REEVES = 2,
<a name="l00061"></a>00061         
<a name="l00064"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42ba616d22870a3171b4f96b3ed5f0bc1349">00064</a>         SHANNO = 3
<a name="l00065"></a>00065       };
<a name="l00066"></a>00066       
<a name="l00068"></a>00068 
<a name="l00071"></a>00071       
<a name="l00074"></a><a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Option.html">00074</a>       <span class="keyword">struct </span><a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Option.html">Option</a>
<a name="l00075"></a>00075       {
<a name="l00078"></a><a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Option.html#a8d575fa616fd729f40e4c5490ac5e24d">00078</a>         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* UPDATE_METHOD; 
<a name="l00079"></a>00079       };
<a name="l00080"></a>00080       
<a name="l00083"></a><a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Default.html">00083</a>       <span class="keyword">struct </span><a class="code" href="COMMON_2global_8h.html#afc068a3fa668cb3f5a7f178772cc75bf">BALL_EXPORT</a> <a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Default.html">Default</a>
<a name="l00084"></a>00084       {
<a name="l00087"></a><a class="code" href="structBALL_1_1ConjugateGradientMinimizer_1_1Default.html#a46581d70339cdd7022782ac074eab96b">00087</a>         <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> UPDATE_METHOD;
<a name="l00088"></a>00088       };
<a name="l00089"></a>00089       
<a name="l00091"></a>00091 
<a name="l00094"></a>00094       
<a name="l00095"></a>00095       <a class="code" href="group__Common.html#ga84998f74fd7a58cecfcbb81d48b4323b">BALL_CREATE</a>(<a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html">ConjugateGradientMinimizer</a>)
<a name="l00096"></a>00096       
<a name="l00097"></a>00097       
<a name="l00099"></a>00099       <a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html">ConjugateGradientMinimizer</a>();
<a name="l00100"></a>00100       
<a name="l00103"></a>00103       ConjugateGradientMinimizer(<a class="code" href="classBALL_1_1ForceField.html">ForceField</a>&amp; force_field);
<a name="l00104"></a>00104       
<a name="l00107"></a>00107       ConjugateGradientMinimizer(<a class="code" href="classBALL_1_1ForceField.html">ForceField</a>&amp; force_field,<a class="code" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a> *ssm);
<a name="l00108"></a>00108       
<a name="l00111"></a>00111       ConjugateGradientMinimizer(<a class="code" href="classBALL_1_1ForceField.html">ForceField</a>&amp; force_field, 
<a name="l00112"></a>00112                                  <a class="code" href="classBALL_1_1SnapShotManager.html">SnapShotManager</a>* ssm, const <a class="code" href="classBALL_1_1Options.html">Options</a>&amp; options);
<a name="l00113"></a>00113       
<a name="l00116"></a>00116       ConjugateGradientMinimizer(<a class="code" href="classBALL_1_1ForceField.html">ForceField</a>&amp; force_field, const <a class="code" href="classBALL_1_1Options.html">Options</a>&amp; options);
<a name="l00117"></a>00117       
<a name="l00120"></a>00120       ConjugateGradientMinimizer(const ConjugateGradientMinimizer&amp; rhs);
<a name="l00121"></a>00121       
<a name="l00124"></a>00124       virtual ~ConjugateGradientMinimizer();
<a name="l00125"></a>00125       
<a name="l00127"></a>00127 
<a name="l00130"></a>00130       
<a name="l00133"></a>00133       const ConjugateGradientMinimizer&amp; operator = (const ConjugateGradientMinimizer&amp; rhs);
<a name="l00134"></a>00134       
<a name="l00136"></a>00136 
<a name="l00139"></a>00139       
<a name="l00142"></a>00142       virtual <span class="keywordtype">bool</span> specificSetup();
<a name="l00143"></a>00143       
<a name="l00145"></a>00145 
<a name="l00148"></a>00148       
<a name="l00152"></a>00152       <span class="keywordtype">void</span> setUpdateMethod(<a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42b">UpdateMethod</a> method);
<a name="l00153"></a>00153       
<a name="l00156"></a>00156       <a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ace1805219285b10946f7789bccdcc42b">UpdateMethod</a> getUpdateMethod() const;
<a name="l00157"></a>00157       
<a name="l00164"></a>00164       virtual <span class="keywordtype">double</span> findStep();
<a name="l00165"></a>00165       
<a name="l00171"></a>00171       virtual <span class="keywordtype">void</span> updateDirection();
<a name="l00172"></a>00172       
<a name="l00181"></a>00181       virtual <span class="keywordtype">bool</span> minimize(<a class="code" href="classBALL__SIZE__TYPE.html">Size</a> iterations = 0, <span class="keywordtype">bool</span> resume = false); 
<a name="l00182"></a>00182       
<a name="l00183"></a>00183     protected:
<a name="l00184"></a>00184     
<a name="l00186"></a>00186 
<a name="l00189"></a>00189       
<a name="l00192"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#af07714ea418225ff2243570c6d80b053">00192</a>       <a class="code" href="classBALL_1_1LineSearch.html">LineSearch</a> line_search_;
<a name="l00193"></a>00193       
<a name="l00196"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ab2ff90316719ca94313a0ad5074de209">00196</a>       <a class="code" href="classBALL_1_1Gradient.html">Gradient</a> unscaled_direction_;
<a name="l00197"></a>00197       
<a name="l00200"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ad61c782ccf5e0f612f271e2c13f7d5ee">00200</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> number_of_atoms_;
<a name="l00201"></a>00201       
<a name="l00204"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ac7877691a4587a6e726530fafa067084">00204</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> updt_method_;
<a name="l00205"></a>00205       
<a name="l00208"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a88782ad2bcb32855cb84569304298eb4">00208</a>       <span class="keywordtype">bool</span> first_iter_;
<a name="l00209"></a>00209       
<a name="l00212"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a0943219c176e702251398a8a72b62c38">00212</a>       <span class="keywordtype">double</span> old_gtg_;
<a name="l00213"></a>00213       
<a name="l00216"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a1c4235312b3632d7166f7871a4fed7df">00216</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; a_i_;
<a name="l00217"></a>00217       
<a name="l00220"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a014a4b0f4f7f31f7c0dc89302f389ed1">00220</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; b_i_;
<a name="l00221"></a>00221        
<a name="l00224"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a42a30f199cf05cd66ee769435ac5dd68">00224</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; p_t_;
<a name="l00225"></a>00225        
<a name="l00228"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ad23813524aadafee9e74347cb1b6e911">00228</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; y_t_;
<a name="l00229"></a>00229        
<a name="l00232"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a7335973404d929f23da2c92ce8eb0934">00232</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; p_i_;
<a name="l00233"></a>00233                  
<a name="l00236"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a459d69f83d132ed0fafb4492f484d3da">00236</a>       vector&lt;<a class="code" href="classBALL_1_1TVector3.html">Vector3</a>&gt; y_i_;
<a name="l00237"></a>00237       
<a name="l00240"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#ab0cd781b8987490e6b1977d12db07bc1">00240</a>       <span class="keywordtype">double</span> D_1_;
<a name="l00241"></a>00241       
<a name="l00244"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a911ecef42ac89614c0429aa6222eb54e">00244</a>       <span class="keywordtype">double</span> D_4_;
<a name="l00245"></a>00245       
<a name="l00248"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a58b0e76d2dc2bbd15c136f75dfc529d2">00248</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> restart_frequency_;
<a name="l00249"></a>00249       
<a name="l00255"></a><a class="code" href="classBALL_1_1ConjugateGradientMinimizer.html#a3059ac82e76099ff514ab78a21bc096a">00255</a>       <a class="code" href="classBALL__SIZE__TYPE.html">Size</a> last_restart_iter_;
<a name="l00256"></a>00256       
<a name="l00258"></a>00258     
<a name="l00259"></a>00259   };
<a name="l00260"></a>00260 } <span class="comment">// end of namespace BALL</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#endif // BALL_MOLMEC_MINIMIZATION_CONJUGATEGRADIENT_H </span>
</pre></div></div>
</div>
</body>
</html>
