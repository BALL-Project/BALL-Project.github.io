<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<div metal:fill-slot="main">
  <link rel="Stylesheet" type="text/css" href="doxygen.css" />
<!-- Generated by Doxygen 1.5.9 -->
  <div class="navpath"><a class="el" href="namespaceBALL.html">BALL</a>::<a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html">HaighMallionShiftProcessor</a>
  </div>
<div class="contents">
<h1>BALL::HaighMallionShiftProcessor Class Reference<br/>
<small>
[<a class="el" href="group__ShiftModulesNMR.html">Shift modules</a>]</small>
</h1><!-- doxytag: class="BALL::HaighMallionShiftProcessor" --><!-- doxytag: inherits="BALL::ShiftModule" -->
<p><code>#include &lt;<a class="el" href="haighMallionShiftProcessor_8h_source.html">BALL/NMR/haighMallionShiftProcessor.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BALL::HaighMallionShiftProcessor:</div>
<div class="dynsection">
<img class="center" src="classBALL_1_1HaighMallionShiftProcessor.png" usemap="#BALL::HaighMallionShiftProcessor_map" alt=""/>
<map id="BALL::HaighMallionShiftProcessor_map">
<area href="classBALL_1_1ShiftModule.html" alt="BALL::ShiftModule" shape="rect" coords="0,112,316,136"/>
<area href="classBALL_1_1UnaryProcessor.html" alt="BALL::UnaryProcessor&lt; Composite &gt;" shape="rect" coords="0,56,316,80"/>
<area href="classBALL_1_1UnaryFunctor.html" alt="BALL::UnaryFunctor&lt; Composite, Processor::Result &gt;" shape="rect" coords="0,0,316,24"/>
</map>
</div>

<p><a href="classBALL_1_1HaighMallionShiftProcessor-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br/><h2>Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors and Destructors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a72311cc3ee942bff4b786eee9365bebd">HaighMallionShiftProcessor</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a8f3f269c9970df8d782f2d3688e7ada6">~HaighMallionShiftProcessor</a> ()</td></tr>
<tr><td colspan="2"><div class="groupHeader">Processor specific functions.</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a28426d9421bc40b4e6590b1c3120b84b">finish</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classBALL_1_1Processor.html#afc8b424f41762b055b9b22f7e9c22e8a">Processor::Result</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#af6fa93331b65bdcd64bdd470233bab01">operator()</a> (<a class="el" href="classBALL_1_1Composite.html">Composite</a> &amp;atom)</td></tr>
<tr><td colspan="2"><div class="groupHeader">Accessors</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a779c2249f9264cb6a9020bece31d8f2e">init</a> ()</td></tr>
<tr><td colspan="2"><br/><h2>Static Public Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Enums and Constants</div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#aaa1530df927d8ed39853d6c8b012fbfe">PROPERTY__RING_CURRENT_SHIFT</a></td></tr>
<tr><td colspan="2"><br/><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classBALL_1_1Atom.html">Atom</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a41bf1c30874120765138c32eea9c850e">proton_list_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classBALL_1_1Residue.html">Residue</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a99bd8f0f1fedc3edc2ecf921b4d1e0be">aromat_list_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBALL_1_1String.html">String</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a9e6abfabf5da2bc3935ca7eadb84505c">asrings_</a></td></tr>
<tr><td colspan="2"><br/><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classfloat.html">float</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#abcaa49c11aaa188c10bb54969596bf3a">big_loop_radius_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classfloat.html">float</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#ac56f7ca49fcf13fa63e77a1e3a37711e">little_loop_radius_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classfloat.html">float</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a571c8ce4fbd02de655be2e0e3bd6b895">B_</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Shift assignment processor implementing Haigh Mallion theory. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a72311cc3ee942bff4b786eee9365bebd"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::HaighMallionShiftProcessor" ref="a72311cc3ee942bff4b786eee9365bebd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::HaighMallionShiftProcessor::HaighMallionShiftProcessor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Default constructor. </p>

</div>
</div>
<a class="anchor" id="a8f3f269c9970df8d782f2d3688e7ada6"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::~HaighMallionShiftProcessor" ref="a8f3f269c9970df8d782f2d3688e7ada6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual BALL::HaighMallionShiftProcessor::~HaighMallionShiftProcessor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a28426d9421bc40b4e6590b1c3120b84b"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::finish" ref="a28426d9421bc40b4e6590b1c3120b84b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classbool.html">bool</a> BALL::HaighMallionShiftProcessor::finish </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finish method. Here the work is done: The funcion iterates over all systems's protons by iterating through proton_list_. Then for each proton every ring in aromat_list_ is accessed. The actual ring's ringplane and it's area is calculated. Iterating over every bond of the aromatic ring, the triangle areas are calculated with: The bond's two atoms and the actual proton's projection onto the ringplane. It is important to state that these areas are signed areas, depending on wether there is a right handed system between the plane's normal vector and the difference vectors from the projection to the two bond's atoms. Next the protons distances to the actual two bond's atoms are calculated and stored in a_first and a_second. Then ts is calculated : $ ts = f * (1/a_{first}^3 + 1/a_{second}) $ with f as the actual tringle area. For every bond of the ring this partial sum is calculated , added and stored in gs. Just some constant factor B and the chemical shift using Haigh Mallions Model is done. Important note: Distances are expressed in terms of the actual ring's diameter. <a class="el" href="classBALL_1_1Triangle.html">Triangle</a> areas are expressed in terms of the actual ring's area. </p>

<p>Reimplemented from <a class="el" href="classBALL_1_1ShiftModule.html#a7f30f416749fd406d993075c66f3842d">BALL::ShiftModule</a>.</p>

</div>
</div>
<a class="anchor" id="a779c2249f9264cb6a9020bece31d8f2e"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::init" ref="a779c2249f9264cb6a9020bece31d8f2e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BALL::HaighMallionShiftProcessor::init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialization method. </p>

<p>Reimplemented from <a class="el" href="classBALL_1_1ShiftModule.html#a67797442ad28392508f6107b2f565cca">BALL::ShiftModule</a>.</p>

</div>
</div>
<a class="anchor" id="af6fa93331b65bdcd64bdd470233bab01"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::operator()" ref="af6fa93331b65bdcd64bdd470233bab01" args="(Composite &amp;atom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classBALL_1_1Processor.html#afc8b424f41762b055b9b22f7e9c22e8a">Processor::Result</a> BALL::HaighMallionShiftProcessor::operator() </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBALL_1_1Composite.html">Composite</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>atom</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Application method Works as a collector: It stores the systems aromatic rings in a list called aromat_list_ and each proton in a list called proton_list_ </p>

<p>Reimplemented from <a class="el" href="classBALL_1_1UnaryProcessor.html#abba1bfcd74b107e8cabdc6b6119df6e1">BALL::UnaryProcessor&lt; Composite &gt;</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a99bd8f0f1fedc3edc2ecf921b4d1e0be"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::aromat_list_" ref="a99bd8f0f1fedc3edc2ecf921b4d1e0be" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="classBALL_1_1Residue.html">Residue</a>*&gt; <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a99bd8f0f1fedc3edc2ecf921b4d1e0be">BALL::HaighMallionShiftProcessor::aromat_list_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9e6abfabf5da2bc3935ca7eadb84505c"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::asrings_" ref="a9e6abfabf5da2bc3935ca7eadb84505c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBALL_1_1String.html">String</a>** <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a9e6abfabf5da2bc3935ca7eadb84505c">BALL::HaighMallionShiftProcessor::asrings_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a571c8ce4fbd02de655be2e0e3bd6b895"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::B_" ref="a571c8ce4fbd02de655be2e0e3bd6b895" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classfloat.html">float</a> <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a571c8ce4fbd02de655be2e0e3bd6b895">BALL::HaighMallionShiftProcessor::B_</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abcaa49c11aaa188c10bb54969596bf3a"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::big_loop_radius_" ref="abcaa49c11aaa188c10bb54969596bf3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classfloat.html">float</a> <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#abcaa49c11aaa188c10bb54969596bf3a">BALL::HaighMallionShiftProcessor::big_loop_radius_</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac56f7ca49fcf13fa63e77a1e3a37711e"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::little_loop_radius_" ref="ac56f7ca49fcf13fa63e77a1e3a37711e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classfloat.html">float</a> <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#ac56f7ca49fcf13fa63e77a1e3a37711e">BALL::HaighMallionShiftProcessor::little_loop_radius_</a><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aaa1530df927d8ed39853d6c8b012fbfe"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::PROPERTY__RING_CURRENT_SHIFT" ref="aaa1530df927d8ed39853d6c8b012fbfe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#aaa1530df927d8ed39853d6c8b012fbfe">BALL::HaighMallionShiftProcessor::PROPERTY__RING_CURRENT_SHIFT</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A symbolic name for the ring current contribution to the chemical shift. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classBALL_1_1ShiftModule.html#aac00de78f850f08f81f0dfc97283387d">ShiftModule::PROPERTY__SHIFT</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a41bf1c30874120765138c32eea9c850e"></a><!-- doxytag: member="BALL::HaighMallionShiftProcessor::proton_list_" ref="a41bf1c30874120765138c32eea9c850e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="classBALL_1_1Atom.html">Atom</a>*&gt; <a class="el" href="classBALL_1_1HaighMallionShiftProcessor.html#a41bf1c30874120765138c32eea9c850e">BALL::HaighMallionShiftProcessor::proton_list_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
</div>
</body>
</html>
