<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>BALL: BALL::BinaryFingerprintMethods Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../balldoc.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<header id="masthead" class="site-header" role="banner">
	<a class="home-link" href="http://balldoc.informatik.uni-tuebingen.de/" title="BALL" rel="home">
		<h1 class="site-title">BALL 1.4.79</h1>
		<h2 class="site-description">Biochemical Algorithms Library</h2>
	</a>
	<div id="navbar" class="navbar">
		<nav id="site-navigation" class="navigation main-navigation" role="navigation">
			<div class="menu-menu-1-container">
				<ul class="nav-menu">
					<li><a href="http://balldoc.informatik.uni-tuebingen.de/">News</a></li>
					<li><a href="http://balldoc.informatik.uni-tuebingen.de/?page_id=2">About</a></li>
					<li class="current-menu-item"><a href="http://balldoc.informatik.uni-tuebingen.de/?page_id=21">Documentation</a></li>
					<li><a href="http://balldoc.informatik.uni-tuebingen.de/?page_id=23">Support</a></li>
					<li><a href="http://balldoc.informatik.uni-tuebingen.de/?page_id=30">Gallery</a></li>
				</ul>
			</div>
		</nav><!-- #site-navigation -->
	</div><!-- #navbar -->
</header>
</div>
<div id="content-wrapper"><div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(13)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d0/d09/namespaceBALL.html">BALL</a></li><li class="navelem"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../dd/d0a/classBALL_1_1BinaryFingerprintMethods-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">BALL::BinaryFingerprintMethods Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class provides efficient similarity calculation functionality for 2D binary fingerprints.  
 <a href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d4/d71/binaryFingerprintMethods_8h_source.html">BALL/STRUCTURE/binaryFingerprintMethods.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dbe/structBALL_1_1BinaryFingerprintMethods_1_1Default.html">Default</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d07/structBALL_1_1BinaryFingerprintMethods_1_1Option.html">Option</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors and Destructors</div></td></tr>
<tr class="memitem:aa58273788c4db3fdcea29a5c18059819"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#aa58273788c4db3fdcea29a5c18059819">BinaryFingerprintMethods</a> ()</td></tr>
<tr class="separator:aa58273788c4db3fdcea29a5c18059819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a076381cb6c927f6e97daca3f6111c6be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a076381cb6c927f6e97daca3f6111c6be">BinaryFingerprintMethods</a> (const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;options)</td></tr>
<tr class="separator:a076381cb6c927f6e97daca3f6111c6be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e03dc4d2002e236051cdb4d66ab924"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a44e03dc4d2002e236051cdb4d66ab924">BinaryFingerprintMethods</a> (const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;options, const FingerprintFeatures &amp;lib_features)</td></tr>
<tr class="separator:a44e03dc4d2002e236051cdb4d66ab924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d95f7094a4e241899d6a945138ce82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a69d95f7094a4e241899d6a945138ce82">BinaryFingerprintMethods</a> (const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;options, const FingerprintFeatures &amp;lib_features, const FingerprintFeatures &amp;query_features)</td></tr>
<tr class="separator:a69d95f7094a4e241899d6a945138ce82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dce3261ccf324504e5500565eaed85b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4dce3261ccf324504e5500565eaed85b">BinaryFingerprintMethods</a> (const <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a> &amp;bfm)</td></tr>
<tr class="separator:a4dce3261ccf324504e5500565eaed85b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76218f09e26aeb51ab18b23abb310b91"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a76218f09e26aeb51ab18b23abb310b91">~BinaryFingerprintMethods</a> ()</td></tr>
<tr class="separator:a76218f09e26aeb51ab18b23abb310b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Assignment</div></td></tr>
<tr class="memitem:a4f8cd4431724ac7cba4c9b970cdcd777"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4f8cd4431724ac7cba4c9b970cdcd777">operator=</a> (const <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a> &amp;bfm)</td></tr>
<tr class="separator:a4f8cd4431724ac7cba4c9b970cdcd777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Accessors</div></td></tr>
<tr class="memitem:acb725c5572c0ba2d8ae072cfd0375d94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#acb725c5572c0ba2d8ae072cfd0375d94">setLibraryFeatures</a> (const FingerprintFeatures &amp;lib_features)</td></tr>
<tr class="separator:acb725c5572c0ba2d8ae072cfd0375d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136883c4ad6f36afd658984e32dd4bf0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a136883c4ad6f36afd658984e32dd4bf0">setQueryFeatures</a> (const FingerprintFeatures &amp;query_features)</td></tr>
<tr class="separator:a136883c4ad6f36afd658984e32dd4bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725eea8cfd2929045a81d1352496cae1"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a725eea8cfd2929045a81d1352496cae1">getTargetLibrarySize</a> () const </td></tr>
<tr class="separator:a725eea8cfd2929045a81d1352496cae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c543ddd899735b13610ab15117283f3"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4c543ddd899735b13610ab15117283f3">getQueryLibrarySize</a> () const </td></tr>
<tr class="separator:a4c543ddd899735b13610ab15117283f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78afabd937858571aedeb1b0a46aa8da"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a78afabd937858571aedeb1b0a46aa8da">getOptions</a> () const </td></tr>
<tr class="separator:a78afabd937858571aedeb1b0a46aa8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391db65bae5f65079f0027eb9348ba32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a391db65bae5f65079f0027eb9348ba32">setVerbosityLevel</a> (const int verbosity)</td></tr>
<tr class="separator:a391db65bae5f65079f0027eb9348ba32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Applications</div></td></tr>
<tr class="memitem:a4860b71a3af2e427feea8a711cf5179b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4860b71a3af2e427feea8a711cf5179b">cutoffSearch</a> (const <a class="el" href="../../d4/dc3/classfloat.html">float</a> sim_cutoff, const <a class="el" href="../../d3/d4e/classBALL_1_1String.html">String</a> &amp;outfile_name)</td></tr>
<tr class="separator:a4860b71a3af2e427feea8a711cf5179b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2544c40e906d2fd3a11695bd18900f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a5d2544c40e906d2fd3a11695bd18900f">connectedComponents</a> (const std::vector&lt; unsigned int &gt; &amp;selection, std::vector&lt; std::vector&lt; unsigned int &gt; &gt; &amp;ccs, std::vector&lt; std::vector&lt; std::pair&lt; unsigned int, <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &gt; &gt; &amp;nn_data, const <a class="el" href="../../d4/dc3/classfloat.html">float</a> cutoff, const <a class="el" href="../../d9/db9/classbool.html">bool</a> store_nns=false)</td></tr>
<tr class="separator:a5d2544c40e906d2fd3a11695bd18900f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce2cd7e5ac4a6eaa1c55b6e9d7e88bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a9ce2cd7e5ac4a6eaa1c55b6e9d7e88bb">averageLinkageClustering</a> (const std::vector&lt; unsigned int &gt; &amp;selection, std::vector&lt; std::pair&lt; unsigned int, <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &gt; &amp;nn_data, std::map&lt; unsigned int, std::vector&lt; unsigned int &gt; &gt; &amp;cluster_selection)</td></tr>
<tr class="separator:a9ce2cd7e5ac4a6eaa1c55b6e9d7e88bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293be367b60dda5fd708780ca36539eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a293be367b60dda5fd708780ca36539eb">calculateSelectionMedoid</a> (const std::vector&lt; unsigned int &gt; &amp;selection, unsigned int &amp;medoid_index, std::vector&lt; <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &amp;avg_sims)</td></tr>
<tr class="separator:a293be367b60dda5fd708780ca36539eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4274c3a290eb0c11b231636f9ca3c953"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4274c3a290eb0c11b231636f9ca3c953">parseBinaryFingerprint</a> (const <a class="el" href="../../d3/d4e/classBALL_1_1String.html">String</a> &amp;fprint, std::vector&lt; unsigned short &gt; &amp;features, unsigned int fp_type, const char *delim=&quot;,&quot;)</td></tr>
<tr class="separator:a4274c3a290eb0c11b231636f9ca3c953"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class provides efficient similarity calculation functionality for 2D binary fingerprints. </p>
<pre class="fragment">Binary Fingerprint Methods
</pre><p> <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html" title="This class provides efficient similarity calculation functionality for 2D binary fingerprints. ">BinaryFingerprintMethods</a> uses a blocked inverted index data structures as a representation of 2D binary fingerprints. This data structure enables efficient calculation of similarity coefficients which use shared feature counts between two fingerprints. The shared feature count is the number of on-bits which two different fingerprints have in common. Currently the class provides the Tanimoto coefficient. <br/>
 <br/>
Based on this similarity algorithm the class provides different useful public methods: <br/>
<a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a4860b71a3af2e427feea8a711cf5179b">Cutoff Search </a>: <br/>
Similarities of all molecules in a query library to all molecules in a target library are calculated and the pairs whose similarities exceed a predefined cutoff are written to an output file. The performance of the method depends on size of the input query. For a single molecule query, the method has minimum performance and grows exponentially with the number of query molecules reaching a maximum performance at about 400 query molecules. As a consequence it is faster to bundle cutoff searches for multiple molecules if available. <br/>
<a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a5d2544c40e906d2fd3a11695bd18900f">Connected Components </a>: <br/>
For an input library all pairwise similarities are calculated. A similarity graph is generated by inserting molecule pairs as edges. A variable similarity cutoff is applied to insert only those edges whose corresponding similarity exceeds this cutoff. Thereby, a similarity network is created and the connected components are finally calculated. If desired, the nearest neighbour of every molecule can additionally be returned. <br/>
<a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a9ce2cd7e5ac4a6eaa1c55b6e9d7e88bb">Hierarchical Clustering </a>: <br/>
A set of input molecules is hierarhically clustered according to the average linkage criterion. Two different algorithms are implemented to make efficient use of the inverted index algorithm and the available hardware resources. Both methods are based on Reciprocal Nearest Neighbours. The <a class="el" href="../../">parallel variant </a> is used to handle large input library sizes. If the similarity matrix for the remaining clusters or possibly all input molecules fit into main memory, the matrix is calculated and the <a class="el" href="../../">Nearest Neighbour Chain algorithm </a> is used. <br/>
 Finally, the method of <a class="el" href="../../">Kelly et al. </a> is used to select an level for cluster selection and the created clusters are returned. <br/>
<a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html#a293be367b60dda5fd708780ca36539eb">Calculate Medoid </a> : <br/>
For a set of input molecules the Medoid is calculated. The medoid is the molecule with the highest averaged similarity to all other molecules. Additionally, the method returns the averaged pairwise similarities for every molecule in the input set. <br/>
 <br/>
Citations:<br/>
Clustering Algorithms: F. Murtagh, Compstat Lectures vol. 4, 1985, Physica-Verlag Würzburg-Wien. (Volume titel: Multidimensional clustering algorithms). <br/>
Similarity Update: G. Lance and W. Williams, Comput J. (1967), 9, 373-380. (doi: 10.1093/comjnl/9.4.373).<br/>
Cutoff Selection: L.A. Kelley, S.P. Gardner and M.J. Sutcliffe, Protein Eng. (1996), 9, 1063-1065. (doi: 10.1093/protein/9.11.1063). </p>

<p>Definition at line <a class="el" href="../../d4/d71/binaryFingerprintMethods_8h_source.html#l00066">66</a> of file <a class="el" href="../../d4/d71/binaryFingerprintMethods_8h_source.html">binaryFingerprintMethods.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa58273788c4db3fdcea29a5c18059819"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::BinaryFingerprintMethods::BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="../../d5/dbe/structBALL_1_1BinaryFingerprintMethods_1_1Default.html">Default</a> constructor. </p>

</div>
</div>
<a class="anchor" id="a076381cb6c927f6e97daca3f6111c6be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::BinaryFingerprintMethods::BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td><a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> to use. Defaults will be overwritten. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a44e03dc4d2002e236051cdb4d66ab924"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::BinaryFingerprintMethods::BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FingerprintFeatures &amp;&#160;</td>
          <td class="paramname"><em>lib_features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td><a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> to use. Defaults will be overwritten. </td></tr>
    <tr><td class="paramname">lib_features</td><td>Target library as a lists of integer fingerprint features. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a69d95f7094a4e241899d6a945138ce82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::BinaryFingerprintMethods::BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FingerprintFeatures &amp;&#160;</td>
          <td class="paramname"><em>lib_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FingerprintFeatures &amp;&#160;</td>
          <td class="paramname"><em>query_features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td><a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a> to use. Defaults will be overwritten. </td></tr>
    <tr><td class="paramname">lib_features</td><td>Target library as lists of integer fingerprint features. </td></tr>
    <tr><td class="paramname">query_features</td><td>Query library as lists of integer fingerprint features. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4dce3261ccf324504e5500565eaed85b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BALL::BinaryFingerprintMethods::BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a> &amp;&#160;</td>
          <td class="paramname"><em>bfm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy constructor. </p>

</div>
</div>
<a class="anchor" id="a76218f09e26aeb51ab18b23abb310b91"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual BALL::BinaryFingerprintMethods::~BinaryFingerprintMethods </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9ce2cd7e5ac4a6eaa1c55b6e9d7e88bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::averageLinkageClustering </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; unsigned int, <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>nn_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; unsigned int, std::vector&lt; unsigned int &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>cluster_selection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Average linkage clustering of a set of molecules defined by selection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selection</td><td>Indices of molecules in lib_features_ vector for which connected components analysis should be performed </td></tr>
    <tr><td class="paramname">nn_data</td><td>Nearest neighbour information for molecules in selection if already calculated, otherwise an empty vector. </td></tr>
    <tr><td class="paramname">cluster_selection</td><td>Final clustering, i.e. a cluster ID is assigned to every leaf node. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if clustering was successful, false otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a293be367b60dda5fd708780ca36539eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::calculateSelectionMedoid </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>medoid_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>avg_sims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculation of the medoid of a set of molecules defined by selection. Medoid has the highest average similarity to all other compounds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selection</td><td>Indices of molecules in lib_features_ vector for which the medoid should be calculated. </td></tr>
    <tr><td class="paramname">medoid_index</td><td>Reference to return the index of the calculated medoid in the passed molecule indices (selection). </td></tr>
    <tr><td class="paramname">avg_sims</td><td>Reference to vector which finally will store the average similarity of every molecule to all others in selection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if calculation has been successful, otherwise false. </dd></dl>

</div>
</div>
<a class="anchor" id="a5d2544c40e906d2fd3a11695bd18900f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::connectedComponents </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ccs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; unsigned int, <a class="el" href="../../d4/dc3/classfloat.html">float</a> &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>nn_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dc3/classfloat.html">float</a>&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>store_nns</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate similarity network of a set of molecules defined by selection and return the connected components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">selection</td><td>Indices of molecules in lib_features_ array for which connected components analysis should be performed. </td></tr>
    <tr><td class="paramname">ccs</td><td>Data structure to return connected components. Eeach ccs member is a single connected component which stores the indices (positions in the vector) of the connected component members in selection. </td></tr>
    <tr><td class="paramname">nn_data</td><td>If store_nns = true, nn_data will store the nearest neighbour information (index into selection and similarity) for all connected component members. </td></tr>
    <tr><td class="paramname">sim_cutoff</td><td>Similarity cutoff to apply for similarity network generation, i.e. only keep similarities above cutoff. </td></tr>
    <tr><td class="paramname">store_nns</td><td>If true, the nearest neighbour and its similarity are stored during connected components calculation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4860b71a3af2e427feea8a711cf5179b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::cutoffSearch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/dc3/classfloat.html">float</a>&#160;</td>
          <td class="paramname"><em>sim_cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d4e/classBALL_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>outfile_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform similarity search for molecules of a query library in a target library and keep pairs with similarity exceeding sim_cutoff. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sim_cutoff</td><td>Similarity cutoff to apply for cutoff search, i.e. only keep similarities above cutoff. </td></tr>
    <tr><td class="paramname">file_name</td><td>Output file name to store result pairs with similarities as space separated CSV file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a78afabd937858571aedeb1b0a46aa8da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d3/dc3/classBALL_1_1Options.html">Options</a>&amp; BALL::BinaryFingerprintMethods::getOptions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get const reference to options. </p>
<dl class="section return"><dt>Returns</dt><dd>Const reference to options of <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html" title="This class provides efficient similarity calculation functionality for 2D binary fingerprints. ">BinaryFingerprintMethods</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a4c543ddd899735b13610ab15117283f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int BALL::BinaryFingerprintMethods::getQueryLibrarySize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get number of molecules in query library. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of query molecules. </dd></dl>

</div>
</div>
<a class="anchor" id="a725eea8cfd2929045a81d1352496cae1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int BALL::BinaryFingerprintMethods::getTargetLibrarySize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get number of molecules in target library. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of target molecules. </dd></dl>

</div>
</div>
<a class="anchor" id="a4f8cd4431724ac7cba4c9b970cdcd777"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a>&amp; BALL::BinaryFingerprintMethods::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d1a/classBALL_1_1BinaryFingerprintMethods.html">BinaryFingerprintMethods</a> &amp;&#160;</td>
          <td class="paramname"><em>bfm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assignment operator </p>

</div>
</div>
<a class="anchor" id="a4274c3a290eb0c11b231636f9ca3c953"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::parseBinaryFingerprint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/d4e/classBALL_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>fprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned short &gt; &amp;&#160;</td>
          <td class="paramname"><em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>fp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>delim</em> = <code>&quot;,&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper for different binary fingerprint parsers which returns a vector of integer features. The returned features lie in the interval [1, max_feature_id + 1]. Thus, no feature has ID = 0 which is important for inverted index implementation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fprint</td><td>The fingerprint as a separated list of integer features. </td></tr>
    <tr><td class="paramname">features</td><td>A vector reference to return the fingerprint features. The vector will be cleaned first. </td></tr>
    <tr><td class="paramname">fp_type</td><td>Fingerprint encoding: 1 = Binary Bitstring, 2 = Separated list of integer features </td></tr>
    <tr><td class="paramname">delim</td><td>The delimiter character of the list. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if feature list has been parsed successful. </dd></dl>

</div>
</div>
<a class="anchor" id="acb725c5572c0ba2d8ae072cfd0375d94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::setLibraryFeatures </td>
          <td>(</td>
          <td class="paramtype">const FingerprintFeatures &amp;&#160;</td>
          <td class="paramname"><em>lib_features</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a target library containing binary fingerprints as feature lists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lib_features</td><td>Target library as lists of integer fingerprint features. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if setup was successful, false if formats of input features are invalid. </dd></dl>

</div>
</div>
<a class="anchor" id="a136883c4ad6f36afd658984e32dd4bf0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> BALL::BinaryFingerprintMethods::setQueryFeatures </td>
          <td>(</td>
          <td class="paramtype">const FingerprintFeatures &amp;&#160;</td>
          <td class="paramname"><em>query_features</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a query library containing binary fingerprints as feature lists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query_features</td><td>Query library as lists of integer fingerprint features. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if setup was successful, false if formats of input features are invalid. </dd></dl>

</div>
</div>
<a class="anchor" id="a391db65bae5f65079f0027eb9348ba32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BALL::BinaryFingerprintMethods::setVerbosityLevel </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>verbosity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set verbosity level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbosity</td><td>verbosity level to use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
